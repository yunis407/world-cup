//In Google Analytics you'll need to set up custom dimensions as follows
// Custom Dimension 1 = Canvas User ID --- Scope = User
// Custom Dimension 2 = Archived --- Scope = User
// Custom Dimension 3 = Canvas User Role --- Scope = User
// Custom Dimension 4 = Canvas Course ID --- Scope = Hit
// Custom Dimension 5 = Canvas Course Name --- Scope = Hit
// Custom Dimension 6 = Canvas Sub-Account ID --- Scope = Hit

(function(i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

window.addEventListener("message", function(event) {
        // IMPORTANT: confirm origin
    if(event.origin.startsWith("https://moringa.formstack.com")&& event.data=="submitted"){
        console.log("received message:" + JSON.stringify(event.data));
        $('#mark-as-done-checkbox').trigger('click');
	 // $('#mark-as-done-checkbox').style.display = 'none';
    }
});



$(document).ready(function() {

    // START - More Google Analytics Tracking Code
    var sUserId
    var sUserRole
    var sTemp // Course ID from URL
    var _course
    var sCourseName = null
    var parent_account //Give you the subaccount_id that the course is in

    ////////////////// CHANGE UA # HERE /////////////////////
    ga('create', 'UA-108505559-1', 'auto');

    //Get User Information
    sUserId = ENV["current_user_id"]
    ga('set', 'dimension1', sUserId);


    //Get User Role
    if ($.inArray('admin', ENV['current_user_roles']) == -1 && $.inArray('teacher', ENV['current_user_roles']) == -1 && $.inArray('student', ENV['current_user_roles']) > -1) {
        sUserRole = "student"
    } else if ($.inArray('admin', ENV['current_user_roles']) == -1 && $.inArray('teacher', ENV['current_user_roles']) > -1) {
        sUserRole = "teacher"
    } else if ($.inArray('admin', ENV['current_user_roles']) > -1) {
        sUserRole = "admin"
    } else {
        sUserRole = "other"
    }

    ga('set', 'dimension3', sUserRole);

    //If the user is in a course
    try {
        sTemp = window.location.pathname.match(/\/courses\/(\d+)/);
        if (sTemp[1]) {

            //Get Course information - Course Name and parent sub-account id
            var d1 = $.get('/api/v1/courses/' + sTemp[1], function(_course) {
                parent_account = _course.account_id
                parent_account = parent_account.toString();
                sCourseName = _course.name
            });


            $.when(d1).done(function(_account) {
                // ...do stuff...
                ga('set', 'dimension4', sTemp[1]);
                ga('set', 'dimension5', sCourseName);
                ga('set', 'dimension6', parent_account);
                ga('send', 'pageview');
            });
        } else {
            ga('send', 'pageview');
        }
    } catch (err) {}

    // END - Google Analytics Tracking Code

});


// Custom JS for chaning UI fields

/*
----------------------------------
disabling the export content button
----------------------------------
*/


$(document).ready(function() {
    // Handler for .ready() called.
    $('button.offline_web_export').hide();
    $('input#course_organize_epub_by_content_type').hide();
});

/*
----------------------------------------------
Generate a universal "Student View" button on 
---------------------------------------------
 */
var universalStudentView = function() {
    var isTeacher, isCourse, courseId, templateButton, sutdentViewVisible, studentViewURL, getPath;
    
    // Determine if the user is actually a teacher
    if (ENV['current_user_roles'].includes('teacher') && $('.ic-app-course-menu.list-view nav #section-tabs li.section a[title="Settings"]').is(":visible")) {
        isTeacher = true;
    } else {
        isTeacher = false;
    }

    // Get the current Course ID and path based on the url of the course
    isCourse = window.location.href.indexOf("/courses/") > -1;
    getPath = window.location.pathname;
    
    // Determine if the template button is currently visible
    templateButton = $('.btn.button-sidebar-wide.element_toggler.choose_home_page_link').is(':visible');
    
    // Determine if the user is currently in student view
    studentViewVisible = $('.ic-alert-masquerade-student-view').is(':visible');

    // Validate rendering the universal button based on the variables

    /*

    If the user is truly a teacher for this course/student
     view is not already enabled, render the button 

     */
    if(isTeacher && isCourse && studentViewVisible == false) { 
        courseId = getPath.split('courses/').pop().split('/')[0]
        studentViewURL = "/courses/" + courseId + "/student_view";
        $('.ic-app-nav-toggle-and-crumbs.no-print').append('<a class="btn button-sidebar-wide quick-access" href="' + studentViewURL + '" rel="nofollow" data-method="post"><i class="icon-student-view" role="presentation"></i> Launch Student View</a>')
    } else { // If the user is not a teacher or student view is already enabled
        $('.ic-app-nav-toggle-and-crumbs.no-print').remove('.btn.button-sidebar-wide.quick-access')
    }
}


//Zendesk Widget

// var customLoadZendeskWidget = function() {
//     var script = document.createElement('script');
//     script.type = 'text/javascript';
//     script.id = 'ze-snippet';
//     script.async = true;
//     script.src = 'https://static.zdassets.com/ekr/snippet.js?key=0532414e-ffa9-4278-9570-fff17d90b2e4';
//     document.getElementsByTagName('head')[0].appendChild(script);
// };

/* ------------------ END FUNCTION SECTION */

/* ------------------ RUN ON PAGE LOAD */

var current_name = null;
var current_email = null;
var current_course = null;

$(
//document.addEventListener("DOMContentLoaded",
function () {
//window.onload = function () {
        console.log('Entry point New');
        universalStudentView();
    // customLoadZendeskWidget();
    

      
    // $.get('/api/v1/users/self/profile', function(profile) {
    //     console.log(JSON.stringify(profile));
    //     current_name = profile.name;
    //     current_email = profile.primary_email;
  
    //     zE('webWidget', 'updateSettings', {
    //         webWidget: {
    //         contactForm: {
    //             fields: [
    //                 { id: 'name', prefill: { '*': current_name } },
    //                 { id: 'email', prefill: { '*': current_email } }
    //                 ]
    //             }
    //         }
    //       });
    // });
  
  
    
    
  //   get course id
    var url = window.location.href;
    // if(url.includes('courses/')){
    //     var course_str = url.substr(url.indexOf('course'));
    //     var segments = course_str.split('/');
    //     console.log('course ID'+segments[1]);
    //     $.get('/api/v1/courses/'+segments[1], function(course) {
    //         console.log(JSON.stringify(course));
    //         current_course = course;
  
    //         zE('webWidget', 'updateSettings', {
    //             webWidget: {
    //                 contactForm: {
    //                     title: {
    //                         '*': course.course_code+' Support'
    //                     },
    //                     subject: true,
    //                     fields: [{ id:'subject', prefill: { '*': course.course_code+' Technical Support'}}]
    //                 }
    //             }
    //           });
    //     });  
    // }
    /*
    ----------------------------------------------
    *Dynamically add Topic Feedback START
    ---------------------------------------------
    */


    function createFragment(htmlStr){
        var fragment = document.createDocumentFragment(),
        $element = document.createElement('div');

        $element.innerHTML = htmlStr;
        while($element.firstChild){
            fragment.appendChild($element.firstChild);
        }
        return fragment;
    }

    var $target = document.querySelector('.show-content');
    htmlStr = `HELLO WORLD!!!!`;
    htmlStr = `<iframe id="fs-iframe" title="Content Page Rating" src="https://moringa.formstack.com/forms/student_contract_copy" width="100%" height="400x"></iframe>`
    // $target.appendChild(createFragment(htmlStr));
    /*
    ----------------------------------------------
    *Dynamically add Topic Feedback END
    ---------------------------------------------
    */



    /*
    ----------------------------------------------
    *Populate Formstack Feedback form START
    ---------------------------------------------
    */
    waitForElm('#fs-iframe').then((elm) => {
        console.log('Element is ready');
        console.log(elm.textContent);
        populateFormStackForm(elm);
    });
    

    /*
    ----------------------------------------------
    *Populate Formstack Feedback form END
    ---------------------------------------------
    */
}
);


function populateFormStackForm(fs_iframe){
    //const fs_iframe = document.getElementById("fs-iframe"); //find the iframe with Formstack
    console.log('fs-frame::'+ fs_iframe);
    if(fs_iframe==null)return;
    // Make sure the iframe is loaded
    fs_iframe.addEventListener("load", function(){
        data = {}
        const url = window.location.href;

        console.log(`Formstack URL:: ${url}`)

        if(url.includes('courses/')){
            let course_str = url.substr(url.indexOf('course'));
            let course_segments = course_str.split('/');
            let page_str = url.substr(url.indexOf('pages'));
            let page_segments = page_str.split('/');
            console.log('course ID'+course_segments[1]);
            console.log('Page Title'+page_segments[1]);
            
            // Retrieve course information
            $.get('/api/v1/courses/'+course_segments[1], function(course) {
                let current_course = course.course_code;
                let course_start = course.start_at
                let course_end = course.end_at
                let courseId = course.id
                // let course_sis_id = course.sis_course_id

                console.log(`Current course Info::${current_course}`)

                if (!/\d+/.test(current_course)){
                    
                    console.log("Course Offering does not have term number included")
                    return
                }
                if(!course_start||!course_end){
                    console.log("This Course Offering is either Blueprint or does not have start or end date included")
                    return
                }

                data["course_code"] =  current_course
                data["course_start"] = course_start.split("T")[0]
                data["course_end"] = course_end.split("T")[0]

               
                if (current_course.toLocaleLowerCase().includes("PT")){

                    data["term"] = `${current_course.slice(0, 4)}${current_course.match(/\d+/)[0]}`
                }else{
                    data["term"] = `${current_course.slice(0, 2)}${current_course.match(/\d+/)[0]}`
                }
                //*Retrieve sections
                $.get(`/api/v1/courses/${course_segments[1]}/sections?include[]=total_students`, function(sectionList) {
                    max = 0
                    primarySectionId = 0
                    for(i=0; i<sectionList.length; i++){   
                        if(max <  sectionList[i].total_students){
                            max = sectionList[i].total_students
                        }
                    }
                    for(i=0; i<sectionList.length; i++){   
                        if(max === sectionList[i].total_students){
                            primarySectionId = sectionList[i].id
                        }
                    }
                    // Get Page info for content feedback
                    $.get(`/api/v1/courses/${course_segments[1]}/pages/${page_segments[1]}`, function(page) { 

                        page_title = page.title
                        page_id = page.page_id
                        page_created_at = page.created_at
                        page_updated_at = page.updated_at
                        page_url = page.html_url
                        _url = page.url

                        console.log(`Page url: ${page_url}`)

                        data["page_title"] = page_title
                        data["page_id"] = page_id
                        data["page_created_at"] = page_created_at 
                        data["page_updated_at"] = page_updated_at
                        data["page_url"] = page_url
                        data["_url"] = _url


                        // Get enrollment ID
                        
                        // Get Profile of user
                        $.get('/api/v1/users/self/profile', function(profile) {
                            // Get the current user profile
                            
                            
                            //console.log(JSON.stringify(profile));
                            current_user_id = profile.id;
                            current_user_name = profile.name;
                            current_user_email = profile.primary_email;
                            current_sis_id = profile.sis_user_id;
                            
                            // debugg log
                            console.log(current_user_id);
                            console.log(current_user_email);
                            
                            // data object
                            data["id"] =  current_user_id
                            data["name"] =  current_user_name
                            data["email"] =  current_user_email
                            data["SIS_Id"] = current_sis_id
                            
                            
                            // debugg log
                            console.log(`Canvas:: User ID ${current_user_id}`);
                            console.log(current_user_email);
                            
                            
                            // data object
                            data["id"] =  current_user_id
                            data["name"] =  current_user_name
                            // data["email"] =  current_user_email
                            data["SIS_Id"] = current_sis_id
                            
                            
                            $.get(`/api/v1/courses/${courseId}/enrollments?user_id=${current_user_id}`, function(enrollmentsList) {
                                // Getting the section enrollment. 
                                let enrollment
                                for(i=0; i<enrollmentsList.length; i++){   
                                    if(primarySectionId !==  enrollmentsList[i].course_id){
                                        enrollment = enrollmentsList[i]
                                    }
                                }
                                if(enrollment){
                                     current_LMS_id = enrollment.id
                                }else{
                                     current_LMS_id = 0;
                                }
                               
                                console.log(`Canvas:: LMS ID ${current_LMS_id}`);
                                data["LMS_Id"] = current_LMS_id


                                console.log(data["SIS_Id"])
                                console.log(data["course_code"])
                                fs_iframe.contentWindow.postMessage(data, "*")
                                console.log("I. data passed")

                            }); 

                        });
                    });

                });

            });  
        }    
    })
}


// window.zE||function(t, e, a) {
//     var s = [],
//         c = function () {
//            s.push(arguments)
//         },
//         n = t.createElement(e);
//     n.type = "text/javascript";
//     n.src = "https://static.zdassets.com/ekr/snippet.js?key=" + a;
//     n.setAttribute("charset", "utf-8");
//     n.async = true;
//     c._ = s;
//     c.t = Date.now();
//     c.s = n;
//     window.zE = window.zEmbed = c;
//     t.getElementsByTagName("head")[0].appendChild(n);
//     window.zESettings = {
//        webWidget: {
//           launcher: {
//              chatLabel: {
//                 '*': 'Moringa School Support '
//              }
//           },
//           contactForm: {
//             title: {
//               '*': 'Moringa School Support'
//             },
//             subject: true,
//             fields: [
//                 { id: 'name', prefill: { '*': current_name } },
//                 { id: 'email', prefill: { '*': current_email } },
//                 { id:'subject'}
//               ]
//           },
//           position: {
//              horizontal: 'right',
//              vertical: 'bottom'
//           }
//        }
//     }
//  }
//  (document,"script","0532414e-ffa9-4278-9570-fff17d90b2e4");

// end of student view by teachers



/*
---------------------
view feedback function while submitting assignments
--------------------------
*/

$(window).bind('load', function() {
    // sets variables equal to the  doc button and the feedback buttons
    var getDocButton = $('.submission-details-frame iframe').contents().find('a.file-upload-submission-info__link')
    var getFbButton = $('.submission-details-frame iframe').contents().find('a.modal_preview_link.Button--link')
    
    // Add classes to target variables to specify css for those elements
    getDocButton.addClass('download')
    getFbButton.addClass('feedback-btn')

    // Handles clicking view feedback button
    $(document).on('click', 'a.feedback-btn', function() {
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').removeClass('for-feedback'); // always set overlay to normal state when first opened
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').append('<div class="expand-btn"></div>') // Adds the fullscreen button to the overlay container
    })

    // Handles clicking fullscreen button
    $(document).on('click', 'div.expand-btn', function() {
        if(window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').hasClass('for-feedback')) { // Only do this if the overlay already has the for-feedback class
            // Removes expand and for-feedback classes, returning window sizes to no fullscreen and reseting document view
            window.parent.$('#preview_frame').removeClass('expand')
            window.parent.$('.submission-details-frame iframe').contents().find('div.ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-draggable.ui-resizable').removeClass('for-feedback');
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-dialog-content.ui-widget-content').removeClass('for-feedback');
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').removeClass('for-feedback');
            window.parent.$('.submission-details-frame iframe').contents().find('div.ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-draggable.ui-resizable').css({'min-height': '97px','height': '200px', 'width' : '90%'});
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-dialog-content.ui-widget-content').css('width', '100%');
        } else { // overlay doesn't have for-feedback class
            // Adds expand and for-feedback classes, enlarging containers and taking doc view to full screen
            window.parent.$('#preview_frame').addClass('expand')
            window.parent.$('.submission-details-frame iframe').contents().find('div.ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-draggable.ui-resizable').addClass('for-feedback');
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-dialog-content.ui-widget-content').addClass('for-feedback');
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').addClass('for-feedback');
        }
    });

    // Handles close button of doc view being clicked
    $(document).on('click', 'span.ui-icon.ui-icon-closethick',function() {
        // Removes expand and for-feedback classes, returning window sizes to no fullscreen and reseting document view
        // Completely removes fullscreen button from overlay container  
        window.parent.$('.submission-details-frame iframe').contents().find('div.expand-btn').remove();
        window.parent.$('#preview_frame').removeClass('expand')
        window.parent.$('.submission-details-frame iframe').contents().find('div.ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-draggable.ui-resizable').removeClass('for-feedback');
        window.parent.$('.submission-details-frame iframe').contents().find('.ui-dialog-content.ui-widget-content').removeClass('for-feedback');
        window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').removeClass('for-feedback');
    })

});

function waitForElm(selector) {
    return new Promise(resolve => {
        if (document.querySelector(selector)) {
            return resolve(document.querySelector(selector));
        }

        const observer = new MutationObserver(mutations => {
            if (document.querySelector(selector)) {
                resolve(document.querySelector(selector));
                observer.disconnect();
            }
        });

        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    });
}           20220202182137-8l	|   https://instructure-uploads-eu.s3.eu-west-1.amazonaws.com/account_118060000000000001/attachments/94734/MoringaInstructure.js   V  //In Google Analytics you'll need to set up custom dimensions as follows
// Custom Dimension 1 = Canvas User ID --- Scope = User
// Custom Dimension 2 = Archived --- Scope = User
// Custom Dimension 3 = Canvas User Role --- Scope = User
// Custom Dimension 4 = Canvas Course ID --- Scope = Hit
// Custom Dimension 5 = Canvas Course Name --- Scope = Hit
// Custom Dimension 6 = Canvas Sub-Account ID --- Scope = Hit

(function(i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

window.addEventListener("message", function(event) {
        // IMPORTANT: confirm origin
    if(event.origin.startsWith("https://moringa.formstack.com")&& event.data=="submitted"){
        console.log("received message:" + JSON.stringify(event.data));
        $('#mark-as-done-checkbox').trigger('click');
	 // $('#mark-as-done-checkbox').style.display = 'none';
    }
});



$(document).ready(function() {

    // START - More Google Analytics Tracking Code
    var sUserId
    var sUserRole
    var sTemp // Course ID from URL
    var _course
    var sCourseName = null
    var parent_account //Give you the subaccount_id that the course is in

    ////////////////// CHANGE UA # HERE /////////////////////
    ga('create', 'UA-108505559-1', 'auto');

    //Get User Information
    sUserId = ENV["current_user_id"]
    ga('set', 'dimension1', sUserId);


    //Get User Role
    if ($.inArray('admin', ENV['current_user_roles']) == -1 && $.inArray('teacher', ENV['current_user_roles']) == -1 && $.inArray('student', ENV['current_user_roles']) > -1) {
        sUserRole = "student"
    } else if ($.inArray('admin', ENV['current_user_roles']) == -1 && $.inArray('teacher', ENV['current_user_roles']) > -1) {
        sUserRole = "teacher"
    } else if ($.inArray('admin', ENV['current_user_roles']) > -1) {
        sUserRole = "admin"
    } else {
        sUserRole = "other"
    }

    ga('set', 'dimension3', sUserRole);

    //If the user is in a course
    try {
        sTemp = window.location.pathname.match(/\/courses\/(\d+)/);
        if (sTemp[1]) {

            //Get Course information - Course Name and parent sub-account id
            var d1 = $.get('/api/v1/courses/' + sTemp[1], function(_course) {
                parent_account = _course.account_id
                parent_account = parent_account.toString();
                sCourseName = _course.name
            });


            $.when(d1).done(function(_account) {
                // ...do stuff...
                ga('set', 'dimension4', sTemp[1]);
                ga('set', 'dimension5', sCourseName);
                ga('set', 'dimension6', parent_account);
                ga('send', 'pageview');
            });
        } else {
            ga('send', 'pageview');
        }
    } catch (err) {}

    // END - Google Analytics Tracking Code

});


// Custom JS for chaning UI fields

/*
----------------------------------
disabling the export content button
----------------------------------
*/


$(document).ready(function() {
    // Handler for .ready() called.
    $('button.offline_web_export').hide();
    $('input#course_organize_epub_by_content_type').hide();
});

/*
----------------------------------------------
Generate a universal "Student View" button on 
---------------------------------------------
 */
var universalStudentView = function() {
    var isTeacher, isCourse, courseId, templateButton, sutdentViewVisible, studentViewURL, getPath;
    
    // Determine if the user is actually a teacher
    if (ENV['current_user_roles'].includes('teacher') && $('.ic-app-course-menu.list-view nav #section-tabs li.section a[title="Settings"]').is(":visible")) {
        isTeacher = true;
    } else {
        isTeacher = false;
    }

    // Get the current Course ID and path based on the url of the course
    isCourse = window.location.href.indexOf("/courses/") > -1;
    getPath = window.location.pathname;
    
    // Determine if the template button is currently visible
    templateButton = $('.btn.button-sidebar-wide.element_toggler.choose_home_page_link').is(':visible');
    
    // Determine if the user is currently in student view
    studentViewVisible = $('.ic-alert-masquerade-student-view').is(':visible');

    // Validate rendering the universal button based on the variables

    /*

    If the user is truly a teacher for this course/student
     view is not already enabled, render the button 

     */
    if(isTeacher && isCourse && studentViewVisible == false) { 
        courseId = getPath.split('courses/').pop().split('/')[0]
        studentViewURL = "/courses/" + courseId + "/student_view";
        $('.ic-app-nav-toggle-and-crumbs.no-print').append('<a class="btn button-sidebar-wide quick-access" href="' + studentViewURL + '" rel="nofollow" data-method="post"><i class="icon-student-view" role="presentation"></i> Launch Student View</a>')
    } else { // If the user is not a teacher or student view is already enabled
        $('.ic-app-nav-toggle-and-crumbs.no-print').remove('.btn.button-sidebar-wide.quick-access')
    }
}


//Zendesk Widget

// var customLoadZendeskWidget = function() {
//     var script = document.createElement('script');
//     script.type = 'text/javascript';
//     script.id = 'ze-snippet';
//     script.async = true;
//     script.src = 'https://static.zdassets.com/ekr/snippet.js?key=0532414e-ffa9-4278-9570-fff17d90b2e4';
//     document.getElementsByTagName('head')[0].appendChild(script);
// };

/* ------------------ END FUNCTION SECTION */

/* ------------------ RUN ON PAGE LOAD */

var current_name = null;
var current_email = null;
var current_course = null;

$(
//document.addEventListener("DOMContentLoaded",
function () {
//window.onload = function () {
        console.log('Entry point New');
        universalStudentView();
    // customLoadZendeskWidget();
    

      
    // $.get('/api/v1/users/self/profile', function(profile) {
    //     console.log(JSON.stringify(profile));
    //     current_name = profile.name;
    //     current_email = profile.primary_email;
  
    //     zE('webWidget', 'updateSettings', {
    //         webWidget: {
    //         contactForm: {
    //             fields: [
    //                 { id: 'name', prefill: { '*': current_name } },
    //                 { id: 'email', prefill: { '*': current_email } }
    //                 ]
    //             }
    //         }
    //       });
    // });
  
  
    
    
  //   get course id
    var url = window.location.href;
    // if(url.includes('courses/')){
    //     var course_str = url.substr(url.indexOf('course'));
    //     var segments = course_str.split('/');
    //     console.log('course ID'+segments[1]);
    //     $.get('/api/v1/courses/'+segments[1], function(course) {
    //         console.log(JSON.stringify(course));
    //         current_course = course;
  
    //         zE('webWidget', 'updateSettings', {
    //             webWidget: {
    //                 contactForm: {
    //                     title: {
    //                         '*': course.course_code+' Support'
    //                     },
    //                     subject: true,
    //                     fields: [{ id:'subject', prefill: { '*': course.course_code+' Technical Support'}}]
    //                 }
    //             }
    //           });
    //     });  
    // }
    /*
    ----------------------------------------------
    *Dynamically add Topic Feedback START
    ---------------------------------------------
    */


    function createFragment(htmlStr){
        var fragment = document.createDocumentFragment(),
        $element = document.createElement('div');

        $element.innerHTML = htmlStr;
        while($element.firstChild){
            fragment.appendChild($element.firstChild);
        }
        return fragment;
    }

    var $target = document.querySelector('.show-content');
    htmlStr = `HELLO WORLD!!!!`;
    htmlStr = `<iframe id="fs-iframe" title="Content Page Rating" src="https://moringa.formstack.com/forms/student_contract_copy" width="100%" height="400x"></iframe>`
    // $target.appendChild(createFragment(htmlStr));
    /*
    ----------------------------------------------
    *Dynamically add Topic Feedback END
    ---------------------------------------------
    */



    /*
    ----------------------------------------------
    *Populate Formstack Feedback form START
    ---------------------------------------------
    */
    waitForElm('#fs-iframe').then((elm) => {
        console.log('Element is ready');
        console.log(elm.textContent);
        populateFormStackForm(elm);
    });
    

    /*
    ----------------------------------------------
    *Populate Formstack Feedback form END
    ---------------------------------------------
    */
}
);


function populateFormStackForm(fs_iframe){
    //const fs_iframe = document.getElementById("fs-iframe"); //find the iframe with Formstack
    console.log('fs-frame::'+ fs_iframe);
    if(fs_iframe==null)return;
    // Make sure the iframe is loaded
    fs_iframe.addEventListener("load", function(){
        data = {}
        const url = window.location.href;

        console.log(`Formstack URL:: ${url}`)

        if(url.includes('courses/')){
            let course_str = url.substr(url.indexOf('course'));
            let course_segments = course_str.split('/');
            let page_str = url.substr(url.indexOf('pages'));
            let page_segments = page_str.split('/');
            console.log('course ID'+course_segments[1]);
            console.log('Page Title'+page_segments[1]);
            
            // Retrieve course information
            $.get('/api/v1/courses/'+course_segments[1], function(course) {
                let current_course = course.course_code;
                let course_start = course.start_at
                let course_end = course.end_at
                let courseId = course.id
                // let course_sis_id = course.sis_course_id

                console.log(`Current course Info::${current_course}`)

                if (!/\d+/.test(current_course)){
                    
                    console.log("Course Offering does not have term number included")
                    return
                }
                if(!course_start||!course_end){
                    console.log("This Course Offering is either Blueprint or does not have start or end date included")
                    return
                }

                data["course_code"] =  current_course
                data["course_start"] = course_start.split("T")[0]
                data["course_end"] = course_end.split("T")[0]

               
                if (current_course.toLocaleLowerCase().includes("PT")){

                    data["term"] = `${current_course.slice(0, 4)}${current_course.match(/\d+/)[0]}`
                }else{
                    data["term"] = `${current_course.slice(0, 2)}${current_course.match(/\d+/)[0]}`
                }
                //*Retrieve sections
                $.get(`/api/v1/courses/${course_segments[1]}/sections?include[]=total_students`, function(sectionList) {
                    max = 0
                    primarySectionId = 0
                    for(i=0; i<sectionList.length; i++){   
                        if(max <  sectionList[i].total_students){
                            max = sectionList[i].total_students
                        }
                    }
                    for(i=0; i<sectionList.length; i++){   
                        if(max === sectionList[i].total_students){
                            primarySectionId = sectionList[i].id
                        }
                    }
                    // Get Page info for content feedback
                    $.get(`/api/v1/courses/${course_segments[1]}/pages/${page_segments[1]}`, function(page) { 

                        page_title = page.title
                        page_id = page.page_id
                        page_created_at = page.created_at
                        page_updated_at = page.updated_at
                        page_url = page.html_url
                        _url = page.url

                        console.log(`Page url: ${page_url}`)

                        data["page_title"] = page_title
                        data["page_id"] = page_id
                        data["page_created_at"] = page_created_at 
                        data["page_updated_at"] = page_updated_at
                        data["page_url"] = page_url
                        data["_url"] = _url


                        // Get enrollment ID
                        
                        // Get Profile of user
                        $.get('/api/v1/users/self/profile', function(profile) {
                            // Get the current user profile
                            
                            
                            //console.log(JSON.stringify(profile));
                            current_user_id = profile.id;
                            current_user_name = profile.name;
                            current_user_email = profile.primary_email;
                            current_sis_id = profile.sis_user_id;
                            
                            // debugg log
                            console.log(current_user_id);
                            console.log(current_user_email);
                            
                            // data object
                            data["id"] =  current_user_id
                            data["name"] =  current_user_name
                            data["email"] =  current_user_email
                            data["SIS_Id"] = current_sis_id
                            
                            
                            // debugg log
                            console.log(`Canvas:: User ID ${current_user_id}`);
                            console.log(current_user_email);
                            
                            
                            // data object
                            data["id"] =  current_user_id
                            data["name"] =  current_user_name
                            // data["email"] =  current_user_email
                            data["SIS_Id"] = current_sis_id
                            
                            
                            $.get(`/api/v1/courses/${courseId}/enrollments?user_id=${current_user_id}`, function(enrollmentsList) {
                                // Getting the section enrollment. 
                                let enrollment
                                for(i=0; i<enrollmentsList.length; i++){   
                                    if(primarySectionId !==  enrollmentsList[i].course_id){
                                        enrollment = enrollmentsList[i]
                                    }
                                }
                                if(enrollment){
                                     current_LMS_id = enrollment.id
                                }else{
                                     current_LMS_id = 0;
                                }
                               
                                console.log(`Canvas:: LMS ID ${current_LMS_id}`);
                                data["LMS_Id"] = current_LMS_id


                                console.log(data["SIS_Id"])
                                console.log(data["course_code"])
                                fs_iframe.contentWindow.postMessage(data, "*")
                                console.log("I. data passed")

                            }); 

                        });
                    });

                });

            });  
        }    
    })
}


// window.zE||function(t, e, a) {
//     var s = [],
//         c = function () {
//            s.push(arguments)
//         },
//         n = t.createElement(e);
//     n.type = "text/javascript";
//     n.src = "https://static.zdassets.com/ekr/snippet.js?key=" + a;
//     n.setAttribute("charset", "utf-8");
//     n.async = true;
//     c._ = s;
//     c.t = Date.now();
//     c.s = n;
//     window.zE = window.zEmbed = c;
//     t.getElementsByTagName("head")[0].appendChild(n);
//     window.zESettings = {
//        webWidget: {
//           launcher: {
//              chatLabel: {
//                 '*': 'Moringa School Support '
//              }
//           },
//           contactForm: {
//             title: {
//               '*': 'Moringa School Support'
//             },
//             subject: true,
//             fields: [
//                 { id: 'name', prefill: { '*': current_name } },
//                 { id: 'email', prefill: { '*': current_email } },
//                 { id:'subject'}
//               ]
//           },
//           position: {
//              horizontal: 'right',
//              vertical: 'bottom'
//           }
//        }
//     }
//  }
//  (document,"script","0532414e-ffa9-4278-9570-fff17d90b2e4");

// end of student view by teachers



/*
---------------------
view feedback function while submitting assignments
--------------------------
*/

$(window).bind('load', function() {
    // sets variables equal to the  doc button and the feedback buttons
    var getDocButton = $('.submission-details-frame iframe').contents().find('a.file-upload-submission-info__link')
    var getFbButton = $('.submission-details-frame iframe').contents().find('a.modal_preview_link.Button--link')
    
    // Add classes to target variables to specify css for those elements
    getDocButton.addClass('download')
    getFbButton.addClass('feedback-btn')

    // Handles clicking view feedback button
    $(document).on('click', 'a.feedback-btn', function() {
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').removeClass('for-feedback'); // always set overlay to normal state when first opened
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').append('<div class="expand-btn"></div>') // Adds the fullscreen button to the overlay container
    })

    // Handles clicking fullscreen button
    $(document).on('click', 'div.expand-btn', function() {
        if(window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').hasClass('for-feedback')) { // Only do this if the overlay already has the for-feedback class
            // Removes expand and for-feedback classes, returning window sizes to no fullscreen and reseting document view
            window.parent.$('#preview_frame').removeClass('expand')
            window.parent.$('.submission-details-frame iframe').contents().find('div.ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-draggable.ui-resizable').removeClass('for-feedback');
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-dialog-content.ui-widget-content').removeClass('for-feedback');
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').removeClass('for-feedback');
            window.parent.$('.submission-details-frame iframe').contents().find('div.ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-draggable.ui-resizable').css({'min-height': '97px','height': '200px', 'width' : '90%'});
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-dialog-content.ui-widget-content').css('width', '100%');
        } else { // overlay doesn't have for-feedback class
            // Adds expand and for-feedback classes, enlarging containers and taking doc view to full screen
            window.parent.$('#preview_frame').addClass('expand')
            window.parent.$('.submission-details-frame iframe').contents().find('div.ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-draggable.ui-resizable').addClass('for-feedback');
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-dialog-content.ui-widget-content').addClass('for-feedback');
            window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').addClass('for-feedback');
        }
    });

    // Handles close button of doc view being clicked
    $(document).on('click', 'span.ui-icon.ui-icon-closethick',function() {
        // Removes expand and for-feedback classes, returning window sizes to no fullscreen and reseting document view
        // Completely removes fullscreen button from overlay container  
        window.parent.$('.submission-details-frame iframe').contents().find('div.expand-btn').remove();
        window.parent.$('#preview_frame').removeClass('expand')
        window.parent.$('.submission-details-frame iframe').contents().find('div.ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-draggable.ui-resizable').removeClass('for-feedback');
        window.parent.$('.submission-details-frame iframe').contents().find('.ui-dialog-content.ui-widget-content').removeClass('for-feedback');
        window.parent.$('.submission-details-frame iframe').contents().find('.ui-widget-overlay').removeClass('for-feedback');
    })

});

function waitForElm(selector) {
    return new Promise(resolve => {
        if (document.querySelector(selector)) {
            return resolve(document.querySelector(selector));
        }

        const observer = new MutationObserver(mutations => {
            if (document.querySelector(selector)) {
                resolve(document.querySelector(selector));
                observer.disconnect();
            }
        });

        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    });
}Ó˜ÀÙÔ   r        kßT      GoogleAnalyticsObject      ğ„u2      push   DC      createElement      XFZ      getElementsByTagName   œ·È›      src    ¥_ÏÓ
      parentNode     åLÉ2      insertBefore   ø2‡‰      window     ¸O€      document	   I®-      https://www.google-analytics.com/analytics.js
       rO      addEventListener   II·P      event      =¨€;      origin     İJX?
      startsWith     Í"ÿi      https://moringa.formstack.com      6—(      data   íC>	      submitted      şQ1      console    =Xû      log    ²ØK£      received message:      n§ë	      stringify      8êD      #mark-as-done-checkbox     ù!pÂ      trigger    ŸªâX      click      ¢„
      ready      W*áG      sUserId    ÖSQ÷	      sUserRole      >ÿˆ!      sTemp      {M…!      _course    wf      sCourseName    ˆ‡      parent_account     :	¶#      create      ,qå`      UA-108505559-1!     zÁ²S      auto"   +ºş      ENV#    Ö[İW      current_user_id$    ÏDv°
      dimension1%     °­ØG      inArray&    ÏÎ1      admin'      uïJ      current_user_roles(     #P_Á      teacher)    ÿØšù      student*    ]Qt
      dimension3+     0+QA      location,   Ğ¨4O      pathname-   ãÿß      /api/v1/courses//   Û…lê      when4   ü,¸      send5   2¤±h      pageview6   ¼ğo˜      err7    pÚ¯„      button.offline_web_export8      Ÿvô}      hide9   ß¹+*      input#course_organize_epub_by_content_type:     "îªI      universalStudentView;   l
rŸ	      isTeacher<      @Îe      isCourse=   ïõ{<      courseId>   R{}ó      templateButton?     g|¯s      sutdentViewVisible@     _û´      studentViewURLA     Lb6      getPathB    f&ƒN      .ic-app-course-menu.list-view nav #section-tabs li.section a[title="Settings"]C     SZK#      :visibleD   »©`X      hrefE   ÚEœÁ      indexOfF    4}<Q	      /courses/G      ±YE>      .btn.button-sidebar-wide.element_toggler.choose_home_page_linkH     §ölĞ      studentViewVisibleI     ¢÷l!      .ic-alert-masquerade-student-viewJ      Üñ®      courses/K   ¦i4      popL    £ •      /student_viewM      ¹eQŸ&      .ic-app-nav-toggle-and-crumbs.no-printN     ÜB-      appendO     ş{x6      <a class="btn button-sidebar-wide quick-access" href="P     !’q      " rel="nofollow" data-method="post"><i class="icon-student-view" role="presentation"></i> Launch Student View</a>Q      *N·Æ      removeR     ş…½‘%      .btn.button-sidebar-wide.quick-accessS      £eb
      current_nameT   c½Ó      current_emailU      |ğ´	      current_courseV     }"¹      Entry point NewW    X“‡·      createFragmentX     À±¦“      htmlStr`    ¤%q      $targeta    Ø1:ò      querySelectorb      £“°      .show-contentc      ·œM§      HELLO WORLD!!!!d    ŞŠüg—      <iframe id="fs-iframe" title="Content Page Rating" src="https://moringa.formstack.com/forms/student_contract_copy" width="100%" height="400x"></iframe>e    (§
      waitForElmf     2Opƒ
      #fs-iframej     R1(ù      populateFormStackFormk      4ZËÅ	      fs_iframem      2‡U)      loadr   qA.j      course_segmentsu    ÌÈy      page_segments©      àÍ      bindª   òŞ0      getDocButton«   ¸Ôè       .submission-details-frame iframe¬   ¹Ñ      contents­   V,
‰#      a.file-upload-submission-info__link®    Ğê—é      getFbButton¯    |½JŠ!      a.modal_preview_link.Button--link°      BŒ|      addClass±   øñµÉ      download²   D»Š`      feedback-btn³   iy†      a.feedback-btn¹     ï¹Ó“      div.expand-btnÇ     H¥e      span.ui-icon.ui-icon-closethickÈ     _l$      selectorÉ   şUyh      observerÑ   %€‰ş      i[r]<Ò      ‘&·U      \/courses\/(\d+)Ó   v–a      d1<     Ä
  ï%,‰                                                                                                                                      	                                          ³OŒc         :  S  T  U  j  e               i `s  o  g  r `a  m                                     P    P  PA          6                                                 Ø  W  `                ;  <  =  >  ?  @  A                ª  ®  ¯Â0°Ò      Iô$KE®úš‡&Õª!«!	      |   |   K                        ÓÄ   Ö¸   ¸   H¸   ¸   HG   —   ‘   Öc    ‘   I   ØG   Û·   s ÖŸ6 	`PÀ P4 P      p   p   3                          µ       o ØG   Ûs  Öµ       o ØG   Ûs  ÖŸ@ `P+P*P4 `P+P*/P4P      t  T  z         
       E       $Å   Öµ             s Öµ   G   Ä   Öµ          ·   s Öµ	   ØG
   Û   µ   G   o ÿ–X   ‘   Öµ	   ØG
   Û   µ   G   o ÿ–,   ‘   Öµ	   ØG
   Û   µ   G   o ÿ‘   ”   ‘      Ä  Ö“Ã   ‘   µ	   ØG
   Û   µ   G   o ÿ–,   ‘"   Öµ	   ØG
   Û   µ   G   o ÿ‘(   ”   ‘)      Ä  Ö“S   ‘)   µ	   ØG
   Û   µ   G   o ÿ”   ‘0      Ä  Ö“   ‘0      Ä  Ö‘0   µ          ·  s Ö¤µ   G   G   ØG   Ûg   o Å   Ö¸   H”X   ‘9   µ	   ØG   Û   ¸   H%h   o Ä  Öµ	   ØG   Û·  o ØG   Ûh   s Ö“   ‘C   µ          s Ö‘E   “   ‘E    ¦«¬  Ö¬  ÖÉ‘E   Ÿ@0000 `P7@ `P• PD `P? `P” PD `P› P¬ 7P¬ 9P•0 `P”0 `P› P¬ 7P•0 `P”0 `P› P0 `P”00 `PO `P” PD 1 `P› !P9 `P‘@% `P PH, `P P/	PN30 `P P–@6 ‘@:P    t  d     h     ÿÿÿÿ        º  ¦   	   ô   ô   –                         h   Ä  Öµ   ØG   Û   s Öµ    s  Öµ   G   G   Ä   Öµ	   ØG
   Û   o Ä  Ö²      Á   Ö²      Á   Öµ       o ØG   Û2i   s ÖŸJ `P‘ P4 `PJ `P”@E `P‘ 	P8 `P0 `P@V `P+
P PDbP        ¶                         ¸   ¸   I   Ö¸   ¸   ¸   ¸   H—   ‘   Öh   ‘   KÖ¸   ¸   Hµ   |Ú  }  )I   Ö¶ ØG   Û¶ o Ã Ö¶ ØG   Û¶ o HÃ Ö¶ I   Ö¶ ¶ I   Ö¶ G	   ØG
   Û¶ ¶ s ÖŸ0 `P0 `P¬@ – P: `P-P7 -P9 `P: `P< `P• P4P     x  x  ù                         µ       o ØG   Ûo  ØG   Û   o Ä   Öµ       o ØG   Ûo  ØG   Û   o Ä  Ö·   ØG   Û   s Ö·  ØG   Û	   s Öµ    µ
   o ØG   Û      h   s Öµ    µ
   o ØG   Û      h   s Öµ    µ
   o ØG   Û      h   s ÖŸ@ `P+P*%P/P8 `P+P*%P/PH `P P4 `P PD
 `P+P™ PD `P+P™ PD# `P+P™ PD-P       Ü   Ü                            ¶  G   ØG   Û   o –   ‘   Ö¶  G      ‘   ”U   ‘   µ   ØG   Û   µ	   ØG
   Û¶  G   o %s Öµ       o ØG   Û   s Ö‘   Ÿ@ `P” P«0 `P¥ 'P$ÿÿÿáP4 `P+P/PIP      d  d  Â                5        µ   G   ØG   Û   o –(   ‘   Öµ       o ØG   Û   o ‘	   ”   ‘
   Ä   Ö“   ‘
   Ä   Ö‘
   µ	   G
   G   ØG   Û   o ÿÄ  Öµ	   G
   G   Ä  Öµ       o ØG   Û   o Ä  Ö²   µ       o ØG   Û   o Á   Ö·   –!   ‘   Ö·  –   ‘   Öµ   ‘!   ”€   ‘"   ·  ØG   Û   o ØG   Ûo  ØG   Û   o HÄ  Ö   ·  %   %Ä  Öµ       o ØG   Û   ·  %   %s Ö“(   ‘1   µ       o ØG   Û   s Ö‘5   Ÿ0@ `P– P™ P/TP’0 `P00 `PK `P›  P; `P”@ `P+P/DPH `P P/'PI `P´0 `P P*P/P: `P•0 `P+Pš +P>0 `P+P/+PI#P      h  h  å                         Ñ   h    µ   µ            s Öµ   ØG	   Û
   h   s Öµ    µ   o ØG   Ûh   s Öµ    µ   o ØG   Ûh   s Ö²   h   Á   Ö²   Á   Ö²   Á   Ö²   Á   Öµ    h   s Öµ    µ   o ØG   Û   h   s ÖŸE `PF™ PD`P– PD`P+P/PDe`P+P/PDp%`PK€  ¥%`P7%`P7%`P70`P+PD€ á`P+P” 	PD€ " P    3õØ  p  p                                          
  p  p  p  p  p  p                =    pr  u    pk    p  p  p  p    r  É    pÈ    `     p	  l                  `  p  p  p    {  	  
 
      p$      p  p:    pS  T  U  	  p©  m    p  `                    $          `
      !  "  #  €  $  $  %  &  '  (  )  K  *    +  ,  Y     P©   -    p/  c     p4  5    `  `q      `$  7  8  9    `
  p    V  :    +  D    a  b  X  c  d  e  f  ¦    p  `"  '  Ğ   (  $  B  œ C    +  D  E  F  ,  G  H  I  ^  J  K  /  L  M  N  O  P  Q  R  	  `$  «  ¬     ­  ¯  °  ±  ²       ³    p¹    pÇ    pÿX„2                 '                y      Ñ        K                Z                        Ó    ` 	               ` 	 |                ”      :       
                         W    `  	               `)	       j     `  	                                                                                                         ±                            	  ` 	             	  ` 	             	  ` 	 %      e     `  	 !              )                  )  H©À      V      V                 €©  à  ¡  à  	   	               :  ø  :                  b  ª  Z  ª     +          €Ê  J  Â  J                   á	  •
  Ù	  •
  E   B            ¾
  Ä  ¶
  Ä  L   $            ÿ    ÷    f                J    B    q   #            {  ˜#  r  ˜#  ¬   	             ³  Ô  œ  Ô  æ               n"  ñ"  n"  ñ"    "          €¼#  Æ>  #  Æ>               Æ$  Ã>  ¾$  Ã>    /            1'  «>  )'  «>  &  A           ³,  š>  «,  š>  E  i           …/  …>  }/  …>  S  e           3  m>  ı2  m>  i  D            ¾9  O>  ¶9  O>  Š  p           dD  çS  \D  çS  â               —F  "H  F  "H  ì  6             …H  #P  }H  #P  ò  6             £P  ãS  ›P  ãS    F           €şS  V  ëS  V              €"T  V  "T  V                ÖT  ’U  ÖT  ’U    .          5¡İ1q&»j      0ck\ìck\ìDì¹~ùôp   ª    O^partitionKey=%28https%2Cinstructure.com%29,:https://instructure-uploads-eu.s3.eu-west-1.amazonaws.com/account_118060000000000001/attachments/94734/MoringaInstructure.js necko:classified 1 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAAAAgAAAAAAAAAAAAAAAAAAAAEANwFmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAe5MIIHtTCCBp2gAwIBAgIQAjRkmiNOB+07mGrzp1Qm3zANBgkqhkiG9w0BAQsFADBGMQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRUwEwYDVQQLEwxTZXJ2ZXIgQ0EgMUIxDzANBgNVBAMTBkFtYXpvbjAeFw0yMjA5MjEwMDAwMDBaFw0yMzA4MzAyMzU5NTlaMCcxJTAjBgNVBAMMHCouczMtZXUtd2VzdC0xLmFtYXpvbmF3cy5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDBPYzZ+jACdNoNdeRuFZNT2plsYEhCgfxr/hTGvc62XaxItImHQeIk007/fR4pq+AaqbgTyGn9gTkgab92d3KhNwnqTt1+w9VbeiA/H9/gGX3SrrI8Tsdtm7rMrcIcH3+3hyj2fsLWDPEGc+qtTEPCIeds219tihGIN3B3m7gO1/NQhGw7yu6a5gbH35IQEqqCqtHf/QYdGdgnQP20NIxJp38V3z2KAvdf5Bs+y5LlnWGT95P029JTr3stl7rH2VRgk8WzfZdgSBjf6jbG3M1NEoSuNUhlmN/sclF3WOVKeQryvr8sRarZbFVpuebAsfuxtu7h1O34wSOKC2X7cdy3AgMBAAGjggS8MIIEuDAfBgNVHSMEGDAWgBRZpGYGUqB7lZI8o5QHJ5Z0W/k90DAdBgNVHQ4EFgQUthWF3suoKxNHBh8ORBo/RbreluwwggHpBgNVHREEggHgMIIB3IIaczMtZXUtd2VzdC0xLmFtYXpvbmF3cy5jb22CHCouczMtZXUtd2VzdC0xLmFtYXpvbmF3cy5jb22CGnMzLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tghwqLnMzLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tgiRzMy5kdWFsc3RhY2suZXUtd2VzdC0xLmFtYXpvbmF3cy5jb22CJiouczMuZHVhbHN0YWNrLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tghIqLnMzLmFtYXpvbmF3cy5jb22CJCouczMtY29udHJvbC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbYIiczMtY29udHJvbC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbYIuKi5zMy1jb250cm9sLmR1YWxzdGFjay5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbYIsczMtY29udHJvbC5kdWFsc3RhY2suZXUtd2VzdC0xLmFtYXpvbmF3cy5jb22CKCouczMtYWNjZXNzcG9pbnQuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb22CMiouczMtYWNjZXNzcG9pbnQuZHVhbHN0YWNrLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwPQYDVR0fBDYwNDAyoDCgLoYsaHR0cDovL2NybC5zY2ExYi5hbWF6b250cnVzdC5jb20vc2NhMWItMS5jcmwwEwYDVR0gBAwwCjAIBgZngQwBAgEwdQYIKwYBBQUHAQEEaTBnMC0GCCsGAQUFBzABhiFodHRwOi8vb2NzcC5zY2ExYi5hbWF6b250cnVzdC5jb20wNgYIKwYBBQUHMAKGKmh0dHA6Ly9jcnQuc2NhMWIuYW1hem9udHJ1c3QuY29tL3NjYTFiLmNydDAMBgNVHRMBAf8EAjAAMIIBfwYKKwYBBAHWeQIEAgSCAW8EggFrAWkAdwCt9776fP8QyIudPZwePhhqtGcpXc+xDCTKhYY069yCigAAAYNhwherAAAEAwBIMEYCIQDgRBxPtymAmcm9AzW9kSd/Vn8GyJRvxZ4xJ1MWUrIETQIhAILFERHNGbNwf8CffRPpC2K2KyqfmDUTct+2uumM7cG5AHYANc8ZG7+xbFe/D61MbULLu7YnICZR6j/hKu+oA8M71kwAAAGDYcIXlAAABAMARzBFAiAvqEurD5b8s/Ht3kygV9myJD0cOo0h+oOq0/Hda7ZQIgIhAM7BzLW+QOdzkxFP2lbHtkjeyoN7Diz4lRYr/clgGT3vAHYAs3N3B+GEUPhjhtYFqdwRCUp5LbFnDAuH3PADDnk2pZoAAAGDYcIYDAAABAMARzBFAiEA84t/rHH6TckTADTvO1mIJs7BXFBz6H7kP5JZujbKshcCIHrfNR6ikh6yTOHGcBuldNCDPIjIPLT7EJfpaqH2TP55MA0GCSqGSIb3DQEBCwUAA4IBAQCJN76zZCNel7ZC9o7XhLUyBvkcvqxDJoFkqP3BPTIu+lfKb+/5wUVW4R1+/wk5Dz0WxUszZZpgIDcuucBfSaVfbs7r4HUYGQ6TnT3j4+IQW2xFnLBKH2cDxSyTERbhtVvH7mPuYZekjn5WDxLjRCHe920InLU67s8eMveKJGeyBgy677TaQwXhLqZPY2x9vFafasrlZihsoDAOS9BKtzWDlHX0t3iCGO6C42zk6o8jY8Uymmw0b4IFKJnqu84eU49IMzz2oSIVEgm5+6VKT5hL8Ot6LBk6kLGnFyYOJhfrDXOOgyODE1XA/HxrSAIDEIKbXuZcjXsuxbXT64hS0u8QwC8AAwAAAAABAQAAAAAAAARQMjU2AAAAEFJTQS1QS0NTMS1TSEEyNTYAA2YKMiaRXE/7uyCJhaYy3wW9w5eaVCJM1YWJaWtuluqDAAAAAAAAB7kwgge1MIIGnaADAgECAhACNGSaI04H7TuYavOnVCbfMA0GCSqGSIb3DQEBCwUAMEYxCzAJBgNVBAYTAlVTMQ8wDQYDVQQKEwZBbWF6b24xFTATBgNVBAsTDFNlcnZlciBDQSAxQjEPMA0GA1UEAxMGQW1hem9uMB4XDTIyMDkyMTAwMDAwMFoXDTIzMDgzMDIzNTk1OVowJzElMCMGA1UEAwwcKi5zMy1ldS13ZXN0LTEuYW1hem9uYXdzLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAME9jNn6MAJ02g115G4Vk1PamWxgSEKB/Gv+FMa9zrZdrEi0iYdB4iTTTv99Himr4BqpuBPIaf2BOSBpv3Z3cqE3CepO3X7D1Vt6ID8f3+AZfdKusjxOx22busytwhwff7eHKPZ+wtYM8QZz6q1MQ8Ih52zbX22KEYg3cHebuA7X81CEbDvK7prmBsffkhASqoKq0d/9Bh0Z2CdA/bQ0jEmnfxXfPYoC91/kGz7LkuWdYZP3k/Tb0lOvey2XusfZVGCTxbN9l2BIGN/qNsbczU0ShK41SGWY3+xyUXdY5Up5CvK+vyxFqtlsVWm55sCx+7G27uHU7fjBI4oLZftx3LcCAwEAAaOCBLwwggS4MB8GA1UdIwQYMBaAFFmkZgZSoHuVkjyjlAcnlnRb+T3QMB0GA1UdDgQWBBS2FYXey6grE0cGHw5EGj9Fut6W7DCCAekGA1UdEQSCAeAwggHcghpzMy1ldS13ZXN0LTEuYW1hem9uYXdzLmNvbYIcKi5zMy1ldS13ZXN0LTEuYW1hem9uYXdzLmNvbYIaczMuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb22CHCouczMuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb22CJHMzLmR1YWxzdGFjay5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbYImKi5zMy5kdWFsc3RhY2suZXUtd2VzdC0xLmFtYXpvbmF3cy5jb22CEiouczMuYW1hem9uYXdzLmNvbYIkKi5zMy1jb250cm9sLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tgiJzMy1jb250cm9sLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tgi4qLnMzLWNvbnRyb2wuZHVhbHN0YWNrLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tgixzMy1jb250cm9sLmR1YWxzdGFjay5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbYIoKi5zMy1hY2Nlc3Nwb2ludC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbYIyKi5zMy1hY2Nlc3Nwb2ludC5kdWFsc3RhY2suZXUtd2VzdC0xLmFtYXpvbmF3cy5jb20wDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjA9BgNVHR8ENjA0MDKgMKAuhixodHRwOi8vY3JsLnNjYTFiLmFtYXpvbnRydXN0LmNvbS9zY2ExYi0xLmNybDATBgNVHSAEDDAKMAgGBmeBDAECATB1BggrBgEFBQcBAQRpMGcwLQYIKwYBBQUHMAGGIWh0dHA6Ly9vY3NwLnNjYTFiLmFtYXpvbnRydXN0LmNvbTA2BggrBgEFBQcwAoYqaHR0cDovL2NydC5zY2ExYi5hbWF6b250cnVzdC5jb20vc2NhMWIuY3J0MAwGA1UdEwEB/wQCMAAwggF/BgorBgEEAdZ5AgQCBIIBbwSCAWsBaQB3AK33vvp8/xDIi509nB4+GGq0Zyldz7EMJMqFhjTr3IKKAAABg2HCF6sAAAQDAEgwRgIhAOBEHE+3KYCZyb0DNb2RJ39WfwbIlG/FnjEnUxZSsgRNAiEAgsUREc0Zs3B/wJ99E+kLYrYrKp+YNRNy37a66YztwbkAdgA1zxkbv7FsV78PrUxtQsu7ticgJlHqP+Eq76gDwzvWTAAAAYNhwheUAAAEAwBHMEUCIC+oS6sPlvyz8e3eTKBX2bIkPRw6jSH6g6rT8d1rtlAiAiEAzsHMtb5A53OTEU/aVse2SN7Kg3sOLPiVFiv9yWAZPe8AdgCzc3cH4YRQ+GOG1gWp3BEJSnktsWcMC4fc8AMOeTalmgAAAYNhwhgMAAAEAwBHMEUCIQDzi3+scfpNyRMANO87WYgmzsFcUHPofuQ/klm6NsqyFwIget81HqKSHrJM4cZwG6V00IM8iMg8tPsQl+lqofZM/nkwDQYJKoZIhvcNAQELBQADggEBAIk3vrNkI16XtkL2jteEtTIG+Ry+rEMmgWSo/cE9Mi76V8pv7/nBRVbhHX7/CTkPPRbFSzNlmmAgNy65wF9JpV9uzuvgdRgZDpOdPePj4hBbbEWcsEofZwPFLJMRFuG1W8fuY+5hl6SOflYPEuNEId73bQictTruzx4y94okZ7IGDLrvtNpDBeEupk9jbH28Vp9qyuVmKGygMA5L0Eq3NYOUdfS3eIIY7oLjbOTqjyNjxTKabDRvggUomeq7zh5Tj0gzPPahIhUSCbn7pUpPmEvw63osGTqQsacXJg4mF+sNc46DI4MTVcD8fGtIAgMQgpte5lyNey7FtdPriFLS7xBmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAARNMIIESTCCAzGgAwIBAgITBntQXCplJ7wevi2i0ZmY7bibLDANBgkqhkiG9w0BAQsFADA5MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRkwFwYDVQQDExBBbWF6b24gUm9vdCBDQSAxMB4XDTE1MTAyMTIyMjQzNFoXDTQwMTAyMTIyMjQzNFowRjELMAkGA1UEBhMCVVMxDzANBgNVBAoTBkFtYXpvbjEVMBMGA1UECxMMU2VydmVyIENBIDFCMQ8wDQYDVQQDEwZBbWF6b24wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDCThZn3c68asg3Wuw6MLAd5tES6BIoSMzoKcG5blPVo+sDORrMd4f2AbnZcMzPa43j4wNxhplty6aUKk4T1qe9BOwKFjwK6zmxxLVYo7bHViXsPlJ6qOMpFge5blDP+18x+B26A0piiQOuPkfyDyeR4xQghfj66Yo19V+emU3nazfvpFA+ROz6WoVmB5x+F2pV8xeKNR7u6azDdU5YVX1TawprmxRC1+WsAYmz6qP+z8ArDITC2FMVy2fw0IjKOtEXc/VfmtTFch5+AfGYMGMqqvJ6LcXiAhqG5TI+Dr0RtM88k+8XUBCeQ8IGKuANaL7TiItKZYxK1MMuTJtV9IblAgMBAAGjggE7MIIBNzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjAdBgNVHQ4EFgQUWaRmBlKge5WSPKOUByeWdFv5PdAwHwYDVR0jBBgwFoAUhBjMhTTsvAyUlC4IWZzHshBOCggwewYIKwYBBQUHAQEEbzBtMC8GCCsGAQUFBzABhiNodHRwOi8vb2NzcC5yb290Y2ExLmFtYXpvbnRydXN0LmNvbTA6BggrBgEFBQcwAoYuaHR0cDovL2NybC5yb290Y2ExLmFtYXpvbnRydXN0LmNvbS9yb290Y2ExLmNlcjA/BgNVHR8EODA2MDSgMqAwhi5odHRwOi8vY3JsLnJvb3RjYTEuYW1hem9udHJ1c3QuY29tL3Jvb3RjYTEuY3JsMBMGA1UdIAQMMAowCAYGZ4EMAQIBMA0GCSqGSIb3DQEBCwUAA4IBAQAfsaEKwn17DjAbi/Die0etn+PEgfY/I6s8NLWkxGAOUfW2o+vVowNARRVjaIGdrhAfeWHkZI6q2pI0x/IJYmymmcWaZaW/2R7DvQDtxCkFkVaxUeHvENm6IyqVhf6Q5oN12kDSrJozzx7I7tHjhBK7V5XoTyS4NU4EhSyzGgj2x6axDd1hHRjblEpJ80LoiXlmUDzputBXyO5mkcrplcVvlIJiWmKjrDn2zzKxDX5nwvkskpIjYlJcrQu4iCX1/YwZ1yNqF9LryjlilphHCACiHbhIRnGfN8j8KLDVmWyTYMk8V+6j0LI4+4zFh2upqGMQHL3VFVFWBek6vCDWhB/bZgoyJpFcT/u7IImFpjLfBb3Dl5pUIkzVhYlpa26W6oMAAAAAAAADRTCCA0EwggIpoAMCAQICEwZsn8+Zv4wKOeLweIpD5pY2W8owDQYJKoZIhvcNAQELBQAwOTELMAkGA1UEBhMCVVMxDzANBgNVBAoTBkFtYXpvbjEZMBcGA1UEAxMQQW1hem9uIFJvb3QgQ0EgMTAeFw0xNTA1MjYwMDAwMDBaFw0zODAxMTcwMDAwMDBaMDkxCzAJBgNVBAYTAlVTMQ8wDQYDVQQKEwZBbWF6b24xGTAXBgNVBAMTEEFtYXpvbiBSb290IENBIDEwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCyeIBxynjV43GvR4BQdH1u2NeIdvSZaPdYIWD5dIQBL6wCLYbToEN6TrKk0Da6Ab6N20jIBxc2TPTuiCPHPus39bUZ+ElosN7XuXY4HWGepP6CNqXlSlbkReH5/bQW+nTanJs1OS/6sCBQBmx60ICypvmv7EcZj1A4B9yihzlY+LrVqflIZzCW7pR4Xm+Jo1HAMIZmoUVmulTro8OR+Ujc/9HoMC19LXRwNdeIJPeexFluu3OHF/IyRii4Q/q3HarKtPKfJA4tS/dxXF5p/+qVAss4iq5QOG/b+y1iG8XHHlThd+BnyA+chyPWP0AgfyCAxIBMPjskJo4ErmyayKoNAgMBAAGjQjBAMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgGGMB0GA1UdDgQWBBSEGMyFNOy8DJSULghZnMeyEE4KCDANBgkqhkiG9w0BAQsFAAOCAQEAmPI3WkGQoRrFdlEoIDYjDq7mKLuq+JSuSKQwfxv8JI1LtMihl/a28XpwyFOTzAgo45glzyOk+d4h03yFCa1OmnU6wgtqiXh2REcYZWyNQY47f5rL9LWnUNcFLDfoA0ut6WGgAm718vDFsu1bt9z6lFx3nhOlf1KtlfL4kzvei1xbylpSW2CvFPdL76P7n0CVbTFU/ELTx0YfI63ZD0hwmtl1eHHRckM0dW5XWcICXCZgKc8jGRaOiEOl1OTLCPsjEUPoQylyYqGpXV4I1JCuuNjOFMLQVfKG9sSTQ3dmYcC56EHXl3hgA25Kcq6l0X26EJ6GbBuKuVkz+OvEkL7xuQAAAAEAAAAIaHR0cC8xLjEAAQAAAABzdGxzZmxhZ3MweDAwMDAwMDAwOmluc3RydWN0dXJlLXVwbG9hZHMtZXUuczMuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb206NDQzXnBhcnRpdGlvbktleT0lMjhodHRwcyUyQ2luc3RydWN0dXJlLmNvbSUyOQ== request-method GET response-head HTTP/1.1 200 OK
x-amz-id-2: a7YqHSGiz/6UweJ+VGl90pHPcTiEeYxtPpjx2Rk/hcD6tWp95F0LEgNhW9aTXGIMUTmUgVr29sw=
x-amz-request-id: P71J49QP0G7JZYNG
Date: Thu, 03 Nov 2022 12:20:16 GMT
Last-Modified: Mon, 04 Jul 2022 08:51:00 GMT
ETag: "4b48eb3635609064ad738e738a5f642b"
Cache-Control: Cache-Control:max-age=473354280, public
Expires: Sat, 04 Jul 2037 08:50:59 GMT
x-amz-version-id: 8_BRaOWSoN1PS8FLmD0h3GLlJsSFs_il
Accept-Ranges: bytes
Content-Type: text/javascript
Server: AmazonS3
Content-Length: 22028
 original-response-headers x-amz-id-2: a7YqHSGiz/6UweJ+VGl90pHPcTiEeYxtPpjx2Rk/hcD6tWp95F0LEgNhW9aTXGIMUTmUgVr29sw=
x-amz-request-id: P71J49QP0G7JZYNG
Date: Thu, 03 Nov 2022 12:20:16 GMT
Last-Modified: Mon, 04 Jul 2022 08:51:00 GMT
ETag: "4b48eb3635609064ad738e738a5f642b"
Cache-Control: Cache-Control:max-age=473354280, public
Expires: Sat, 04 Jul 2037 08:50:59 GMT
x-amz-version-id: 8_BRaOWSoN1PS8FLmD0h3GLlJsSFs_il
Accept-Ranges: bytes
Content-Type: text/javascript
Server: AmazonS3
Content-Length: 22028
 ctid 2 uncompressed-len 0 net-response-time-onstart 2058 net-response-time-onstop 2653 alt-data 1;22028,javascript/moz-bytecode-20220202182137-8l alt-data-from-child 1   ÓL