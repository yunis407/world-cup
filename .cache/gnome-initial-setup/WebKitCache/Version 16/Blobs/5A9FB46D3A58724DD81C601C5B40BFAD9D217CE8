function Encrypt(e,t,n,a){var o=[];switch(n.toLowerCase()){case"chgsqsa":if(null==e||null==t){return null}o=PackageSAData(e,t);break;case"chgpwd":if(null==e||null==a){return null}o=PackageNewAndOldPwd(e,a);break;case"pwd":if(null==e){return null}o=PackagePwdOnly(e);break;case"pin":if(null==e){return null}o=PackagePinOnly(e);break;case"proof":if(null==e&&null==t){return null}o=PackageLoginIntData(null!=e?e:t);break;case"saproof":if(null==t){return null}o=PackageSADataForProof(t);break;case"newpwd":if(null==a){return null
}o=PackageNewPwdOnly(a)}if(null==o||"undefined"==typeof o){return o}if("undefined"!=typeof Key&&void 0!==parseRSAKeyFromString){var i=parseRSAKeyFromString(Key)}var r=RSAEncrypt(o,i,randomNum);return r}function PackageSAData(e,t){var n=[],a=0;n[a++]=1,n[a++]=1,n[a++]=0;var o,i=t.length;for(n[a++]=2*i,o=0;i>o;o++){n[a++]=255&t.charCodeAt(o),n[a++]=(65280&t.charCodeAt(o))>>8}var r=e.length;for(n[a++]=r,o=0;r>o;o++){n[a++]=127&e.charCodeAt(o)}return n}function PackagePwdOnly(e){var t=[],n=0;t[n++]=1,t[n++]=1,t[n++]=0,t[n++]=0;
var a,o=e.length;for(t[n++]=o,a=0;o>a;a++){t[n++]=127&e.charCodeAt(a)}return t}function PackagePinOnly(e){var t=[],n=0;t[n++]=1,t[n++]=2,t[n++]=0,t[n++]=0,t[n++]=0;var a,o=e.length;for(t[n++]=o,a=0;o>a;a++){t[n++]=127&e.charCodeAt(a)}return t}function PackageLoginIntData(e){var t,n=[],a=0;for(t=0;t<e.length;t++){n[a++]=255&e.charCodeAt(t),n[a++]=(65280&e.charCodeAt(t))>>8}return n}function PackageSADataForProof(e){var t,n=[],a=0;for(t=0;t<e.length;t++){n[a++]=127&e.charCodeAt(t),n[a++]=(65280&e.charCodeAt(t))>>8
}return n}function PackageNewPwdOnly(e){var t=[],n=0;t[n++]=1,t[n++]=1;var a,o=e.length;for(t[n++]=o,a=0;o>a;a++){t[n++]=127&e.charCodeAt(a)}return t[n++]=0,t[n++]=0,t}function PackageNewAndOldPwd(e,t){var n=[],a=0;n[a++]=1,n[a++]=1;var o,i=t.length;for(n[a++]=i,o=0;i>o;o++){n[a++]=127&t.charCodeAt(o)}for(n[a++]=0,i=e.length,n[a++]=i,o=0;i>o;o++){n[a++]=127&e.charCodeAt(o)}return n}function mapByteToBase64(e){return e>=0&&26>e?String.fromCharCode(65+e):e>=26&&52>e?String.fromCharCode(97+e-26):e>=52&&62>e?String.fromCharCode(48+e-52):62==e?"+":"/"
}function base64Encode(e,t){var n,a="";for(n=t;4>n;n++){e>>=6}for(n=0;t>n;n++){a=mapByteToBase64(63&e)+a,e>>=6}return a}function byteArrayToBase64(e){var t,n,a=e.length,o="";for(t=a-3;t>=0;t-=3){n=e[t]|e[t+1]<<8|e[t+2]<<16,o+=base64Encode(n,4)}var i=a%3;for(n=0,t+=2;t>=0;t--){n=n<<8|e[t]}return 1==i?o=o+base64Encode(n<<16,2)+"==":2==i&&(o=o+base64Encode(n<<8,3)+"="),o}function parseRSAKeyFromString(e){var t=e.indexOf(";");if(0>t){return null}var n=e.substr(0,t),a=e.substr(t+1),o=n.indexOf("=");if(0>o){return null
}var i=n.substr(o+1);if(o=a.indexOf("="),0>o){return null}var r=a.substr(o+1),s=new Object;return s.n=hexStringToMP(r),s.e=parseInt(i,16),s}function RSAEncrypt(e,t){for(var n=[],a=42,o=2*t.n.size-a,i=0;i<e.length;i+=o){if(i+o>=e.length){var r=RSAEncryptBlock(e.slice(i),t,randomNum);r&&(n=r.concat(n))}else{var r=RSAEncryptBlock(e.slice(i,i+o),t,randomNum);r&&(n=r.concat(n))}}var s=byteArrayToBase64(n);return s}function RSAEncryptBlock(e,t,n){var a=t.n,o=t.e,i=e.length,r=2*a.size,s=42;if(i+s>r){return null}applyPKCSv2Padding(e,r,n),e=e.reverse();
var l=byteArrayToMP(e),d=modularExp(l,o,a);d.size=a.size;var c=mpToByteArray(d);return c=c.reverse()}function JSMPnumber(){this.size=1,this.data=[],this.data[0]=0}function duplicateMP(e){var t=new JSMPnumber;return t.size=e.size,t.data=e.data.slice(0),t}function byteArrayToMP(e){var t=new JSMPnumber,n=0,a=e.length,o=a>>1;for(n=0;o>n;n++){t.data[n]=e[2*n]+(e[1+2*n]<<8)}return a%2&&(t.data[n++]=e[a-1]),t.size=n,t}function mpToByteArray(e){var t=[],n=0,a=e.size;for(n=0;a>n;n++){t[2*n]=255&e.data[n];var o=e.data[n]>>>8;
t[2*n+1]=o}return t}function modularExp(e,t,n){for(var a=[],o=0;t>0;){a[o]=1&t,t>>>=1,o++}for(var i=duplicateMP(e),r=o-2;r>=0;r--){i=modularMultiply(i,i,n),1==a[r]&&(i=modularMultiply(i,e,n))}return i}function modularMultiply(e,t,n){var a=multiplyMP(e,t),o=divideMP(a,n);return o.r}function multiplyMP(e,t){var n=new JSMPnumber;n.size=e.size+t.size;var a,o;for(a=0;a<n.size;a++){n.data[a]=0}var i=e.data,r=t.data,s=n.data;if(e==t){for(a=0;a<e.size;a++){s[2*a]+=i[a]*i[a]}for(a=1;a<e.size;a++){for(o=0;a>o;o++){s[a+o]+=2*i[a]*i[o]
}}}else{for(a=0;a<e.size;a++){for(o=0;o<t.size;o++){s[a+o]+=i[a]*r[o]}}}return normalizeJSMP(n),n}function normalizeJSMP(e){var t,n,a,o,i;for(a=e.size,n=0,t=0;a>t;t++){o=e.data[t],o+=n,i=o,n=Math.floor(o/65536),o-=65536*n,e.data[t]=o}}function removeLeadingZeroes(e){for(var t=e.size-1;t>0&&0==e.data[t--];){e.size--}}function divideMP(e,t){var n=e.size,a=t.size,o=t.data[a-1],i=t.data[a-1]+t.data[a-2]/65536,r=new JSMPnumber;r.size=n-a+1,e.data[n]=0;for(var s=n-1;s>=a-1;s--){var l=s-a+1,d=Math.floor((65536*e.data[s+1]+e.data[s])/i);
if(d>0){var c=multiplyAndSubtract(e,d,t,l);for(0>c&&(d--,multiplyAndSubtract(e,d,t,l));c>0&&e.data[s]>=o;){c=multiplyAndSubtract(e,1,t,l),c>0&&d++}}r.data[l]=d}removeLeadingZeroes(e);var u={"q":r,"r":e};return u}function multiplyAndSubtract(e,t,n,a){var o,i=e.data.slice(0),r=0,s=e.data;for(o=0;o<n.size;o++){var l=r+n.data[o]*t;r=l>>>16,l-=65536*r,l>s[o+a]?(s[o+a]+=65536-l,r++):s[o+a]-=l}return r>0&&(s[o+a]-=r),s[o+a]<0?(e.data=i.slice(0),-1):1}function applyPKCSv2Padding(e,t,n){var a,o=e.length,i=[218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9],r=t-o-40-2,s=[];
for(a=0;r>a;a++){s[a]=0}s[r]=1;var l=i.concat(s,e),d=[];for(a=0;20>a;a++){d[a]=Math.floor(256*Math.random())}d=SHA1(d.concat(n));var c=MGF(d,t-21),u=XORarrays(l,c),p=MGF(u,20),m=XORarrays(d,p),g=[];for(g[0]=0,g=g.concat(m,u),a=0;a<g.length;a++){e[a]=g[a]}}function MGF(e,t){if(t>4096){return null}var n=e.slice(0),a=n.length;n[a++]=0,n[a++]=0,n[a++]=0,n[a]=0;for(var o=0,i=[];i.length<t;){n[a]=o++,i=i.concat(SHA1(n))}return i.slice(0,t)}function XORarrays(e,t){if(e.length!=t.length){return null}for(var n=[],a=e.length,o=0;a>o;o++){n[o]=e[o]^t[o]
}return n}function SHA1(e){var t,n=e.slice(0);PadSHA1Input(n);var a={"A":1732584193,"B":4023233417,"C":2562383102,"D":271733878,"E":3285377520};for(t=0;t<n.length;t+=64){SHA1RoundFunction(a,n,t)}var o=[];return wordToBytes(a.A,o,0),wordToBytes(a.B,o,4),wordToBytes(a.C,o,8),wordToBytes(a.D,o,12),wordToBytes(a.E,o,16),o}function wordToBytes(e,t,n){var a;for(a=3;a>=0;a--){t[n+a]=255&e,e>>>=8}}function PadSHA1Input(e){var t,n=e.length,a=n,o=n%64,i=55>o?56:120;for(e[a++]=128,t=o+1;i>t;t++){e[a++]=0}var r=8*n;for(t=1;8>t;t++){e[a+8-t]=255&r,r>>>=8
}}function SHA1RoundFunction(e,t,n){var a,o,i,r=1518500249,s=1859775393,l=2400959708,d=3395469782,c=[],u=e.A,p=e.B,m=e.C,g=e.D,f=e.E;for(o=0,i=n;16>o;o++,i+=4){c[o]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3]<<0}for(o=16;80>o;o++){c[o]=rotateLeft(c[o-3]^c[o-8]^c[o-14]^c[o-16],1)}var v;for(a=0;20>a;a++){v=rotateLeft(u,5)+(p&m|~p&g)+f+c[a]+r&4294967295,f=g,g=m,m=rotateLeft(p,30),p=u,u=v}for(a=20;40>a;a++){v=rotateLeft(u,5)+(p^m^g)+f+c[a]+s&4294967295,f=g,g=m,m=rotateLeft(p,30),p=u,u=v}for(a=40;60>a;a++){v=rotateLeft(u,5)+(p&m|p&g|m&g)+f+c[a]+l&4294967295,f=g,g=m,m=rotateLeft(p,30),p=u,u=v
}for(a=60;80>a;a++){v=rotateLeft(u,5)+(p^m^g)+f+c[a]+d&4294967295,f=g,g=m,m=rotateLeft(p,30),p=u,u=v}e.A=e.A+u&4294967295,e.B=e.B+p&4294967295,e.C=e.C+m&4294967295,e.D=e.D+g&4294967295,e.E=e.E+f&4294967295}function rotateLeft(e,t){var n=e>>>32-t,a=(1<<32-t)-1,o=e&a;return o<<t|n}function hexStringToMP(e){var t,n,a=Math.ceil(e.length/4),o=new JSMPnumber;for(o.size=a,t=0;a>t;t++){n=e.substr(4*t,4),o.data[a-1-t]=parseInt(n,16)}return o}!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t){return e?t&&t.length>6&&("data:"===t.substr(0,5).toLowerCase()||"http:"===t.substr(0,5).toLowerCase()||"https:"===t.substr(0,6).toLowerCase())?t:e+t:t
}e.getImagePath=t}(t=e.ImageHelper||(e.ImageHelper={}))}(t=e.Util||(e.Util={}))}(t=e.Account||(e.Account={}))}(wLive||(wLive={})),function(){var e=window,t=e.$Debug;t.assert(e.$Config,"ConfigBurner should output: $Config");var n=e.$Config;if(n.handlerBaseUrl=n.handlerBaseUrl||"",!n.sd){var a=document.domain,o=a.split(".");n.sd=1===o.length?"":"."+o[o.length-2]+".com"}t.assert(n.mkt,"ConfigBurner should output: $.$Config.mkt"),n.mkt=n.mkt||"na",n.prop=n.prop||"Account","undefined"!=typeof window.SymRealWinOpen&&(window.open=window.SymRealWinOpen)
}(),function(){var e=window,t=e.wLive;e.$Debug||(e.$Debug={"enabled":!1,"trace":function(){}});var n=e.document;e._d=n,e._ce=function(e){return n.createElement(e)},e._ge=function(e){return n.getElementById(e)},e._get=function(e){return n.getElementsByTagName(e)},e._dh=n.head=n.head||e._get("head")[0],t.dh=$PageHelper.byId("head")[0]||e._dh}(),function(){function _objectMap(e,t){for(var n in e){e.hasOwnProperty(n)&&t(n,e[n])}}function updateObject(e,t){for(var n in t){var a=e[n],o=t[n];o.constructor==Array?(a&&a.constructor==Array||(a=e[n]=[]),updateObject(a,o)):"object"==typeof o?("object"!=typeof a&&(a=e[n]={}),updateObject(a,o)):e[n]=o
}}function evalStringsAndAddScripts(e,t){for(var n=0;n<e.length;n++){$Utility.eval(e[n])}for(n=0;n<t.length;n++){if(t[n]&&""!=t[n]){var a=document.createElement("SCRIPT");a.src=t[n],document.body.appendChild(a)}}}function _getQsValues(e){var t={};if(e&&e.length>1){"?"===e[0]&&(e=e.substr(1));for(var n=e.split("&"),a=0;a<n.length;a++){var o=n[a].split("=");if(!(o.length<2)){var i=o[0],r=o[1];t[i]||(t[i]=[]),t[i].push(r)}}}return t}function _updateQsValues(e,t){return e=e||{},t&&_objectMap(t,function(t,n){e[t]=n
}),e}function _formatQsValues(e){var t="";return e&&_objectMap(e,function(e,n){for(var a=null,o=0;o<n.length;o++){null!==n[o]&&void 0!==n[o]&&(a?a+=",":a="",a+=n[o])}t&&(t+="&"),t+=e,null!==a&&(t+="="+a)}),t&&(t="?"+t),t}var w=window,$config=w.$Config,wl=w.wLive,Debug=w.$Debug,_ConstDefaultDeliminator="&",_ConstKeyValueDeliminator="=";wl.truncateEllipsis=function(e,t){return t=Math.max(parseInt(t,10)||1e5,4),e?e.length>t?e.substring(0,t-3)+"...":e:""};var $Utility=w.$Utility={};$Utility.eval=function(s){eval(s)
},$Utility.navigateTo=function(e,t){try{t?window.open(e,t):window.location.href=e}catch(n){setTimeout(function(){t?window.open(e,t):window.location.href=e},0)}},$Utility.postTo=function(e,t){if(e&&"object"==typeof t){var n,a=document.createElement("form");a.action=e,a.method="post";for(key in t){t.hasOwnProperty(key)&&(n=document.createElement("input"),n.type="hidden",n.id=key,n.name=key,n.value=t[key],a.appendChild(n))}document.body.appendChild(a),a.submit()}},$Utility.deserialize=function(e,t,n,a){var o={};
if(t=t||_ConstDefaultDeliminator,e){for(var i=e.split(t),r=i.length,s=0;r>s;s++){var l=i[s],d=l.split(_ConstKeyValueDeliminator);if(d.length>0){var c=d[0].trim();d.splice(0,1);var u=d.join(_ConstKeyValueDeliminator).trim();try{Debug.assert(n||void 0===o[c],"Duplicate key detected: "+c+" value: "+o[c]+" new value: "+(a?u:u.decodeUrl())),o[c]=a?u:u.decodeUrl()}catch(p){Debug.assert(!1,"Deserialize Failed on value: "+u),o[c]=""}}}}return o},$Utility.serialize=function(e,t,n){Debug.assert(e,"hashtable must be provided"),t=t||_ConstDefaultDeliminator;
var a=[];for(var o in e){var i=e[o];i=null==i?"":i.toString(),a.push(o,_ConstKeyValueDeliminator,n?i:i.encodeUrl(),t)}return a.length>0&&a.pop(),a.join("")},$Utility.updateObject=updateObject;var scrTag="scr";scrTag+="ipt";var endScrTag="/scr";endScrTag+="ipt";var ajaxInnerHtmlRegex=new RegExp("<"+scrTag+' type="text/javascript"( src="([^"]*?)"){0,1}(( loadfirst="true")|( defer="defer")){0,1}( id="[^"]*?"){0,1}>([\\w\\W]*?)<'+endScrTag+">","gim"),debuggerAjaxInnerHtmlRegex=new RegExp("<"+scrTag,"gim");$Utility.ajaxInnerHtml=function(e,t){ajaxInnerHtmlRegex.lastIndex=0;
for(var n,a=[],o=[],i=[],r=[],s=[],l=0;n=ajaxInnerHtmlRegex.exec(t);){a.push(t.substring(l,n.index)),n[4]&&""!=n[4]?(r.push(n[7]),s.push(n[2])):(o.push(n[7]),i.push(n[2])),l=ajaxInnerHtmlRegex.lastIndex}a.push(t.substring(l)),Debug.assert(0==(debuggerAjaxInnerHtmlRegex.lastIndex=0)&&!debuggerAjaxInnerHtmlRegex.exec(a.join("")),"Invalid ajax script reference"),evalStringsAndAddScripts(r,s),e.innerHTML=a.join(""),evalStringsAndAddScripts(o,i)},$Utility.generateGuid=function(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.floor(16*Math.random()),n="x"==e?t:3&t|8;
return n.toString(16)});return e},$Utility.firePageLoadEvent=function(e){$config.isCustomPerf||$Do.when("doc.load",function(){w.$ReportEvent.PageLoadCompleted(),w.$ReportEvent.Fire(e+"_Client")})},$Utility.generateUrl=function(e,t,n){var a="";if(e&&t){if(a=e+t,n){var o=a.indexOf("?");if(-1!==o){var i=_updateQsValues(_getQsValues(w.location.search),_getQsValues(a.substr(o)));a=a.substr(0,o),a+=_formatQsValues(i)}else{a+=w.location.search}}return a}return a},$Utility.addQueryString=function(e,t,n){if(e&&t&&"undefined"!=typeof n&&null!==n){var a=new RegExp("([?&])"+t+"=.*?(&|#|$)(.*)","gi");
if(a.test(e)){e=e.replace(a,"$1"+t+"="+encodeURI(n)+"$2$3")}else{var o=-1!==e.indexOf("?")?"&":"?";e+=o+t+"="+encodeURI(n)}}return e},$Utility.getQsValues=_getQsValues,$Utility.formatQsValues=_formatQsValues,$Utility.updateQsValues=_updateQsValues}(),function(){$PageHelper.onLoad(function(){var e=$PageHelper.get(document.body),t=$PageHelper.createShim("span").css({"borderLeftColor":"red","borderRightColor":"blue","position":"absolute","top":"-999px"}).appendTo(e);$Utility._isHighContrast=t.css("borderLeftColor")===t.css("borderRightColor"),t.remove(),$Utility._isHighContrast&&e.addClass("highContrast")
}),$Utility.isHighContrast=function(){return $Utility._isHighContrast}}(),function(){function e(e,i,s,l,d,c){r.assert(e,"$Beacon.fire: target required. Caller:"+arguments.callee.caller);var u=t();e=o(e,i),r.assert(c||e.length<=2e3,"Url is too long and will be truncated: "+e),e=e.substr(0,Math.min(e.length,2e3)),d||(e=o(e,{"r":Math.random()})),a(u,n(s,u),n(l,u)),u.src=e}function t(){for(var e,t=d.length,n=0;t>n;n++){var a=d[n];if(!a.inUse){e=a;break}}return e||(e=new Image,d.push(e)),e.inUse=!0,e}function n(e,t){return function(){a(t,null,null),t.inUse=!1,e&&e()
}}function a(e,t,n){e.onload=t,e.onabort=e.onerror=n}function o(e,t){if(e=e||"",t){var n=s.serialize(t),a="?";if(e.indexOf("?")>=0){var o=e.charAt(e.length-1);a="?"==o||"&"==o?"":"&"}e+=a+n}return e}var i=window,r=i.$Debug,s=i.$Utility,l=(i.wLive,i.$Beacon={}),d=[],c=150;l.Pool=d,l.fire=function(t,n,a,o,i,r){setTimeout(function(){e(t,n,a,o,i,r)},0)},l.fireAndHold=function(t,n){if(e(t,n),!$B.IE){for(var a=(new Date).getTime()+c;(new Date).getTime()<a;){}}},l.fireNow=e}(),function(){function e(e){return e?";SameSite=None":""
}var t,n,a,o=window,i=o.$Utility,r=o.$Debug,s=o.$Cookie={};s.getCookie=function(e,o){r.assert(e,"name must be provided");var s=document.cookie;if(s==t){if(o&&a){return a[e]}if(!o&&n){return n[e]}}else{n=0,a=0,t=s}var l=i.deserialize(document.cookie,";",!0,o);return o?a=l:n=l,l[e]},s.deleteCookie=function(e,t,n,a){r.assert(e,"name must be provided"),s.setCookie(e,"",t,n,new Date(2e3,1,1),!1,a)},s.setCookie=function(t,n,a,o,s,l,d,c){r.assert(t,"name must be provided");var u={};u[t]=n;var p;p=c&&"none"!==c.toLowerCase()?";SameSite="+c:e(d),document.cookie="{0};path={1};{2}{3}secure{4}".format(i.serialize(u,null,l),o?o:"/",a?"domain="+a+";":"",s?"expires="+s.toUTCString()+";":"",p)
},$Do.register("$Cookie"),$Do.register("$Cookie.setCookie")}(),function(){var e=window;e.wLive.PageStats={"d":[],"add":function(t,n){var a=e.wLive.PageStats;n=n||(new Date).getTime(),t=t||{"url":"Missing page stats.","tasks":[],"executionTimeMs":0,"schedulerTimeMs":0};var o=new Date;t.clientStart=n,t.clientLength=o.getTime()-n,t.clientTime=o,a.d.push(t),$PageHelper.get(a).trigger("go")}}}(),function(){var e=window;e.$f={"getSelectedText":function(){if(document.selection){return document.selection.createRange()
}var t;try{t=e.getSelection().getRangeAt(0)}catch(n){t=e.document.createRange()}return t},"replaceQs":function(e,t,n){var a="([?|&])"+t+"=([^&]+)",o=new RegExp(a,"i"),i=e,r="",s=e.indexOf("#");return s>-1&&(i=e.substr(0,s),r=e.substr(s)),i.replace(o,"$1"+t+"="+n)+r},"doc":document,"getDocType":function(){var e,t=$f.doc,n=t.doctype,a=t.all;return n?e=n.publicId:a&&a.length&&(e=a[0].nodeValue),e||""},"createLoading":function(t,n,a,o,i,r,s,l){var d,c=t;"object"==typeof t&&(c=t.returnMarkup,n=t.type,a=t.width,o=t.height,i=t.size,r=t.color,s=t.text,l=t.altText,d=t.useTransparentFallback),!l&&e.GetString&&(l=e.GetString("live.accounts.strings.general_module_loading")),n=n||$f.loadingType.spinning,a=a||"20px",o=o||a,i=i||"3px",r=r&&r.toLowerCase()||"#666",l=l||"";
var u,p="c_spinningDots",m=($Config.imgsBase||"/images")+"/common/";n==$f.loadingType.flying?(p="c_flyingDots",u="flyingdots.gif"):(u="spinner_",u+="#fff"==r?"white_":"grey_","60px"==a?u+="120":"30px"==a?u+="60":(u+="40",d&&"#fff"!=r&&(u+="_transparent")),u+=".gif");var g=m+u,f=document.createElement("div");$PageHelper.get(f).css({"width":a,"height":o,"font-size":i}),f.className=p+" c_loadingDots c_dotsPlaying";var v;if($B.IE&&$B.V<=9){v='<div class="c_loadingFallback"><img role="presentation" src="'+g+'" alt="'+l.encodeHtml()+'" width="'+a+'" height="'+o+'" /></div>'
}else{v='<div class="c_loadingFallback" role="presentation" style="background-image:url('+g+");background-size:"+a+" "+o+'" alt="'+l.encodeHtml()+'"></div>',v+='<div class="c_loadingTracks">';for(var b=5;b>0;b--){v+='<div class="c_loadingTrack c_loadingTrack'+b+'"><div class="c_loadingDot" style="background-color:'+r+'"></div></div>'}v+="</div>"}f.innerHTML=v;var h=$PageHelper.createShim("div").append(f);if(n==$f.loadingType.flying&&h.css({"width":a}),s){var C=document.createElement("span");C.className="c_loadingText",C.innerHTML=s.encodeHtml(),h.append(C)
}if(c){var w=$PageHelper.createShim("span").append(h),y=w.html();return w.remove(),y}return h[0]},"loadingType":{"spinning":0,"flying":1},"hideLoading":function(e){e.hide(),e.removeClass("c_dotsPlaying")},"showLoading":function(e){e.show(),e.addClass("c_dotsPlaying")}},$Do.register("$f")}(),function(){function e(){}function t(t){var n=c.Animations;return!n||e.$forcejQuery||t?!1:n.Enabled||!1}function n(e,t,n){if($B.IE){try{e[0].style.removeAttribute("filter")}catch(o){}}a(e,t,n)}function a(e,t,n){e&&(t?(e.show(),e.css("opacity","1")):(e.css("opacity","0"),e.hide())),n&&n()
}function o(e,t,n){setTimeout(function(){a(e,t,n)},0)}function i(){var e=$PageHelper.byId("identityBanner");return e&&e.length>0?e:null}function r(){var e,t=document.createElement("div"),n={"animation":"animationend","OAnimation":"oAnimationEnd","MozAnimation":"animationend","WebkitAnimation":"webkitAnimationEnd"};for(var a in n){if(void 0!==t.style[a]){return e=n[a],n[a]}}return""}function s(t,n){var a=$PageHelper.byId("inner");if(a.length>0){if(!t){return void a.removeClass("zero-opacity")}a.hasClass("zero-opacity")?(a.one(e.animationEndEventName,function(){a.removeClass("zero-opacity"),n&&n()
}),a.addClass("fade-in-lightbox")):n&&n()}}function l(){var e=!1,t=["Webkit","Moz","O"],n=document.createElement("div");if(e=void 0!==n.style.animationName,!e){for(var a=t.length,o=0;a>o;o++){if(void 0!==n.style[t[o]+"AnimationName"]){e=!0;break}}}return e}var d=window,c=d.wLive,u=d.$Config.WLXAccount;registerNamespace("wLive.Account"),c.Account.AnimationHelper=e,e.$forcejQuery=!1,e.enabled=!(u.isXbox||u.isWin10||u.isHolo||u.disableAnimations),e.isCSSAnimationSupported=l(),e.convergedAnimationEnabled=u.Animation.showConvergedAnimation&&e.isCSSAnimationSupported,e.animationEndEventName=r(),e.fadeIn=function(i,r,s){e.enabled?t(s)?c.Animations.fadeIn(i).then(function(){a(i,!0,r)
}):i.fadeIn(100,function(){n(i,!0,r)}):o(i,!0,r)},e.fadeOut=function(i,r,s){e.enabled?t(s)?c.Animations.fadeOut(i).then(function(){a(i,!1,r)}):i.fadeOut(100,function(){n(i,!1,r)}):o(i,!1,r)},e.enterContentOnNext=function(t,n,o){if(!e.convergedAnimationEnabled){return u.Animation.showConvergedAnimation&&!e.isCSSAnimationSupported&&s(!1),void e.enterContent(t,n)}var r=null,l=o.animate,d=o.show;t.css("opacity",0),l&&d&&(r=i(),r&&r.css("opacity",0)),t.addClass(d?"pagination-view has-identity-banner":"pagination-view");
var c=function(){t.one(e.animationEndEventName,function(){l&&d&&r&&(r.css("opacity",1),r.removeClass("animate slide-in-next")),a(t,!0,n),t.removeClass("animate slide-in-next")}),setTimeout(function(){l&&d&&r&&r.addClass("animate slide-in-next"),t.addClass("animate slide-in-next")},0)};s(!0,c)},e.enterContentOnBack=function(t,n,o){if(!e.convergedAnimationEnabled){return void e.enterContent(t,n)}var r=null,s=o.animate,l=o.show;t.css("opacity",0),s&&l&&(r=i(),r&&r.css("opacity",0)),t.addClass(l?"pagination-view has-identity-banner":"pagination-view"),t.one(e.animationEndEventName,function(){s&&l&&r&&(r.css("opacity",1),r.removeClass("animate slide-in-back")),a(t,!0,n),t.removeClass("animate slide-in-back")
}),setTimeout(function(){s&&l&&r&&r.addClass("animate slide-in-back"),t.addClass("animate slide-in-back")},0)},e.enterContent=function(i,r,s){if(e.enabled){if(t(s)){c.Animations.enterContent(i).then(function(){a(i,!0,r)})}else{var l="left",d=40;$B&&$B.rtl&&(l="right",d=-40);var u="",p=i.prop("style");p&&(u=p[l]),i.css(l,"+="+d+"px"),i.css("opacity","0.0");var m={"opacity":"1.0"};m[l]="-="+d+"px",i.animate(m,170,function(){i.css(l,u),n(i,!0,r)})}}else{o(i,!0,r)}},e.exitContentOnBack=function(t,n,o){if(!e.convergedAnimationEnabled){return void e.exitContent(t,n)
}var r=o.animate,s=o.show;if(t.addClass(s?"pagination-view has-identity-banner":"pagination-view"),t.one(e.animationEndEventName,function(){if(r&&s){var e=i();e&&e.removeClass("animate slide-out-back")}a(t,!1,n),t.removeClass("animate slide-out-back")}),r&&s){var l=i();l&&l.addClass("animate slide-out-back")}t.addClass("animate slide-out-back")},e.exitContentOnNext=function(t,n,o){if(!e.convergedAnimationEnabled){return void e.exitContent(t,n)}var r=o.animate,s=o.show;t.addClass(s?"pagination-view has-identity-banner":"pagination-view"),t.one(e.animationEndEventName,function(){if(r&&s){var e=i();
e&&e.removeClass("animate slide-out-next")}a(t,!1,n),t.removeClass("animate slide-out-next")});var l=function(){if(t.hasClass("animate")){return void setTimeout(l,0)}if(r&&s){var e=i();e&&e.addClass("animate slide-out-next")}t.addClass("animate slide-out-next")};setTimeout(l,0)},e.exitContent=function(i,r,s){if($B.IE&&11==$B.V&&(s=!0),e.enabled){if(t(s)){c.Animations.exitContent(i).then(function(){a(i,!1,r)})}else{var l="left",d="-=10px";$B&&$B.rtl&&(l="right",d="+=10px");var u="",p=i.prop("style");p&&(u=p[l]);
var m={"opacity":"0.0"};m[l]=d,i.animate(m,80,function(){i.css(l,u),n(i,!1,r)})}}else{o(i,!1,r)}},e.addToList=function(i,r,s){e.enabled?t(s)?(i.show(),c.Animations.addToList(i).then(function(){a(i,!0,r)})):i.slideDown(100,function(){n(i,!0,r)}):o(i,!0,r)},e.deleteFromList=function(i,r,s){e.enabled?t(s)?c.Animations.deleteFromList(i).then(function(){a(i,!1,r)}):i.slideUp(100,function(){n(i,!1,r)}):o(i,!1,r)},e.deleteFromListFast=function(i,r,s){e.enabled?t(s)?c.Animations.deleteFromListFast(i).then(function(){a(i,!1,r)
}):i.slideUp(50,function(){n(i,!1,r)}):o(i,!1,r)},e.expand=function(i,r,s){e.enabled?t(s)?(i.show(),c.Animations.expand(i).then(function(){a(i,!0,r)})):i.slideDown(100,function(){n(i,!0,r)}):o(i,!0,r)},e.collapse=function(i,r,s){e.enabled?t(s)?c.Animations.collapse(i).then(function(){a(i,!0,r)}):i.slideUp(100,function(){n(i,!0,r)}):o(i,!0,r)}}(),function(){function e(e){if(!e){return a}if("string"!=typeof e||e.length<5||":"!=e.charAt(1)){return p}var t=e.charAt(0);return m[t]?m[t]:a}var t=window,n=t.wLive,a=0,o=1,i=2,r=3,s=4,l=5,d=6,c=7,u=8,p=-1,m={"-":a,"e":o,"a":r,"h":l,"r":i,"v":s,"s":d,"i":c,"c":u};
registerNamespace("wLive.Account.TokenHelper"),n.Account.TokenHelper.getTokenType=e,n.Account.TokenHelper.Types={"none":a,"hip":l,"email":o,"reset":i,"authz":r,"recover":s,"acsrInit":c,"acsrSubmit":u,"invalid":p}}(),function(){function e(e,t){var n="&"+t.toLowerCase()+"=",a=e.toLowerCase().indexOf(n);if(-1==a&&(n="?"+t.toLowerCase()+"=",a=e.toLowerCase().indexOf(n),-1==a)){return null}var o=e.indexOf("&",a+1);return-1==o&&(o=e.length),e.substring(a+n.length,o)}function t(e,t,n){if(!e){return""}var a="&"+t.toLowerCase()+"=",o=e.toLowerCase().indexOf(a);
if(-1==o&&(a="?"+t.toLowerCase()+"=",o=e.toLowerCase().indexOf(a),-1==o)){var i="&";return-1==e.indexOf("?")&&(i="?"),e+i+t+"="+n}var r=e.indexOf("&",o+1);return-1==r&&(r=e.length),e.substring(0,o)+a+n+e.substring(r)}function n(e,t){if(!e){return""}var n=new RegExp("(\\?"+t+"=|&"+t+"=)","i"),a=e.search(n);if(-1==a){return e}var o=e.indexOf("&",a+1);return-1==o?o=e.length:(a++,o++),e.substring(0,a)+e.substring(o)}function a(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)
})}var o=window,i=o.wLive;registerNamespace("wLive.Account.UrlHelper"),i.Account.UrlHelper.SetQSValue=t,i.Account.UrlHelper.GetQSValue=e,i.Account.UrlHelper.RemoveQSValue=n,i.Account.UrlHelper.FixedEncodeURIComponent=a}(),function(){function e(){function e(){r.on("unload"+a,function(){o()})}function o(){i.$.triggerHandler(n),r.off(a),r=null,i=null}var i=this,r=$PageHelper.get(t);i.$=$PageHelper.get(i),e()}var t=window,n="dispose",a=".pageEvents";e.prototype={"next":"onNext","back":"onBack","dispose":n,"setFocus":"setFocus"},registerNamespace("wLive.Account"),wLive.Account.PageEvents=new e
}(),function(){function e(e){function n(){i++}function r(e,t,n,a){function o(){g[e]=setTimeout(function(){n(),delete g[e],a&&f[e]&&(n=f[e],delete f[e],o())},t)}return a&&g[e]?void(f[e]=n):(g[e]&&(clearTimeout(g[e]),delete g[e]),void o())}function s(e){g[e]&&(clearTimeout(g[e]),delete g[e])}var l=this,d=null,c=e,u=a.isXbox,p=!1,m=t.WIZARDUI,g={},f={};l.dispose=function(){p||(d&&(d.empty(),d=null),p=!0)},l.showLoading=function(){r("LoadingIndicatorControl$loading#"+i,500,function(){p||(u?m&&m.notReady&&m.notReady():c&&(c.show(),o&&(d||(d=$PageHelper.get(o.createLoading(0,o.loadingType.spinning,"25px","25px")),$PageHelper.byClassName("loadingSpinner",c[0]).append(d)),o.showLoading(d))))
})},l.hideLoading=function(e){s("LoadingIndicatorControl$loading#"+i),p||(u?m&&m.ready&&m.ready({"fKeyboardEnabled":e}):c&&(c.hide(),o&&d&&o.hideLoading(d)))},n()}var t=window,n=t.wLive,a=t.$Config.WLXAccount,o=t.$f,i=0;e.__class=!0,registerNamespace("wLive.Account.Controls"),n.Account.Controls.LoadingIndicatorControl=e}(),function(){function e(e,y,S){function k(){}function P(){var e=et&&et.pageTitle;e&&(document.title=e,lt&&ft&&ft.setHeaderText&&ft.setHeaderText(e))}function x(){var e=$PageHelper.byId("bannerBackButton");
if(e.length>0){var t=et&&et.showBannerBackButton;t?(e.show(),A(!0)):(e.hide(),A(!1))}}function A(e){var t=$PageHelper.byId("bannerBackButton");t.length>0&&(e?t.removeAttr("disabled"):t.attr("disabled","disabled"))}function I(){var e=et&&et.removeLeftNav;e&&($PageHelper.byClassName("LeftNav").hide(),$PageHelper.get("body").removeClass("am_fxlnav"))}function H(){var e=et.sectionId,t=et.annotations;if(e&&t){for(var n=$PageHelper.byId(e,Y),a=0,o=t.length;o>a;a++){var i=t[a][0],r=t[a][1];i&&r&&n.attr("data-"+i,r)
}}}function N(e){return at&&at[e]?rt[e]?rt[e]:("string"==typeof at[e]?(rt[e]=$PageHelper.byId(at[e],tt),l.trace("PageDialogControl.getButton ["+e+"(#"+at[e]+")] = "+rt[e].length)):rt[e]=at[e]?$PageHelper.get(at[e]):$PageHelper.get(),rt[e]):$PageHelper.get()}function $(e){A(e),e?(N("action").removeAttr("disabled"),N("alternate").removeAttr("disabled"),N("cancel").removeAttr("disabled")):(N("action").attr("disabled","disabled"),N("alternate").attr("disabled","disabled"),N("cancel").attr("disabled","disabled")),ot=e
}function E(e,t,n,a){A(e),T("action",t),T("cancel",n),T("alternate",a),ot=e||t||n||a}function T(e,t){var n=N(e);n&&(t?n.removeAttr("disabled"):n.attr("disabled","disabled"))}function M(e){var t="action",n=$PageHelper.get(e.currentTarget).attr("id");if(n==h+dt||n==h+dt+C){for(var a=$PageHelper.byClassName("default",ct),o=a.length,i=0;o>i;i++){if($PageHelper.visible(a[i])){var r=a[i].getAttribute("id");if(r==at.action){t="action";break}if(r==at.alternate){t="alternate";break}if(r==at.cancel){t="cancel";break}if(r==at.skip){t="skip";
break}}}return B(e,t)}}function B(e,t){if(l.trace("PageDialogControl.buttonClick ["+t+"] enabled:["+ot+"]"),ot){var n=N(t);if(n.length>0&&"disabled"==n.attr("disabled")){return!1}var a=!1;"action"==t&&pt&&pt.onExternalConfirm?a=pt.onExternalConfirm():"cancel"==t&&pt&&pt.onExternalClose&&(a=pt.onExternalClose()),a||Q.triggerHandler(d,{"actionName":t,"control":K,"viewModel":pt})}return e&&(e.preventDefault(),e.stopPropagation()),!1}function O(e){if(at&&at[e]){var t=N(e);t.length>0&&(l.trace("PageDialogControl.on(Click) ["+e+"]"),t.on("click"+b+dt,function(t){return B(t,e)
}))}i&&$Config.WLXAccount.isWin10InclusiveOOBE&&"cancel"===e&&(S.hasCancel?(i.showBackButton(!0),i.handleBackButton(function(){return B(null,e)})):i.showBackButton(!1))}function L(e){rt[e]&&(l.trace("PageDialogControl.clearButton ["+e+"(#"+at[e]+")]"),rt[e].off("click"+b+dt),delete rt[e])}function D(e){if(rt[e]&&rt[e].length>0&&"string"==typeof at[e]){var t=$PageHelper.byId(at[e],tt);l.assert(0!=t.length,"Html has been modified and removed the linked ["+e+"] button -- hook the onCreateContent event to alter the HTML"),l.assert(t[0]===rt[e][0],"Html has been modified and has replaced the linked ["+e+"] button -- hook the onCreateContent event to alter the HTML")
}}function F(){if(O("action"),O("alternate"),O("revert"),O("cancel"),O("skip"),o&&o.$&&(o.$.on(o.next+b+dt,function(){var e="action";if(et&&et.pageNextAction&&(e=et.pageNextAction),pt&&pt.wizardUIOnNext){return void pt.wizardUIOnNext()}var t=N(e);if(t.length>0){if("disabled"==t.attr("disabled")){return}B(null,e)}else{et&&et.pageNextAction&&B(null,e)}}),o.$.on(o.back+b+dt,function(){var e="cancel";if(et&&et.pageBackAction&&(e=et.pageBackAction),pt&&pt.wizardUIOnBack){return void pt.wizardUIOnBack()}var t=N(e);
if(t.length>0){if("disabled"===t.attr("disabled")){return}B(null,e)}else{et&&et.pageBackAction&&B(null,e)}})),n.Account.DialogManager){var e=n.Account.DialogManager;e.$.on("action"+b+dt,function(){var e=et.pageNextAction||"action";B(null,e)}),e.$.on("cancel"+b+dt,function(){var e=!1;pt&&pt.onExternalClose&&(e=pt.onExternalClose()),e||K.dispose()})}ct&&ct.on("submit"+b+dt,M),ut&&ut.on("click"+b+dt,M);var t=et.viewModel,i=n.Account.ViewModels;if(i&&t&&mt){var r,s={"trigger":function(e){Q.triggerHandler(d,{"actionName":e,"control":K,"viewModel":pt})
}};r="function"==typeof t?t:i[t],pt=new r(nt,et.viewModelOptions,s),n.Account.viewModelHandle=pt,a.applyBindingsWithValidation(pt,$PageHelper.byId(mt,Y)[0],{"insertMessages":!1,"messagesOnModified":!0})}Q.triggerHandler(p,{"content":tt,"control":K,"viewModel":pt})}function _(){o&&o.$&&o.$.off(b+dt),n.Account.DialogManager&&n.Account.DialogManager.$.off(b+dt),Q.triggerHandler(m,{"content":tt,"control":K}),L("action"),L("alternate"),L("revert"),L("cancel"),L("skip"),ct&&ct.off("submit"+b+dt),ut&&ut.off("click"+b+dt)
}function U(){if(D("action"),D("alternate"),D("revert"),D("cancel"),D("skip"),ct&&ct.length>0){var e=tt;tt!==ct&&(e=$PageHelper.byId(h+dt,tt)),l.assert(0!=e.length,"AutoForm has been removed -- hook the onCreateContent event to alter the HTML"),l.assert(ct[0]===e[0],"AutoForm has been modified and has replaced -- hook the onCreateContent event to alter the HTML")}if(ut&&ut.length>0){var t=$PageHelper.queryAll("input[type=submit]",tt);l.assert(0!=t.length,"AutoFormSubmit button has been removed -- hook the onCreateContent event to alter the HTML"),l.assert(ut[0]===t[0],"AutoFormSubmit button has been modified and has replaced -- hook the onCreateContent event to alter the HTML")
}}function V(e,t){for(var n=t.split("."),a=n.length,o=0;a>o&&null!==e&&void 0!==e;){e=e[n[o++]]}return e}function R(e,t,n){return e.indexOf(t)>-1&&(e=e.replace(t,n)),e}function W(e){return et.getViewContextTokenValue?et.getViewContextTokenValue(nt,e):V(nt,e)}function q(e){if(!it){return!1}var t=$PageHelper.byTagName("form",e);if(t.length>0){return!1}var n=$PageHelper.byTagName("input",e);return 0==n.length?!1:!0}function z(e){if(q(e)){ct=$PageHelper.createShim("form"),ct[0].setAttribute("id",h+dt),ct[0].setAttribute("action","#"),ct[0].onsubmit="return false;",ct[0].setAttribute("novalidate","novalidate");
var t=G();for(label in t){t.hasOwnProperty(label)&&ct[0].setAttribute(label,t[label])}if(ct.append(e),0===$PageHelper.queryAll("input[type=submit]",e[0]).length){var n=$PageHelper.createShim("input");n[0].setAttribute("aria-hidden","true"),n[0].setAttribute("id",h+dt+C),n[0].setAttribute("type","submit"),n[0].setAttribute("tabindex","-1"),n[0].setAttribute("style","position: absolute; height: 0px; width: 0px; border: none; padding: 0px; min-width: 0px; min-height: 0px;"),ct.append(n)}return ut=$PageHelper.queryAll("input[type=submit]",e),ct
}return e}function G(){return r.supportsUnifiedHeader?et&&et.pageTitle?{"aria-label":et.pageTitle}:{"aria-labelledby":"iPageTitle DialogUserTitle"}:{}}function j(){var e=$PageHelper.get(et.viewTemplate).clone(),t=et.viewContextTokens;if(t&&t.length>0){for(var n=e.html(),a=0;a<t.length;a++){var o=t[a],r=W(o);void 0!==r&&null!==r&&(n=R(n,"{"+o+"}",$PageHelper.createShim("span").text(r).html()))}e.html(n)}return i&&($Config.WLXAccount.isWin10||$Config.WLXAccount.isHolo)&&i.getContext(function(t){var n=t.host?t.host.toUpperCase():"",a=n===i.Hosts.OOBE||n===i.Hosts.NthUserFirstLogon||n===i.Hosts.SSCRPINReset;
$PageHelper.byClassName("icon-win-easeOfAccess",e).toggle(a)}),Q.triggerHandler(g,{"content":e,"control":K}),z(e)}function X(){et.focusErrorElemId?setTimeout(function(){$PageHelper.byId(et.focusErrorElemId,tt).first().focus(),et.focusErrorElemId=null},10):et.focusFirstButton?setTimeout(function(){$PageHelper.queryAll("button, input[type=button]",tt).first().focus()},10):et.focusFirstInput?setTimeout(function(){var e=$PageHelper.queryAll("input,select",tt).not(":hidden").first();0==e.length&&(e=$PageHelper.queryAll("a,button,input[type=button]",tt).not(":hidden").first()),e&&e.focus()
},gt?255:10):et.focusSubmit?setTimeout(function(){tt.find("input[type=submit]").not(":hidden").first().focus()},10):et.focusFirstElemId?setTimeout(function(){$PageHelper.byId(et.focusElemId,tt).first().focus()},10):et.disableAutoFocus||setTimeout(function(){for(var e=0,t=w.length;t>e;e++){var n=$PageHelper.queryAll(w[e],tt).not(":hidden");if(n.length>0){n.first().focus();break}}},gt?255:10)}var K=this,Q=K.$=$PageHelper.get(K),J=!1,Z=!1,Y=e,et=S,tt=null,nt=y,at=S.buttons,ot=!0,it=S.autoForm!==!1&&0!==S.autoForm&&"False"!==S.autoForm,rt={},st=r.isWinWab,lt=r.isWinWiz,dt=(r.isXbox,r.isWPBlue,v++),ct=null,ut=null,pt=null,mt=S.sectionId,gt=s.convergedAnimationEnabled,ft=t.WIZARDUI;
K.notifyVisible=function(){pt&&pt.onNotifyVisible&&pt.onNotifyVisible()},K.content=function(){return tt},K.show=function(){l.trace("PageDialogControl.show()"),tt||(tt=j()),Z||(Y.append(tt),Z=!0),H(),P(),x(),F(),tt.show(),st&&($PageHelper.byTagName("form").parents("div").css("height","100%"),"undefined"!=typeof setContentWidth&&setContentWidth()),Q.triggerHandler(c,{"content":tt,"control":K}),X(),I(),U(),l.trace("PageDialogControl.~show()")},K.hide=function(){l.trace("PageDialogControl.hide()"),tt.hide(),Q.triggerHandler(u,{"content":tt,"control":K}),_(),tt.detach(),Z=!1
},K.setEnabled=function(e){l.trace("PageDialogControl.setEnabled("+e+")"),$(e)},K.setEnabledStateForEachButton=function(e,t,n,a){l.trace("PageDialogControl.setEnableStateForEachButton("+e+", "+t+", "+n+", "+a+")"),E(e,t,n,a)},K.getButton=N,K.dispose=function(){l.trace("PageDialogControl.dispose()"),J||(Q.triggerHandler(f,{"control":K}),_(),tt.empty(),Z&&tt.remove(),tt=null,J=!0,K.$=null),K=null,Q=null,at=null,rt=null,Y=null,et=null,y=null,S=null},k()}var t=window,n=t.wLive,a=t.ko,o=n.Account.PageEvents,i=t.MSA&&t.MSA.CXH,r=t.$Config.WLXAccount,s=n.Account.AnimationHelper,l=t.$Debug,d="onAction",c="onShow",u="onHide",p="onSetupEvents",m="onRemoveEvents",g="onCreateContent",f="onDispose",v=0,b=".pagedialog",h="pageDialogForm_",C="_submit",w=["[autofocus]","[autofocus=autofocus]","[autofocus=true]","input","button","a","select","textarea"];
e.prototype.events={"action":d,"createContent":g,"show":c,"hide":u,"setupEvents":p,"removeEvents":m,"dispose":f},e.__class=!0,registerNamespace("wLive.Account.Controls"),n.Account.Controls.PageDialogControl=e}(),function(){function e(e,k,P){function x(){}function A(e){var t,n=Q[e];return t=n.template?$PageHelper.get(n.template):P.defaultTemplate?$PageHelper.get(P.defaultTemplate):$PageHelper.createShim("div"),t.hide(),t}function I(e,t){var n,a=Q[t];return new(n="function"==typeof a.control?a.control:o[a.control])(e,K,a.options)
}function H(e,t){r.trace("FlowController.notifyVisible ["+t+"]"),!R&&e&&e[b]&&e[b](),$(e,!0),V.triggerHandler(l,{"controller":U,"control":e,"state":t,"viewContext":K})}function N(e,t,n,a){if(a[v]&&!a[v](e)){return null}if("function"==typeof n){return n()}if(Z[h]){var o=Z[h](t,n,K,e);if(o){if($PageHelper.isArray(n)){for(var i=0;i<n.length;i++){if(n[i]===o){return o}}}else{if(o===n){return o}}}return null}return n}function $(e,t){e&&e[f]&&e[f](t)}function E(e,o,i,s,l,d,c){if(!R&&z===e){W.append(e),j=$PageHelper.get(o),r.trace("Hooking control events for ["+i+"]");
var u=o.events;for(var p in u){var g=u[p];j.on(g,{"eventName":g,"state":i,"control":o},F)}j.on(o.events.action,{"state":i,"control":o},_),X=e,e.show(),o.show();var f=function(){if(e.show(),G===o&&H(o,i),s.pageId){var a=s.netId?s.netId:null,r={"pageId":s.pageId,"userAction":s.userAction,"netId":a};$ReportEvent.SetCustomPageLoadCompletedTime((new Date).getTime()),$ReportEvent.PageLoadCompleted(),$ReportEvent.Fire(r),t.$Config.hpgid=s.pageId,$Config.WLXAccount.signup&&$Config.WLXAccount.signup.page&&$Config.WLXAccount.signup.page.isDfpEnabled&&!S&&(n.Account.Page.AttachDfpIframe(),S=!0)
}};if(l){var v=s.options&&1===s.options.showIdentityBanner,b={"animate":c,"show":v};d?a.enterContentOnBack(e,f,b):a.enterContentOnNext(e,f,b)}else{f()}V.triggerHandler(m,{"controller":U,"activeState":i,"control":o,"container":e,"viewContext":K})}}function T(){Y=[]}function M(e,t){if(!e.skipBackStack){if(Y.length>0&&Y[0]!=t){for(var n=0;n<Y.length;n++){if(Y[n]==t){Y=Y.slice(0,n);break}}}Y.push(t)}}function B(e){if(Y.length>0){for(var t=Y.length-1;t>=0;t--){if(Y[t]==e){Y=Y.slice(0,t);break}}}}function O(e,t){if(Y.length>0){r.trace("FlowController.getBackState("+e+", "+t+") -- "+Y);
for(var n=Y.length-1;n>=0;n--){var a=Y[n];if(a!=e&&a){if($PageHelper.isArray(t)){for(var o=0;o<t.length;o++){if(t[o]==a){return a}}}else{if(a==t){return a}}}}}return null}function L(e,n,o){if(!R){if(r.trace("FlowController.showControl("+e+")"),q!=e&&Q[e]){r.trace("New State ["+e+"] from ["+q+"]"),V.triggerHandler(p,{"control":U,"activeState":q,"newState":e,"viewContext":K});var l=Q[e],c=l.url,m=l.target,g=l.cancelUrl,f=l.triggerAction,v=t.$Telemetry;if(v){if(q&&q!==s&&Q[q]&&Q[q].pageId){var b=Q[q];v.set(C,b.pageId&&b.pageId.toString(),!0),(c||l.pageId&&l.pageId!=b.pageId)&&(c?v.set(y,c):v.set(w,l.pageId&&l.pageId.toString(),!0),v.post(!0))
}else{l.pageId&&v.set(C,l.pageId&&l.pageId.toString(),!0)}}if(c){return r.trace("Navigate to ["+c+"]"),V.triggerHandler(u,{"control":U,"url":c,"viewContext":K}),void(g?((et||tt)&&i?i.openExternalWebBrowser(c):m&&$Utility.navigateTo(c,m),$Utility.navigateTo(g)):$Utility.navigateTo(c))}if(f){return r.trace("Trigger action ["+f+"]"),void V.triggerHandler(d,{"actionName":f,"control":U})}var h=z,S=G,k=j,P=q,x=A(e),H=I(x,e);if(z=x,G=H,j=null,k&&(r.trace("Clearing action event for ["+P+"]"),k.off(S.events.action,_)),S&&S.prepareDispose&&S.prepareDispose(),q=e,l.clearBackStack&&T(),M(l,q),Q.netId&&(l.netId=Q.netId),h&&X===h){var N=Q[P].options.showIdentityBanner!==l.options.showIdentityBanner,B=function(){if(h.hide(),S){S.hide&&S.hide(),r.trace("Clearing control hooked events ["+P+"]");
var t=$PageHelper.get(S);for(var n in H.events){t.off(n,F)}t=null,S.dispose(),delete S}h.empty(),h.remove(),h=null,delete h,E(x,H,e,l,!0,o,N)},O=Q[P].options&&1===Q[P].options.showIdentityBanner,L={"animate":N,"show":O};o?a.exitContentOnBack(h,B,L):a.exitContentOnNext(h,B,L)}else{var D=!0;n&&J.animateInitial===!1&&(D=!1),E(x,H,e,l,D,o,n)}v&&v.applyClientEventBindings(x[0])}else{r.assert(Q[e],"Undefined state ["+e+"] -- re-enabling existing control"),q==e&&r.trace("Same state re-enabling the control ["+e+"]"),$(G,!0)
}}}function D(e,t){return{"controller":U,"state":e.state,"control":e.control,"controlData":t,"viewContext":K}}function F(e,t){var n=e.data;r.trace("FlowController.handleControlEvent ["+n.eventName+"] for ["+n.state+"]");var a=D(n,t);return V.triggerHandler(n.eventName+"$Control",a),!0}function _(e,t){var n=t.actionName,a=t.control,o=e.data,i=o.state,s=Q[i].actions,l=s[n],d=!1;if(("cancel"==n||"backStack"==n)&&(d=!0),r.trace("FlowController.processActionEvent["+n+"] for ["+i+"]"),r.assert(i==q,"processAction state mismatch ev:["+i+"] act:["+q+"]"),i==q){var c=!1;
if("backStack"==n){var u=O(i,l);u&&(l=u,c=!0)}l=N(n,i,l,a);var p=l;if(l&&$PageHelper.isArray(l)&&(p=l[0]),r.trace("FlowController.processActionEvent newState ["+p+"]"),p){if(Q[p]){return c&&B(p),$(a,!1),L(p,!1,d),!0}r.fail("Invalid State ["+p+"] from ["+i+"] action ["+n+"]")}}return L(q,!1,d),!1}var U=this,V=U.$=$PageHelper.get(U),R=!1,W=$PageHelper.get(e),q=s,z=null,G=null,j=null,X=null,K=k,Q=P.viewDefs,J=P,Z=P.callbacks||{},Y=[],et=t.$Config.WLXAccount.isWin10,tt=t.$Config.WLXAccount.isHolo;U.show=function(e){L(e,!0),V.triggerHandler(c,{"control":U,"viewContext":K})
},U.setStateChangeFunc=function(e){Z[h]=e},U.dispose=function(){if(!R){if(q=s,G){if(null!=j){r.trace("Clearing control events ["+q+"]"),j.off(G.events.action,_);for(var e in G.events){j.off(e,F)}j=null}G.dispose()}G=null,z&&z.empty(),z=null,V.triggerHandler(g,{"control":U,"viewContext":K}),R=!0,U.$=null}V=null,U=null,R=!0,W&&W.empty(),W=null,K=null,Q=null,J=null},x()}var t=window,n=t.wLive,a=n.Account.AnimationHelper,o=n.Account.Controls,i=t.MSA&&t.MSA.CXH,r=t.$Debug,s="none",l="onControlVisible",d="onAction",c="onShow",u="onNavigate",p="onStateChanging",m="onStateChanged",g="onDispose",f="setEnabled",v="validate",b="notifyVisible",h="validateStateChange",C="ViewID",w="NextViewID",y="OutboundTargetUrl",S=!1;
e.prototype.events={"action":d,"show":c,"stateChanged":m,"stateChanging":p,"controlVisible":l,"dispose":g},e.__class=!0,registerNamespace("wLive.Account.Controls"),n.Account.Controls.FlowController=e}(),function(){function e(e,t,n){function a(){}var o=this,i=n,r=t,s=r.data,l=i.params;o.show=function(){for(var t=$PageHelper.get(i.viewTemplate).clone(),n=i.formId,a=$PageHelper.byId(n,t),o=0,r=l.length;r>o;o++){var d=l[o];$PageHelper.byId(d,a).val(s[d])}e.append(t),document.forms[n].submit()},a()}var t=window,n=t.wLive,a="onShow";
e.prototype.events={"show":a},e.__class=!0,registerNamespace("wLive.Account.Controls"),n.Account.Controls.RedirectionControl=e}(),function(){function e(e,n,a){function s(){}function y(e){if(e&&w[e]){return GetString("live.accounts.strings."+w[e])}var t=GetString(b+e);return t||(t=GetString("live.accounts.strings."+e)),t||(t=GetString("live.accounts.strings."+h)),t}function S(){return{"control":$,"viewContext":B,"pollAttempts":j,"numErrors":G}}function k(e){if(!T){K&&(clearTimeout(K),K=null);var t=(new Date).getTime();
if(G>=O||t>X){z&&z.hideLoading(),E.triggerHandler(u,S())}else{if(e){var n=S();n.sendPollingRequest=!0,E.triggerHandler(l,n),n.sendPollingRequest&&(K=setTimeout(A,F))}else{D?K=setTimeout(A,F):(z&&z.hideLoading(),E.triggerHandler(c,S()))}}}}function P(){if(!T){var e=0,t=0;null!=J&&(e=J.height(),t=J.width()),2==e?(z&&z.hideLoading(),1==t?E.triggerHandler(p,S()):E.triggerHandler(m,S())):(1!=t&&G++,k(!1)),null!=J&&(J.empty(),J.remove(),J=null)}}function x(){T||(G++,k(!1),null!=J&&(J.empty(),J.remove(),J=null))}function A(){if(!T){K=null;
var e=(new Date).getTime();null!=J&&(J.empty(),J=null),J=$PageHelper.createShim("img").attr({"id":"iSessionPollingImg","style":"display: none"}),J.load(P),J.error(x);var t="?slk";_.indexOf("?")>-1&&(t="&slk="),J.attr("src",_+t+encodeURIComponent(Q)+"&pa="+encodeURIComponent(e)+(q?"&slkt=RNGCVer":"")),$PageHelper.queryAll("body").append(J),j++,E.triggerHandler(d,S())}}function I(e){T||(Q=e.sessionLookupKey,B&&(B.sessionLookupKey=Q),E.triggerHandler(g,S()),k(!0))}function H(e){if(!T){if(Q=null,B&&delete B.sessionLookupKey,e.error&&e.error.code==C){return void E.triggerHandler(p,S())
}B.pollingError=errorMessage=y(String(e.error.code)),E.triggerHandler(f,S()),V&&k(!0)}}function N(){if(!T){var n=(new Date).getTime();if(X=n+L,G=0,j=0,R){var a=$PageHelper.byClassName("loadingArea",e);0==a.length&&(a=$PageHelper.byClassName("waitingArea",e)),z=new r.LoadingIndicatorControl(a),z.showLoading()}if(W){var o={"channel":"PushNotifications","purpose":U};t.$DataRequest.Json(null,i.sendOtt,o,I,H,1e4)}else{k(!0)}}}var $=this,E=$.$=$PageHelper.get($),T=!1,M=a,B=n||{},O=M.maxErrors||o.polling.maxErrors,L=M.timeout||o.polling.timeout,D=void 0!==o.polling.enabled?o.polling.enabled:!0,F=D?M.pollInterval||o.polling.interval:0,_=M.approvalUrl||o.url,U=M.ottPurpose||o.ottPurpose,V=void 0!==M.pollOnSendError?M.pollOnSendError:!0,R=void 0!==M.showLoading?M.showLoading:!0,W=void 0!==M.sendNotification?M.sendNotification:!0,q=M.isRngc,z=null,G=0,j=0,X=null,K=null,Q=o.lookupKey,J=null;
$.forcePollRequest=function(){k(!0)},$.show=function(){N()},$.dispose=function(){if(!T){if(E.triggerHandler(v,S()),K&&(clearTimeout(K),K=null),z&&z.dispose(),z=null,null!=J&&(J.empty(),J.remove(),J=null),$&&$.$){for(var e in $.events){$.$.off(e)}E=$.$=null}$=null,M=null,B=null,O=null,L=null,D=null,F=null,_=null,U=null,V=!1,R=!1,X=null,Q=null,T=!0}},s()}var t=window,n=t.wLive,a=(n.Core,t.$Config.WLXAccount),o=a.sessionApproval,i=a.urls.dataRequest,r=n.Account.Controls,s="onShow",l="onStartPolling",d="onPolling",c="onPending",u="onTimeout",p="onApproved",m="onDenied",g="onSendSuccess",f="onSendError",v="onDisposing",b="live.accounts.strings.error_",h="pollingdefaulterror",C="1306",w={"errorFieldRequired":"error_1018","errorEmailInvalidFormat":"error_1035","errorEmailExists":"error_1287"};
e.prototype.events={"show":s,"startPolling":l,"polling":d,"pending":c,"timeout":u,"approved":p,"denied":m,"sendSuccess":g,"sendError":f,"disposing":v},e.__class=!0,registerNamespace("wLive.Account.Controls"),n.Account.Controls.SessionPolling=e}(),function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t){var n="";o.getComputedStyle(document.body)&&o.getComputedStyle(document.body).backgroundColor&&(n=o.getComputedStyle(document.body).backgroundColor.toLowerCase().replace(new RegExp(" ","g"),""));
var a="rgb(0,0,0)"===n||"#000000"===n||"#000"===n,i="rgb(255,255,255)"===n||"#ffffff"===n||"#fff"===n,r="rgb(32,32,32)"===n||"#202020"===n,s="rgb(45,50,54)"===n||"#2d3236"===n,d="rgb(255,250,239)"===n||"#fffaef"===n;return t.forBlackBackground&&(a||l&&(r||s))?t.forBlackBackground:t.forWhiteBackground&&(i||l&&d)?t.forWhiteBackground:e}function n(e,t){return e?t&&t.length>6&&("data:"===t.substr(0,5).toLowerCase()||"http:"===t.substr(0,5).toLowerCase()||"https:"===t.substr(0,6).toLowerCase())?t:e+t:t}function a(e,a,o){return n(e,t(a,o))
}var o=window,i=$Config.WLXAccount,r=i.convergedFrameConfig||i.signup,s=r&&r.page,l=s&&s.fDetectMultiHighContrastThemes;e.getHighContrastImage=t,e.getImagePath=n,e.getHighContrastImageUrl=a}(t=e.HighContrast||(e.HighContrast={}))}(t=e.Util||(e.Util={}))}(t=e.Account||(e.Account={}))}(wLive||(wLive={})),function(e){var t;!function(e){var t;!function(t){var n;!function(t){function n(){return r&&c?r.getHighContrastImageUrl(c.baseUrl,c.dropdownCaret,{"forBlackBackground":c.dropdownCaretWhite}):""}function a(){return r&&c?r.getHighContrastImageUrl(c.baseUrl,c.arrow,{"forBlackBackground":c.arrowWhite}):""
}function o(){return r&&c?r.getHighContrastImageUrl(c.baseUrl,c.msLogo,{"forBlackBackground":c.msLogoWhite}):""}function i(e){e?$PageHelper.byId("lightbox-cover").addClass("disable-lightbox"):$PageHelper.byId("lightbox-cover").removeClass("disable-lightbox")}var r=e.Util.HighContrast,s=$Config.WLXAccount,l=s.convergedFrameConfig||s.signup,d=l&&l.page,c=d&&d.imgs;t.getDropDownCaretImage=n,t.getArrowImage=a,t.getMsLogoImage=o,t.disableLightbox=i}(n=t.ConvergedUxUtil||(t.ConvergedUxUtil={}))}(t=e.Util||(e.Util={}))
}(t=e.Account||(e.Account={}))}(wLive||(wLive={})),function(e){var t;!function(e){var t;!function(t){var n;!function(t){function n(){return u&&f?u.getHighContrastImageUrl(f.baseUrl,f.marchingAnts,{"forBlackBackground":f.marchingAntsWhite}):""}function a(e,t){if(e.length>0){if(e.show(),$PageHelper.queryAll("[data-id='marchingAnts']",e).length>0){return}var a;switch(y=y.replace("{0}",n()),t){case l.Lightbox:a=v?w:y;break;case l.Content:a='<div class="row progress-container">'+(v?w:y)+"</div>"}e.append(b?S:a)}}function o(){var e=$PageHelper.byId("progressBarLightbox");
a(e,l.Lightbox)}function i(){$PageHelper.byId("progressBarLightbox").hide()}function r(){var e=$PageHelper.byId("progressBarContent");a(e,l.Content)}function s(){$PageHelper.byId("progressBarContent").hide()}var l,d=window,c=e.AnimationHelper,u=e.Util.HighContrast,p=$Config.WLXAccount,m=p.convergedFrameConfig||p.signup,g=m&&m.page,f=g&&g.imgs,v=c&&c.isCSSAnimationSupported,b=p.isWin10HostOOBEDesktop,h='<div class="row progress-container">        <div role="progressbar" class="progress-indicator">            <!-- ko if: isCSSAnimationSupported -->            <div></div>            <!-- /ko -->            <!-- ko ifnot: isCSSAnimationSupported -->            <img role="presentation" data-bind="attr: { src: marchingAntsImage }" />            <!-- /ko -->        </div>    </div>',C='<div class="row progress-container">        <div class="progress">            <div class="subline inc"></div>            <div class="subline dec"></div>        </div>    </div>',w='<div data-id="marchingAnts" role="progressbar" class="progress-indicator" >            <div></div>        </div>',y='<div data-id="marchingAnts" role="progressbar" class="progress">            <img role= "presentation" src="{0}"/>        </div>',S='<div data-id="marchingAnts" role="progressbar" class="progress">            <div class="subline inc"></div>            <div class="subline dec"></div>        </div>';
!function(e){e[e.Lightbox=0]="Lightbox",e[e.Content=1]="Content"}(l||(l={}));var k=function(){function e(){var e=this;e.isCSSAnimationSupported=v||!1,e.marchingAntsImage="",e.isCSSAnimationSupported||(e.marchingAntsImage=n())}return e}();ko&&ko.components&&ko.components.register("marchingAnts",{"viewModel":k,"template":b?C:h}),t.getMarchingAntsImage=n,t.showLightboxProgress=o,t.hideLightboxProgress=i,t.showContentProgress=r,t.hideContentProgress=s,d.$Do&&d.$Do.register("wLive.Account.Util.MarchingAnts",0,!0)
}(n=t.MarchingAnts||(t.MarchingAnts={}))}(t=e.Util||(e.Util={}))}(t=e.Account||(e.Account={}))}(wLive||(wLive={})),function(){function e(e,t){if(e){if("undefined"!=typeof t&&t[e]){return GetString("live.accounts.strings."+t[e])}if(M[e]){return GetString("live.accounts.strings."+M[e])}}var n=GetString("live.accounts.strings.error_"+e);return n||(n=GetString("live.accounts.strings."+e)),n||(n=GetString("live.accounts.strings."+H)),n}function t(e){return"string"==typeof e}function n(e,n,a){return t(e)&&t(n)?a?e.toLowerCase()===n.toLowerCase():e===n:!1
}function a(e,t){if(e=(e||"").trim(),t&&""===e){return N}if(e.length>113){return E}var n=new RegExp(S.AltEmailRegEx);return e.match(n)?null:E}function o(e,t){var n=e>=97&&122>=e,a=e>=65&&90>=e;return n&&t||a&&!t}function i(e,t,n){return e=(e||"").trim(),t&&""===e?N:e.length>(n?n:10)?$:null}function r(e,t){return e=(e||"").trim(),t&&""===e?N:e.length>30||e.length<1?$:null}function s(e,t){t&&(e?t.css("opacity",1):t.css("opacity",0))}function l(e,t){if(e){if(e.indexOf("@")>=0){var n=e.split("@");if(2===n.length){for(var a=n[1].toLowerCase(),o=0,i=t.length;i>o;o++){if(t[o].toLowerCase()===a){return T.Live
}}return T.EASI}return T.Unknown}return T.Phone}return T.Unknown}function d(e,t){var n=!1;if(e&&t&&e.indexOf("@")>=0){var a=e.split("@");if(2===a.length){var o=a[1].toLowerCase();t.toLowerCase()===o&&(n=!0)}}return n}function c(e){if(e){var t=document.createElement("a");t.href=e;var n=t.origin;return n||(n=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),n}return""}function u(e,t){var n=c(e),a=c(t);return a===n}function p(e,t){if(e){var n=new RegExp(S.PhoneNumberFormat);if(!e.match(n)){return $}}else{if(t){return N
}}return null}function m(e){if(e&&u(P.url,e.origin)){try{var t=JSON.parse(e.data);switch(t.eventId){case"challenge-loaded":A&&A.hideContentProgress(),I&&I.hide(!1),$PageHelper.byClassName("forVisualHip").removeClass("hide"),g(t.payload),P.sessionToken=null,clearTimeout(L),$ReportEvent.Action({"pageId":O,"userAction":["Action_LoadEnforcement","Action_ClientSideTelemetry"],"enforcementSessionToken":t.payload.sessionToken});break;case"challenge-complete":P.sessionToken=t.payload.sessionToken,h.removeEventListener("message",m),$ReportEvent.Action({"pageId":O,"userAction":["Action_CompleteEnforcement","Action_ClientSideTelemetry"],"enforcementSessionToken":t.payload.sessionToken}),OnNext();
break;case"challenge-iframeSize":g(t.payload);break;case"back_key_pressed":OnBack()}}catch(n){}}}function g(e){var t=$PageHelper.byId("enforcementFrame");e&&t.length>0&&(t.css("height",e.frameHeight+"px"),t.css("width",e.frameWidth+"px"))}function f(){if(w.viewModelHandle._observables.indexOf("hipEnforcement")>=0){throw"Enforcement load error"}}function v(e){if(y=h.wLive.Account.Util,I=y&&y.FullScreenSpinner,P&&P.url){var t=$PageHelper.byId("hipEnforcementContainer");O=e,A&&A.showContentProgress(),I&&I.show();
var n=document.createElement("iframe");n.id="enforcementFrame",n.src=P.url,n.sandbox="allow-scripts allow-forms allow-same-origin allow-popups",n.className="enforcementFrame",n.title=P.strings.title,h.addEventListener("message",m),t.empty(),t.append(n),L=setTimeout(f,P.timeout)}}function b(){if(k&&k.url&&("undefined"==typeof h.HIPAMFE?HIPAMFE={"holder":"hipContent","scriptHolder":"hipScript","done":!1,"showMenu":!0,"showAddAccountOption":!1,"inputWidth":$B.IE&&$B.major<9?200:"100%","cssSet":{"cssCdHIPInput":"form-control input-max-width","cssCdHIPList":"form-control","cssCdHIPError":"alert alert-error","cssCdHIPErrorImg":"hide","cssCdHIPButton":"btn btn-default","cssCdHIPLabel":"text-base"},"createObservable":function(){var e=h.HIPAMFE;
return e.observable={},$PageHelper.extend(e.observable,w.viewModelHandle),e.observable.hip.suppressMessages(!0),e.observable.hip(""),e.observable},"updateTitle":function(){var e=h.HIPAMFE,t=$PageHelper.byId("HipPane");e.type&&("sms"===e.type?($PageHelper.byClassName("forVisualHip",t).addClass("hide"),$PageHelper.byClassName("forSmsHip",t).removeClass("hide")):($PageHelper.byClassName("forVisualHip",t).removeClass("hide"),$PageHelper.byClassName("forSmsHip",t).addClass("hide")))},"postLoad":function(){function e(e){return $PageHelper.byTagName("label",e).addClass("text-base text-body"),S.isWin10?($PageHelper.byTagName("select",e).addClass("win-dropdown").parent().addClass("template-input inputType_large"),$PageHelper.queryAll("input[type=text]",e).addClass("win-textbox").parent().addClass("template-input inputType_large")):S.isWin10InclusiveOOBE?($PageHelper.byTagName("select",e).removeClass().addClass("win-dropdown").parent().addClass("template-input"),$PageHelper.queryAll("input[type=text]",e).removeClass().addClass("win-textbox").parent().addClass("template-input")):S.isWin10HostOOBEDesktop?($PageHelper.byTagName("select",e).removeClass().addClass("win-dropdown form-control").parent().addClass("template-input"),$PageHelper.queryAll("input[type=text]",e).removeClass().addClass("win-textbox form-control").parent().addClass("template-input")):($PageHelper.byTagName("select",e).addClass("input-max-width").parent().addClass(t).removeAttr("style"),$PageHelper.queryAll("input[type=text]",e).removeClass("hiddenHipInputText").addClass("input-max-width").parent().addClass(t).removeAttr("style")),e[0]&&"wlspispHipControlButtonsContainer"===e[0].id&&($PageHelper.byTagName("body").hasClass("cb")?$PageHelper.byTagName("a",e).addClass("btn btn-block").parent().addClass(t).removeAttr("style"):S.isWin10HostOOBEDesktop?$PageHelper.byTagName("a",e).addClass("btn win-button btn-primary btn-block full-width").parent().addClass(t).removeAttr("style"):$PageHelper.byTagName("a",e).addClass("btn btn-primary btn-block").parent().addClass(t).removeAttr("style")),e
}var t="form-group col-xs-24 template-input",n="col-xs-12",a=!1;$PageHelper.byClassName("col-md-24").length>0?(t="form-group col-md-24 template-input",n="col-md-12",a=!1):$PageHelper.byClassName("col-xs-18").length>0&&(t="form-group col-xs-18 template-input",n="col-xs-9",a=!0);var o=h.HIPAMFE,i=$PageHelper.byId("hipDesc"),r=$PageHelper.byId("hipTemplateContainer"),s=($PageHelper.byId("HipPane"),$PageHelper.byId(o.holder));if(i.length>0&&i.addClass("text-body"),("undefined"===x||0===x)&&r.addClass("text-body"),A&&A.hideContentProgress(),o.updateTitle(),ko.cleanNode(r[0]),"sms"===o.type){for(var l,d=$PageHelper.queryAll("#pageControlHost input[type=submit]"),c=0;c<d.length;c++){$PageHelper.visible(d[c])&&(l=d[c])
}d=$PageHelper.get(l),w.ftrViewModelHandle?w.ftrViewModelHandle.buttons.nextButton.disabled(!0):d.length>0&&d.attr("disabled","disabled"),a&&$PageHelper.queryAll("#hipSection div.col-xs-18").addClass("alert alert-error");var u=e($PageHelper.byId("wlspispHIPErrorContainer",s).removeAttr("style").addClass(t)).detach().attr("data-bind","visible: !hip.suppressMessages() && !hip.isValid()"),p=e($PageHelper.byId("wlspispHipChallengeContainer",s).removeAttr("style")).detach(),m=e($PageHelper.byId("wlspispHipControlButtonsContainer",s).removeAttr("style")).detach().on("click",function(){o&&o.observable&&o.observable.hip.suppressMessages(!0)
}),g=e($PageHelper.byId("wlspispHipSolutionContainer",s)).hide().detach();$PageHelper.byClassName("form-control",g).attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }"),r.html("").append(p).append(m).append(g).append(u),o.createObservable(),o.observable.hip.suppressMessages(!0),ko.applyBindings(o.observable,r[0]);try{var f=w.viewModelHandle;f.phoneNumber&&f.phoneCountry&&o.setPhoneNumber(f.phoneCountry(),f.phoneNumber())}catch(v){}var b=o.getHipDataResponse;
o.getHipDataResponse=function(e){b(e),e||(w.ftrViewModelHandle?w.ftrViewModelHandle.buttons.nextButton.disabled(!1):d.length>0&&d.removeAttr("disabled"))},$PageHelper.queryAll('[id^="wlspispHIPPhoneInput"]',p).first().focus()}else{if(S.isXbox){$PageHelper.byId("iHipRefresh").off("click").on("click",function(){o.reloadHIP()}),$PageHelper.byId("iHipAudioLink").off("click").on("click",function(){$PageHelper.byId("hipimageholder").hide(),$PageHelper.byId("hipaudioholder").show(),o.type="audio",o.reloadHIP()}),$PageHelper.byId("iHipImageLink").off("click").on("click",function(){$PageHelper.byId("hipaudioholder").hide(),$PageHelper.byId("hipimageholder").show(),o.type="visual",o.reloadHIP()
});var p=$PageHelper.createShim("div");if(o.type===B){p.append($PageHelper.byClassName("cssWLSPHIPAudio",$PageHelper.byTagName("a",s)).parent().detach())}else{var C=$PageHelper.byTagName("img",s).filter(function(){return this.src.indexOf("GetHIPData")>-1}).css("height","96px").css("width","216px").css("padding-right","10px");p.append(C.detach())}var y=$PageHelper.byClassName("form-control",s).removeAttr("class");y.attr("name",y.attr("id")),o.type===B||0===$Config.isPlaceholderSupported?y.removeAttr("style").attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }").addClass("spHipNoClear hipInputText primaryTextInput"):y.removeAttr("style").attr("placeholder",HIPAMFE.getInstruction()).attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }"),setTimeout(function(){y.focus()
},0),r.html("").append(p).append(y.detach())}else{var m=$PageHelper.createShim("div").addClass("text-body btn-group").addClass(n).append($PageHelper.byTagName("a",s).addClass("btn btn-block captchaHIPLinks").attr("role","button").removeAttr("style").detach()),p=$PageHelper.createShim("div").addClass(n);if(o.type===B){p.append($PageHelper.byClassName("cssWLSPHIPAudio",m).parent().detach().removeClass("btn btn-block"))}else{var C=$PageHelper.byTagName("img",s).filter(function(){return this.src.indexOf("GetHIPData")>-1
}).css("height","auto").css("width","100%").css("max-width","200px");a||C.addClass("text-body"),p.append(C.detach())}var g=$PageHelper.createShim("div").addClass("form-group template-input").addClass(t),y=$PageHelper.byClassName("form-control",s);y.attr("name",y.attr("id")),o.type!==B&&0!==$Config.isPlaceholderSupported&&$PageHelper.byTagName("body").hasClass("cb")?g.append(y.removeAttr("style").attr("placeholder",HIPAMFE.getInstruction()).attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }").detach()):(g.append($PageHelper.queryAll("label[for='"+y.attr("id")+"']",s).detach().addClass("text-base")),g.append(y.removeAttr("style").attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }").detach()),o.type===B&&setTimeout(function(){y.focus()
},0));var u=$PageHelper.createShim("div").addClass(t).append($PageHelper.byClassName("alert-error",s).detach().addClass("floatLeft"));r.html("").append(p).append(m).append(g).append(u)}o.createObservable(),ko.applyBindingsWithValidation(o.observable,r[0]),S.signup&&S.signup.options.viewDefs.hip&&S.signup.options.viewDefs.hip.options.focusHipPostLoad&&setTimeout(function(){y.focus()},0)}if(o.observable.hip.serverError){o.error=1,o.setError(),o.observable.hip.serverError=null;for(var k=$PageHelper.byClassName("alert-error",r),c=0;c<k.length;c++){var P=$PageHelper.get(k[c]);
if("inline"===P.css("display")){return P.css("display","block"),!1}}}}}:S.isXbox&&h.HIPAMFE&&h.HIPAMFE.postLoad(),h.HIPAMFE&&!h.HIPAMFE.done)){A&&A.showContentProgress();var e=document.getElementById("hipScript"),t=document.querySelector("#hipScript script");if(t){t.src=k.url}else{var n=document.createElement("script");n.type="text/javascript",n.src=k.url,e.appendChild(n)}}}var h=window,C=h.wLive,w=C.Account,y=w.Util,S=h.$Config.WLXAccount,k=S.hip,P=k&&k.enforcement,x=S.isConvergedUX,A=y&&y.MarchingAnts,I=y&&y.FullScreenSpinner,H="error_500",N="errorFieldRequired",$="errorInvalidFormat",E="errorEmailInvalidFormat",T={"EASI":"EASI","Live":"Live","Phone":"Phone","Unknown":"Unknown"},M={"errorFieldRequired":"error_1018","errorEmailInvalidFormat":"error_1035","errorEmailExists":"error_1287"},B="audio",O=null,L=null;
registerNamespace("wLive.Account.FieldHelper"),C.Account.FieldHelper.verifyEmailAddress=a,C.Account.FieldHelper.verifyOttCode=i,C.Account.FieldHelper.verifyRecoveryCode=r,C.Account.FieldHelper.strEquals=n,C.Account.FieldHelper.isCapsLockOn=o,C.Account.FieldHelper.toggleInlineLabel=s,C.Account.FieldHelper.getMemberNameType=l,C.Account.FieldHelper.doesDomainMatch=d,C.Account.FieldHelper.verifyPhoneNumber=p,C.Account.FieldHelper.getErrorString=e,C.Account.FieldHelper.loadHip=b,C.Account.FieldHelper.loadEnforcementHip=v,C.Account.FieldHelper.memberNameTypes=T,C.Account.FieldHelper.errors={"required":N,"invalidFormat":$,"emailInvalidFormat":E},h.$Do&&h.$Do.register("wLive.Account.FieldHelper",0,!0)
}(),function(){function e(e,t){if(e){if(t){var a=n.Account.viewModelHandle;if(a&&a.validationOrder){var o=-1!==$PageHelper.indexOf(e,a.validationOrder),i=o+1,r=a.validationOrder.length===i;if(r){e.focused&&e.focused(!0)}else{if(a.validationOrder.length>i){var s=a.validationOrder[i];s&&s.focused&&(e.focused&&e.focused(!1),s.focused(!0))}}}}else{e.focused&&e.focused(!0)}}}var t=window,n=t.wLive;registerNamespace("wLive.Account.Extensions.Utils"),n.Account.Extensions.Utils.setFocusOnObservable=e}(),$Do.when("jQuery",function(){var e=(window,".placeholder"),t="placement",n={"top":"top","left":$B.ltr?"left":"right","right":$B.ltr?"right":"left","bottom":"bottom"},a={"GamePadA":195};
$Do.when("knockout",function(){ko.bindingHandlers.autoSubmit={"update":function(e,t){var n=t(),a=ko.unwrap(n);a&&(ko.isObservable(n)&&n(!1),$PageHelper.get(e).submit())}},ko.bindingHandlers.errorMessage={"init":function(){return{"controlsDescendantBindings":!0}},"update":function(e,t,n,a,o){{var i=null,r=t();ko.utils.unwrapObservable(r)}if(r.isValid()||r.suppressClientErrors&&r.suppressClientErrors()?r.isModified()||(i=r.serverError||null):i=r.error,ko.utils.setHtml(e,i),n.has("childBindings")){var s=n.get("childBindings")||{};
for(var l in s){var d=document.getElementById(l);d&&ko.applyBindingsToNode(d,s[l],o)}ko.applyBindingsToDescendants(o,e)}}},ko.bindingHandlers.validatorError={"init":function(){return{"controlsDescendantBindings":!0}},"update":function(e,t,n,a,o){{var i=null,r=t();ko.utils.unwrapObservable(r)}if(r.isModified()&&!r.isValid()&&(i=r.error),!r.isModified()&&r.serverError&&(i=r.serverError),ko.utils.setHtml(e,i),n.has("childBindings")){var s=n.get("childBindings")||{};for(var l in s){var d=document.getElementById(l);
d&&d.setAttribute("data-bind",s[l])}ko.applyBindingsToDescendants(o,e)}}},ko.bindingHandlers.hasFocusSelect={"init":function(e,t,n){ko.bindingHandlers.hasfocus.init(e,t,n)},"update":function(e,t){ko.bindingHandlers.hasfocus.update(e,t);var n=t(),a=ko.utils.unwrapObservable(n);a&&$PageHelper.get(e).select()}},ko.bindingHandlers.setFocus={"update":function(e,t){var n=t(),a=ko.utils.unwrapObservable(n);a&&$PageHelper.get(e).focus()}},ko.bindingHandlers.tooltip={"init":function(e,a){if(!($B&&$B.IE&&$B.V&&$B.V<=8)){var o=a(),i=ko.utils.unwrapObservable(o),r=$PageHelper.get(e),s=$PageHelper.get(window),l=".tooltip";
if(i&&i.target){var d=$PageHelper.queryAll(i.target);d&&d.length>0&&(r.on("blur"+l,function(){$PageHelper.hasFocus(d)||d.tooltip&&d.tooltip("hide")}),r.on("focus"+l,function(){d.tooltip&&d.tooltip("show")})),s.on("resize",function(){$PageHelper.hasFocus(r)&&d.tooltip&&(d.tooltip("hide"),d.tooltip("show"))})}else{r.on("show.bs.tooltip",function(){$PageHelper.byClassName("tooltip").not(this).hide()});var c={};c.animation=!1;var u=i&&i[t]&&n[i[t]];c[t]=u||n.right,c.container="#maincontent",c.viewport="#maincontent",i&&i.html&&(c.html=!0,c.delay={"show":150,"hide":100}),i&&i.setup?(c.trigger="manual",i.setup()):c.trigger="focus",i&&i.dynamic&&r.on("change"+l,function(){r.tooltip("hide"),r.tooltip("show")
}),i&&i.hover&&(r.on("mouseover"+l,function(){r.tooltip("show")}),r.on("mouseout"+l,function(){r.tooltip("hide")})),i&&i.click&&(r.on("click"+l,function(){r.tooltip("show")}),r.on("focus"+l,function(){r.tooltip("show")}),r.on("blur"+l,function(){r.tooltip("hide")})),r.tooltip(c),s.on("resize",function(){r.is(":focus")&&(r.tooltip("hide"),r.tooltip("show"))})}ko.utils.domNodeDisposal.addDisposeCallback(e,function(){s.off("resize"),r.off(l),s=null,r=null})}}},ko.bindingHandlers.inputWithPlaceholder={"init":function(t,n,a){ko.bindingHandlers.textInput.init(t,n,a);
var o=".placeholder",i=$PageHelper.get(t),r=i.next(e);r.on("click"+o,function(){setTimeout(function(){i.focus()},0)}),ko.utils.domNodeDisposal.addDisposeCallback(t,function(){i=null,r.off(o),r=null})},"update":function(t,n,a){var o=ko.bindingHandlers.textInput.update;o&&o();var i=n(),r=ko.utils.unwrapObservable(i),s=$PageHelper.get(t).next(e);s.length>0&&ko.bindingHandlers.visible.update(s[0],function(){var e=a.get("inlineLabelId");if(e){var t=$PageHelper.byId(e);r?t.css("opacity",1):t.css("opacity",0)}return!r
})}},ko.bindingHandlers.htmlWithBindings={"init":function(){return{"controlsDescendantBindings":!0}},"update":function(e,t,n,a,o){ko.utils.setHtml(e,t());var i=n.get("childBindings");if(i){for(var r in i){var s=document.getElementById(r);s&&ko.applyBindingsToNode(s,i[r],o)}}ko.applyBindingsToDescendants(o,e)}},ko.bindingHandlers.moveOffScreen={"update":function(e,t){var n=ko.unwrap(t());ko.bindingHandlers.css.update(e,function(){return{"moveOffScreen":n}}),ko.bindingHandlers.attr.update(e,function(){return{"tabindex":n?-1:0,"aria-hidden":n}
})}},ko.bindingHandlers.ariaDescribedBy={"update":function(e,t){ko.bindingHandlers.attr.update(e,function(){return{"aria-describedby":t()}})}},ko.bindingHandlers.ariaLabel={"update":function(e,t){ko.bindingHandlers.attr.update(e,function(){return{"aria-label":t()}})}},ko.bindingHandlers.checkedEx={"init":function(e,t,n){ko.bindingHandlers.checked.init(e,t,n);var o=t();ko.utils.registerEventHandler(e,"keydown",function(t){var n=t&&(t.which||t.keyCode);n==a.GamePadA&&o(!e.checked)})}}})}),function(e){$Do.when("jQuery",function(){function t(e,t){return!e||!Boolean(e.match(t))
}function n(e,t,n){for(var a=!0,o=0;o<t.length&&(a=Boolean(e.match(t[o])),!(!n&&a||n&&!a));o++){}return a}function a(e,t,n){return n&&(e=e.toLowerCase(),t=t.toLowerCase()),0===e.indexOf(t)}function o(e,t,n){return n&&(e=e.toLowerCase(),t=t.toLowerCase()),e.lastIndexOf(t)+t.length===e.length}var i=e.wLive,r=(i.Core,i.Account),s=r.Util||{},l=e.$Config.WLXAccount,d=l.signup,c=r.FieldHelper,u=r.Extensions.Utils,p="newpwd";$Do.when("knockout",function(){var l=e.ko;$PageHelper.extend(l.validation.rules,{"birthdatePartRequired":{"validator":function(e){var t="",n="",a="",o=e.split(":");
return 3===o.length&&(t=o[0],n=o[1],a=o[2]),Boolean(t&&n&&a)},"message":""},"birthdateValid":{"validator":function(e){var t=new Date,n="",a="",o="",i=e.split(":");3===i.length&&(n=i[0],a=i[1],o=i[2]);var r=d&&"undefined"!=typeof d.minBirthYear&&"undefined"!=typeof d.maxBirthYear,s=parseInt(o,10),l=parseInt(a,10)-1,c=parseInt(n,10),u=new Date(s,l,c);return!(u>t||0/0===s||0/0===l||0/0===c||c!==u.getDate()||l!==u.getMonth()||s!==u.getFullYear()||r&&(s<d.minBirthYear||s>d.maxBirthYear))},"message":""},"pwdContainsMemberName":{"validator":function(e){var t=d.viewContext&&d.viewContext.data&&d.viewContext.data.input?d.viewContext.data.input.memberNameInput:"";
return e&&t&&0!==t.length?-1===e.toLowerCase().indexOf(t.toLowerCase().split("@")[0]):!0},"message":""},"pwdComplexity":{"validator":function(e){for(var t=[/[\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]+/,/[\x30-\x39]+/,/[\x41-\x5A]+/,/[\x61-\x7A]+/],n=2,a=0,o=0,i=t.length;i>o;o++){if(e.match(t[o])&&a++,a>=n){return!0}}return!1},"message":""},"strongPwdComplexity":{"validator":function(e){for(var t=[/[\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]+/,/[\x30-\x39]+/,/[\x41-\x5A]+/,/[\x61-\x7A]+/],n=3,a=0,o=0,i=t.length;i>o;o++){if(e.match(t[o])&&a++,a>=n){return!0
}}return!1},"message":""},"notMatchingPattern":{"validator":function(e,n){return t(e,n)},"message":""},"allPatterns":{"validator":function(e,t){return n(e,t,!0)},"message":""},"onePattern":{"validator":function(e,t){return n(e,t,!1)},"message":""},"userNamePattern":{"validator":function(e,t){if(!e||0===e.length||-1===e.indexOf("@")){return!1}var a=e.split("@");return 2!==a.length?!1:n(a[0],t,!1)}},"userNameRequired":{"validator":function(e){if(!e||0===e.length||-1===e.indexOf("@")){return!1}var t=e.split("@");
return 2!==t.length?!1:t[0].trim().length>0}},"liveMemberNameValid":{"validator":function(e,t){var a=t.domains,o=t.patterns;return a&&0!==a.length&&c.getMemberNameType(e,a)===c.memberNameTypes.Live?n(e.split("@")[0],o,!0):!0}},"proofClearPortionMatchEmail":{"validator":function(e,t){if(e){var i=a(e,t.clearPortion(),!0),r=t.domainPortion(),s=t.patterns,l=t.allowZero;return l&&"0"===String(e)?!0:e.indexOf("@")>=0?i&&o(e,r,!0)&&n(e,s,!0):i&&n(e+r,s,!0)}return!1}},"proofClearPortionMatchPhone":{"validator":function(e,t){return t.allowZero&&"0"===String(e)?!0:Boolean(e&&e.length===t.matchDigits&&e.match(/^\d+$/)&&o(e,t.clearPortion(),!0))
}},"memberNameValidForFl":{"validator":function(e,t){var n=t.fl,a=c.getMemberNameType(e,t.domains);return"EASI"===n&&a!==c.memberNameTypes.EASI?!1:"Live"===n&&a!==c.memberNameTypes.Live?!1:"Phone"===n&&a!==c.memberNameTypes.Phone?!1:!0}},"hipValidation":{"validator":function(t){var n=e.HIPAMFE;return n&&n.done?($PageHelper.queryAll("#hipContent .hiddenHipInputText").val(t),i.Account&&i.Account.viewModelHandle&&i.Account.viewModelHandle.hip&&i.Account.viewModelHandle.hip.serverError&&""===i.Account.viewModelHandle.hip()?(this.message=i.Account.viewModelHandle.hip.serverError,!1):(n.clientValidation(),n.setError(),this.message=n.getError(),""===n.getError())):!0
}},"bannedPwd":{"async":!0,"validator":function(t,n,a){var o=s.FullScreenSpinner,i={"uaid":e.$Config.uaid};i.cipherValue=Encrypt("","",p,t),i.ski=n.ski,o&&o.show(),e.$DataRequest.Json(null,n.url,i,function(e){o&&o.hide(e.isBanned),a(!e.isBanned),u.setFocusOnObservable(n.observable,!e.isBanned)},function(){o&&o.hide(!1),a(!0),u.setFocusOnObservable(n.observable,!0)})},"message":""},"checkAvailable":{"async":!0,"validator":function(t,n,a){var o={"signInName":t,"uaid":e.$Config.uaid};n.dft&&(o.dft=n.dft),n.includeSuggestions&&(o.includeSuggestions=n.includeSuggestions);
{var i="Account_CheckAvailPage",l=s.MarchingAnts,c=s.FullScreenSpinner;r.SignupHelper}c&&c.show(),l&&l.showLightboxProgress(),e.$DataRequest.Json(null,n.url,o,function(o){try{var r={},s=e.performance&&e.performance.now?e.performance.now():(new Date).getTime();r.pageId=i,r.duration=Math.round(s-checkAvailableNamesApiStartTime),r.skipClientCall=!0,$ReportEvent.Action(r)}catch(p){}var m=!o||o.isAvailable,g=o&&o.type,f=o&&o.suggestions||[],v=f.length>0,b=o&&o.isProof,h=o&&o.possibleEviction,C=o&&o.nopaAllowed,w=n.getResult&&n.getResult(0,t,m,g,v,b,h,C);
l&&l.hideLightboxProgress(),c&&c.hide(w&&!w.isValid||!m),n.getSuggestedMemberNames&&n.getSuggestedMemberNames(f),n.setSuccessMessage&&m&&n.setSuccessMessage(g,t),d.viewContext&&d.viewContext.data&&d.viewContext.data.reporting&&(d.viewContext.data.reporting.memberNameChangeCount++,m?d.viewContext.data.reporting.memberNameAvailableCount++:d.viewContext.data.reporting.memberNameUnavailableCount++),a(w?w:m),u.setFocusOnObservable(n.observable,m&&1===$B.IE)},function(o){var r=o&&o.error;try{var s={},p=e.performance&&e.performance.now?e.performance.now():(new Date).getTime();
s.pageId=i,s.duration=Math.round(p-checkAvailableNamesApiStartTime),s.errorCode=r?o.error.code:"",s.skipClientCall=!0,$ReportEvent.Action(s)}catch(m){}var g=o&&o.suggestions||[],f=g.length>0,v=n.getResult&&n.getResult(r&&o.error.code,t,void 0,void 0,f);l&&l.hideLightboxProgress(),c&&c.hide(!0),n.getSuggestedMemberNames&&n.getSuggestedMemberNames(g),d.viewContext&&d.viewContext.data&&d.viewContext.data.reporting&&(d.viewContext.data.reporting.memberNameChangeCount++,d.viewContext.data.reporting.memberNameUnavailableCount++),a(v?v:!1),u.setFocusOnObservable(n.observable,!0)
},null,null,null,null,!0),checkAvailableNamesApiStartTime=e.performance&&e.performance.now?e.performance.now():(new Date).getTime()},"message":""},"getPhoneDetails":{"async":!0,"validator":function(t,n,a){function o(e){if(!e.phoneDetails||e.phoneDetails.length<=0){a(!1)}else{var t=e.phoneDetails[0];n.phoneDetails&&n.phoneDetails(t),a(t.IsValid===!0)}}function i(e){a(!!n.onError),n.onError&&n.onError(e)}var r={"phone":[].concat(t),"uaid":e.$Config.uaid};n.country&&(r.country=[].concat(n.country())),e.$DataRequest.Json(null,n.url,r,o,i)
}}}),l.validation.registerExtenders()})})}(window),JSMPnumber.prototype={"size":1,"data":[0]},!function(){registerNamespace("$Config.WLXAccount.signup"),$Config.WLXAccount.signup.errorCodes={"hipValidationError":"1043","hipNeeded":"1040","hipEnforcementNeeded":"1041","hipSMSNeeded":"1042","dailyLimitIDsReached":"450","oneTimeCodeInvalid":"1304","verificationSltInvalid":"1324","membernameTaken":"1058","domainNotAllowed":"1117","domainIsReserved":"1181","forbiddenWord":"403","passwordIncorrect":"1002","passwordConflict":"1009","invalidEmailFormat":"1062","invalidPhoneFormat":"1063","invalidBirthDate":"1039","invalidGender":"1243","invalidFirstName":"1240","invalidLastName":"1241","maximumOTTDailyError":"1204","bannedPassword":"1217","proofAlreadyExistsError":"1246","domainExistsInAad":"1184","domainExistsInAadSupportedLogin":"1185","membernameTakenEasi":"1242","membernameTakenPhone":"1052","signupBlocked":"1220","invalidMemberNameFormat":"1064","passwordRequired":"1330","emailMustStartWithLetter":"1256","evictionWarningRequired":"1334","hipCaptchaNeededOnSendOTT":"1339","hipEnforcementNeededOnSendOTT":"1340"}
}(),!function(){registerNamespace("$Config.WLXAccount.signup"),$Config.WLXAccount.signup.regularexpressions={"LiveMembernameRegex":"^(?:(?:[a-zA-Z])|(?:[\\w\\-](?:(?![\\.]{2,})[\\w\\.\\-]){0,62}[\\w\\-]))$","MembernameRegex":"^[a-zA-Z0-9_-]+(?:\\.[a-zA-Z0-9_-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$","PwdValidInput":"^[\\x20-\\x7e]{8,127}$","AltEmailRegEx":"^[a-zA-Z0-9!#$%\\x26'*+/=?^_`{|}~-]+(?:\\.[a-zA-Z0-9!#$%\\x26'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$","PhoneNumberFormat":"^[\\+]{0,1}([\\(\\)\\- \\*\\.#/\\[\\]]*\\d[\\(\\)\\- \\*\\.#/\\[\\]]*){4,20}$","ProfileRegex":"([\\x00-\\x1f]|[\\x21-\\x26]|[\\x28-\\x2c]|\\x2f|[\\x3a-\\x40]|[\\x5b-\\x5e]|\\x60|[\\x7b-\\x7f]|\\x81|\\xa0|\\xad)"}
}(),function(){registerNamespace("$Config.WLXAccount.signup"),$Config.WLXAccount.signup.signupObservableSets={"firstName":{"name":"firstName"},"lastName":{"name":"lastName"},"memberName":{"name":"memberName","clientPrefillKey":"PfUsernames"},"usernameRecoverySpeedbump":{"name":"usernameRecoverySpeedbump"},"password":{"name":"password"},"retypePassword":{"name":"retypePassword"},"country":{"name":"country"},"birthdate":{"name":"birthdate"},"birthdateHTML5":{"name":"birthdateHTML5"},"phoneCountry":{"name":"phoneCountry"},"phoneNumber":{"name":"phoneNumber"},"alternateEmail":{"name":"alternateEmail"},"hip":{"name":"hip"},"verification":{"name":"verification"},"fedConfirm":{"name":"fedConfirm"},"fedPicker":{"name":"fedPicker"},"additionalLegalText":{"name":"additionalLegalText"},"optinEmailCheckbox":{"name":"optinEmailCheckbox"},"secondOptinEmailCheckbox":{"name":"secondOptinEmailCheckbox"},"evictionSpeedbump":{"name":"evictionSpeedbump"},"evictionSpeedbumpErrorView":{"name":"evictionSpeedbumpErrorView"},"hipEnforcement":{"name":"hipEnforcement"},"hasSeenKoreaDataCollection":{"name":"hasSeenKoreaDataCollection"},"hasSeenKoreaDataProvision":{"name":"hasSeenKoreaDataProvision"}}
}(),!function(){var e="credentials",t="cancel",n="action",a="create",o="finalBack",i="password",r="usernameRecoverySpeedbump",s="verification",l="fedConfirm",d="fedPicker",c="fedSignInSpeedbump",u="profileAccrual",p="birthDateCountryAccrual",m="childBlock",g="privacy",f="tou",v="dataCollection",b="dataUse",h="retention",C="hip",w="hipEnforcement",y="blocked",S="impressum",k="a11yConforme",P="memberNameTakenLearnMore",x="deviceTicket",A="cxhCancel",I="cxhLocalAccount",H="evictionSpeedbump",N="mojangSpeedbump",$="mojangCancel",E="upgradeChildSpeedbump",T="evictionError",M="koreaPrivacyConsent",B="koreaConsentDataCollection",O="koreaConsentDataProvision",L="proofCollection",D="chinaPIPLConsent",F="chinaPIPLConsentLearnMore";
registerNamespace("$Config.WLXAccount.signup");var _,U,V=$Config.WLXAccount,R=$Config.cpgids,W=V&&V.signup,q=1===W.showKoreaConsentView,z=V&&V.hasWin10NonOOBEBehavior,G=W.page,j=W.viewContext,X=0!==G.collectDob,K=0!==G.collectFLName,Q=G.useKoreaPrivacy,J=W.fss.isFamilyAddMemberFlow,Z=!!G.fedStateToken,Y=Z&&G.fedNamesPrefill&&1===G.fedNamesPrefill.length,et=Z&&G.fedNamesPrefill&&G.fedNamesPrefill.length>1,tt=G.isFLOrder,nt=tt?"firstName":"lastName",at=tt?"lastName":"firstName",ot=1===W.showChinaPIPLConsentView;
W.startState=W.collectDeviceTicket?x:Y?X&&j&&j.data&&j.data.prefill&&j.data.prefill.birthdate?p:l:et?d:G.isMojangUpgrade&&G.showMojangUpgradeSpeedbump?N:!G.isMojangUpgrade||G.showMojangUpgradeExp||W.prefillMembernameIsProof?W.prefillMembernameIsProof&&!G.showMojangUpgradeExp?r:W.prefillMembernameIsPossiblyEvicted?H:e:i,q&&W.startState!==x&&(_=W.startState,W.startState=M),ot&&W.startState!==x&&(U=W.startState,W.startState=D),W.options={"states":[x,e,r,i,g,f,H,c,T,v,b,h,C,w,y,s,l,d,u,p,S,k,m,N,E,P,M,B,O,L,D,F],"viewDefs":{"deviceTicket":{"pageId":R.Signup_GetDeviceTicketPage_Client,"sectionId":"DeviceTicket","control":"SignupControl","options":{"viewModel":"SignupViewModel","pageNextAction":n},"actions":{"privacy":g,"tou":f,"retention":h,"impressum":S,"a11yConforme":k,"dataCollection":v,"dataUse":b}},"koreaPrivacyConsent":{"pageId":R.Signup_KoreaPrivacyConsent_Client,"sectionId":"KoreaPrivacyConsent","control":"SignupControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":["hasSeenKoreaDataCollection","hasSeenKoreaDataProvision"]},"pageBackAction":t,"pageNextAction":n,"autoForm":!1,"disableAutoFocus":!0},"actions":{"action":_,"cancel":o,"privacy":g,"tou":f,"impressum":S,"a11yConforme":k,"retention":h,"dataCollection":v,"dataUse":b,"koreaConsentDataCollection":B,"koreaConsentDataProvision":O}},"credentials":{"pageId":R.Signup_MemberNamePage_Client,"sectionId":"Credentials","control":K||X?"SignupControl":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":G.isPaginated?G.showMojangUpgradeExp?["memberName","password"]:["memberName"]:["memberName","password","additionalLegalText","optinEmailCheckbox","secondOptinEmailCheckbox"],"stepCounter":G.credentialsStep,"totalSteps":G.totalStep},"focusFirstInput":1,"optInEmailId":"iOptinEmail","secondOptinEmailId":"iSecondOptinEmail","pageBackAction":ot||q||et||G.showMojangUpgradeSpeedbump?"backStack":t,"pageNextAction":n,"pageTitle":$Config.sharedStrings.pageTitle,"autoForm":!1},"actions":{"cancel":o,"privacy":g,"tou":f,"dataCollection":v,"localAccount":I,"dataUse":b,"retention":h,"impressum":S,"a11yConforme":k,"hip":C,"hipEnforcement":w,"blocked":y,"action":K?u:X?p:a,"verification":s,"password":i,"memberNameTakenLearnMore":P,"usernameRecoverySpeedbump":r,"evictionSpeedbump":H,"fedSignInSpeedbump":c,"fedConfirm":l,"fedPicker":d,"backStack":[d,N,M,D]}},"usernameRecoverySpeedbump":{"pageId":R.Signup_UsernameRecoverySpeedbumpPage_Client,"sectionId":"UsernameRecoverySpeedbump","control":K||X?"SignupControl":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":["usernameRecoverySpeedbump"]},"pageBackAction":q||G.showMojangUpgradeSpeedbump?"backStack":t,"pageNextAction":n,"showIdentityBanner":1,"pageTitle":W.strings.usernameRecoverySpeedbumpPageTitle,"autoForm":!1},"actions":{"action":K?u:X?p:a,"cancel":e,"password":i,"verification":s,"finalBack":o,"privacy":g,"tou":f,"retention":h,"impressum":S,"a11yConforme":k,"fedConfirm":l,"fedSignInSpeedbump":c,"backStack":[N,M,D]}},"evictionSpeedbump":{"pageId":R.Signup_EvictionSpeedbumpPage_Client,"sectionId":"EvictionSpeedbump","control":K||X?"SignupControl":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":["evictionSpeedbump"]},"pageBackAction":q?"backStack":t,"pageNextAction":n,"showIdentityBanner":1,"pageTitle":W.strings.evictionSpeedbumpPageTitle,"autoForm":!1},"actions":{"action":K?u:X?p:a,"cancel":e,"password":i,"verification":s,"finalBack":o,"privacy":g,"tou":f,"retention":h,"impressum":S,"a11yConforme":k,"fedConfirm":l,"backStack":[M,D]}},"evictionError":{"pageId":R.Signup_EvictionErrorView_Client,"sectionId":"EvictionError","control":"SignupControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":["evictionSpeedbumpErrorView"]},"pageBackAction":"backStack","pageNextAction":n,"showIdentityBanner":1,"pageTitle":W.strings.evictionSpeedbumpPageTitle,"autoForm":!1},"actions":{"action":i,"backStack":[i,C,w,s,E,l,p,u]}},"proofCollection":{"pageId":R.Signup_Proof_Collection_Client,"sectionId":"ProofCollection","control":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":["alternateEmail","phoneNumber","phoneCountry"]},"pageBackAction":"backStack","pageNextAction":n,"pageTitle":$Config.sharedStrings.pageTitle,"showIdentityBanner":1,"autoForm":!1},"actions":{"action":a,"password":i,"backStack":[i,C,w,p,u]}},"memberNameTakenLearnMore":{"pageId":R.Signup_MemberNameTaken_Phone_LearnMore,"sectionId":"MemberNameTakenLearnMore","control":"SignupControl","options":{"viewModel":"SignupViewModel","pageNextAction":n,"pageTitle":$Config.sharedStrings.pageTitle,"autoForm":!1},"actions":{"action":e,"backStack":[e]}},"fedSignInSpeedbump":{"pageId":R.Signup_FedSignInSpeedbumpPage_Client,"sectionId":"FedSignInSpeedbump","control":"SignupControl","options":{"viewModel":"SignupViewModel","pageBackAction":"backStack","pageNextAction":n,"showIdentityBanner":1,"pageTitle":W.strings.fedSignInSpeedbumpPageTitle,"autoForm":!1},"actions":{"action":i,"cancel":o,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"hip":C,"hipEnforcement":w,"blocked":y,"password":i,"impressum":S,"a11yConforme":k,"credentials":e,"profileAccrual":u,"birthDateCountryAccrual":p,"evictionSpeedbump":H,"usernameRecoverySpeedbump":r,"verification":s,"fedPicker":d,"finalBack":o,"backStack":[p,u,e,r,H,s,d]}},"mojangSpeedbump":{"pageId":R.Signup_MojangSpeedbumpPage_Client,"sectionId":"MojangSpeedbump","control":"SignupControl","options":{"viewModel":"SignupViewModel","focusSubmit":1,"pageBackAction":q?"backStack":t,"pageNextAction":n,"pageTitle":W.strings.mojangSpeedbumpTitle,"autoForm":!1},"actions":{"action":G.showMojangUpgradeExp||W.prefillMembernameIsProof?W.prefillMembernameIsProof&&!G.showMojangUpgradeExp?r:e:i,"cancel":$,"password":i,"usernameRecoverySpeedbump":r,"credentials":e,"finalBack":o,"privacy":g,"tou":f,"retention":h,"impressum":S,"a11yConforme":k,"backStack":[M,D]}},"password":{"pageId":R.Signup_PasswordPage_Client,"sectionId":"Password","control":K||X?"SignupControl":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":["password","additionalLegalText","optinEmailCheckbox","secondOptinEmailCheckbox"],"stepCounter":G.passwordStep},"optInEmailId":"iOptinEmail","secondOptinEmailId":"iSecondOptinEmail","focusFirstInput":1,"pageBackAction":"backStack","pageNextAction":n,"showIdentityBanner":1,"pageTitle":W.strings.passwordPageTitle,"autoForm":!1},"actions":{"cancel":e,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"hip":C,"hipEnforcement":w,"blocked":y,"evictionError":T,"impressum":S,"a11yConforme":k,"action":K?u:X?p:a,"verification":s,"finalBack":o,"usernameRecoverySpeedbump":r,"evictionSpeedbump":H,"fedSignInSpeedbump":c,"fedConfirm":l,"backStack":[e,r,H,c,N,M,D]}},"privacy":{"pageId":R.Signup_PrivacyPage_Client,"sectionId":"TOUPrivacy","control":"TouPrivacyControl","options":{"viewModel":"SignupViewModel","isPrivacy":1,"command":Q?"koreaprivacy":"privacy","pageBackAction":"backStack","pageNextAction":n,"autoForm":!1,"disableAutoFocus":W.isFluent},"actions":{"action":e,"cancel":e,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"impressum":S,"a11yConforme":k,"fedConfirm":l,"fedPicker":d,"fedSignInSpeedbump":c,"backStack":[x,e,i,s,C,w,y,u,p,l,d,c,M,D]}},"tou":{"pageId":R.Signup_TouPage_Client,"sectionId":"TOUPrivacy","control":"TouPrivacyControl","options":{"viewModel":"SignupViewModel","isPrivacy":0,"command":"tou","pageBackAction":"backStack","pageNextAction":n,"autoForm":!1,"disableAutoFocus":W.isFluent},"actions":{"action":e,"cancel":e,"privacy":g,"dataCollection":v,"dataUse":b,"retention":h,"impressum":S,"a11yConforme":k,"fedConfirm":l,"fedPicker":d,"fedSignInSpeedbump":c,"backStack":[x,e,i,s,C,w,y,u,p,l,d,c,M,D]}},"impressum":{"pageId":R.Signup_ImpressumPage_Client,"sectionId":"Impressum","control":"SignupControl","options":{"viewModel":"SignupViewModel","pageBackAction":"backStack","pageNextAction":n,"autoForm":!1,"disableAutoFocus":W.isFluent},"actions":{"action":e,"cancel":e,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"fedConfirm":l,"fedPicker":d,"fedSignInSpeedbump":c,"backStack":[x,e,i,s,C,w,y,u,p,l,d,c,M,D]}},"a11yConforme":{"pageId":R.Signup_A11yConformePage_Client,"sectionId":"A11yConforme","control":"SignupControl","options":{"viewModel":"SignupViewModel","pageBackAction":"backStack","pageNextAction":n,"autoForm":!1,"disableAutoFocus":W.isFluent},"actions":{"action":e,"cancel":e,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"fedConfirm":l,"fedPicker":d,"fedSignInSpeedbump":c,"backStack":[x,e,i,s,C,w,y,u,p,l,d,c,M,D]}},"dataCollection":{"pageId":R.Signup_DataCollectionPage_Client,"sectionId":"TOUPrivacy","control":"TouPrivacyControl","options":{"viewModel":"SignupViewModel","command":"koreaprivacyextract","pageBackAction":"backStack","pageNextAction":n,"autoForm":!1,"disableAutoFocus":W.isFluent},"actions":{"action":e,"cancel":e,"privacy":g,"tou":f,"dataUse":b,"retention":h,"impressum":S,"a11yConforme":k,"fedConfirm":l,"fedPicker":d,"fedSignInSpeedbump":c,"backStack":[x,e,i,s,C,w,y,u,p,l,d,c]}},"dataUse":{"pageId":R.Signup_DataUsePage_Client,"sectionId":"TOUPrivacy","control":"TouPrivacyControl","options":{"viewModel":"SignupViewModel","command":"koreaprivacyextract","pageBackAction":"backStack","pageNextAction":n,"autoForm":!1,"disableAutoFocus":W.isFluent},"actions":{"action":e,"cancel":e,"privacy":g,"tou":f,"dataCollection":v,"retention":h,"impressum":S,"a11yConforme":k,"fedConfirm":l,"fedPicker":d,"fedSignInSpeedbump":c,"backStack":[x,e,i,s,C,w,y,u,p,l,d,c]}},"retention":{"pageId":R.Signup_DataRetentionPage_Client,"sectionId":"TOUPrivacy","control":"TouPrivacyControl","options":{"viewModel":"SignupViewModel","command":"koreaprivacyextract","pageBackAction":"backStack","pageNextAction":n,"autoForm":!1,"disableAutoFocus":W.isFluent},"actions":{"action":e,"cancel":e,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"impressum":S,"a11yConforme":k,"fedConfirm":l,"fedPicker":d,"fedSignInSpeedbump":c,"backStack":[x,e,i,s,C,w,y,u,p,l,d,c]}},"hip":{"pageId":R.Signup_HipPage_Client,"sectionId":"HipPane","control":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":["hip"]},"focusFirstInput":1,"focusHipPostLoad":1,"pageBackAction":"backStack","pageNextAction":n,"showIdentityBanner":1,"pageTitle":$Config.sharedStrings.hipHeading,"autoForm":!1},"actions":{"action":a,"cancel":Y?l:et?d:e,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"hip":C,"hipEnforcement":w,"blocked":y,"impressum":S,"a11yConforme":k,"evictionError":T,"credentials":e,"password":i,"verification":s,"fedConfirm":l,"fedPicker":d,"backStack":[x,e,i,s,y,u,p,l,d,c]}},"hipEnforcement":{"pageId":R.Signup_HipEnforcementPage_Client,"sectionId":"HipEnforcement","control":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":["hipEnforcement"]},"focusFirstInput":1,"focusHipPostLoad":1,"pageBackAction":"backStack","pageNextAction":n,"showIdentityBanner":1,"pageTitle":$Config.sharedStrings.hipHeading,"autoForm":!1},"actions":{"action":a,"cancel":Y?l:et?d:e,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"hip":C,"hipEnforcement":w,"blocked":y,"evictionError":T,"impressum":S,"a11yConforme":k,"credentials":e,"password":i,"verification":s,"fedConfirm":l,"fedPicker":d,"backStack":[x,e,i,s,y,u,p,l,d,c]}},"blocked":{"pageId":R.Signup_BlockedPage_Client,"sectionId":"Blocked","control":"PageDialogControl","options":{"viewModel":"SignupViewModel","pageBackAction":t,"pageNextAction":n,"autoForm":!1},"actions":{"action":z?I:o,"cancel":z?J?A:I:o,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"hip":C,"hipEnforcement":w,"blocked":y,"impressum":S,"a11yConforme":k}},"verification":{"pageId":R.Signup_VerificationPage_Client,"sectionId":"Verification","control":Z?"SignupControl":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":G.isPaginated&&!Z?["verification","additionalLegalText","optinEmailCheckbox","secondOptinEmailCheckbox"]:["verification"],"stepCounter":G.verificationStep},"optInEmailId":"iOptinEmail","secondOptinEmailId":"iSecondOptinEmail","focusFirstInput":1,"pageBackAction":"backStack","pageNextAction":n,"showIdentityBanner":1,"pageTitle":$Config.sharedStrings.lblVerificationCode,"autoForm":!1},"actions":{"action":Z?l:a,"cancel":a,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"hip":C,"hipEnforcement":w,"blocked":y,"evictionError":T,"impressum":S,"a11yConforme":k,"credentials":e,"password":i,"profileAccrual":u,"birthDateCountryAccrual":p,"evictionSpeedbump":H,"usernameRecoverySpeedbump":r,"fedSignInSpeedbump":c,"fedConfirm":l,"fedPicker":d,"backStack":[p,u,i,e,H,r,c,d]}},"fedConfirm":{"pageId":R.Signup_FedConfirmPage_Client,"sectionId":"FedConfirm","control":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":["fedConfirm","additionalLegalText"]},"focusFirstInput":1,"pageBackAction":!q&&Y&&W.startState===l?t:"backStack","pageNextAction":n,"showIdentityBanner":1,"pageTitle":W.strings.fedConfirmPageTitle,"autoForm":!1},"actions":{"action":a,"cancel":o,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"hip":C,"hipEnforcement":w,"blocked":y,"evictionError":T,"impressum":S,"a11yConforme":k,"credentials":e,"profileAccrual":u,"birthDateCountryAccrual":p,"evictionSpeedbump":H,"usernameRecoverySpeedbump":r,"verification":s,"fedPicker":d,"backStack":[p,u,e,r,H,s,d,M,D]}},"fedPicker":{"pageId":R.Signup_FedPickerPage_Client,"sectionId":"FedPicker","control":K||X?"SignupControl":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":["fedPicker"]},"pageBackAction":q?"backStack":t,"pageNextAction":n,"pageTitle":W.strings.fedPickerPageTitle,"autoForm":!1},"actions":{"action":K?u:X?p:a,"cancel":o,"privacy":g,"tou":f,"impressum":S,"a11yConforme":k,"fedConfirm":l,"credentials":e,"password":i,"verification":s,"backStack":[M,D]}},"profileAccrual":{"pageId":R.Signup_ProfileAccrualPage_Client,"userAction":"Action_ClientSideTelemetry","sectionId":"ProfileAccrual","control":X?"SignupControl":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":[nt,at],"stepCounter":G.profileAccrualStep},"focusFirstInput":1,"pageBackAction":"backStack","pageNextAction":n,"showIdentityBanner":1,"pageTitle":W.overrideStrings&&W.overrideStrings.profileAccrualPageTitle?W.overrideStrings.profileAccrualPageTitle:$Config.sharedStrings.profileAccrualPageTitle,"autoForm":!1},"actions":{"action":X?"birthDateCountryAccrual":a,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"hip":C,"hipEnforcement":w,"blocked":y,"evictionError":T,"impressum":S,"a11yConforme":k,"credentials":e,"verification":s,"password":i,"evictionSpeedbump":H,"usernameRecoverySpeedbump":r,"fedSignInSpeedbump":c,"fedConfirm":l,"fedPicker":d,"backStack":[i,e,H,r,c,d]}},"birthDateCountryAccrual":{"pageId":R.Signup_BirthdatePage_Client,"userAction":"Action_ClientSideTelemetry","sectionId":"BirthDateCountryAccrual","control":"SignupCreateControl","options":{"viewModel":"SignupViewModel","viewModelOptions":{"observables":G.isMojangUpgrade?["country","birthdate","additionalLegalText"]:X?["country","birthdate"]:[],"stepCounter":G.birthDateCountryAccrualStep},"focusFirstInput":1,"pageBackAction":q||W.startState!==p?"backStack":t,"pageNextAction":n,"showIdentityBanner":1,"pageTitle":W.strings.birthdatePageTitle,"autoForm":!1},"actions":{"action":a,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"hip":C,"hipEnforcement":w,"blocked":y,"evictionError":T,"impressum":S,"a11yConforme":k,"credentials":e,"verification":s,"password":i,"profileAccrual":u,"evictionSpeedbump":H,"usernameRecoverySpeedbump":r,"fedSignInSpeedbump":c,"fedConfirm":l,"fedPicker":d,"childBlock":m,"upgradeChildSpeedbump":E,"proofCollection":L,"cancel":G.isMojangUpgrade?$:o,"backStack":[u,i,e,H,r,c,d,M,D]}},"childBlock":{"pageId":R.Signup_ChildBlockedPage_Client,"sectionId":"ChildBlocked","control":"PageDialogControl","options":{"viewModel":"SignupViewModel","pageBackAction":t,"pageNextAction":n},"actions":{"action":$,"cancel":p,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"blocked":y,"impressum":S,"a11yConforme":k}},"upgradeChildSpeedbump":{"pageId":R.Signup_UpgradeChildSpeedbumpPage_Client,"sectionId":"UpgradeChildSpeedbump","control":"SignupCreateControl","options":{"viewModel":"SignupViewModel","focusSubmit":1,"pageBackAction":t,"pageNextAction":n},"actions":{"action":a,"cancel":$,"privacy":g,"tou":f,"dataCollection":v,"dataUse":b,"retention":h,"blocked":y,"evictionError":T,"impressum":S,"a11yConforme":k,"hip":C,"hipEnforcement":w,"credentials":e,"verification":s,"password":i,"profileAccrual":u,"evictionSpeedbump":H,"usernameRecoverySpeedbump":r,"backStack":[u,i,e,H,r]}},"mojangCancel":{"url":W.mojangCancelUrl},"koreaConsentDataCollection":{"pageId":R.Signup_KoreaConsentDataCollectionPage_Client,"sectionId":"TOUPrivacy","control":"TouPrivacyControl","options":{"viewModel":"SignupViewModel","command":"koreadatacollection","pageBackAction":"backStack","pageNextAction":n,"autoForm":!1,"disableAutoFocus":W.isFluent},"actions":{"action":M,"cancel":M,"privacy":g,"tou":f,"impressum":S,"a11yConforme":k,"backStack":[M,D]}},"koreaConsentDataProvision":{"pageId":R.Signup_KoreaConsentDataProvisionPage_Client,"sectionId":"TOUPrivacy","control":"TouPrivacyControl","options":{"viewModel":"SignupViewModel","command":"koreadataprovision","pageBackAction":"backStack","pageNextAction":n,"autoForm":!1,"disableAutoFocus":W.isFluent},"actions":{"action":M,"cancel":M,"privacy":g,"tou":f,"impressum":S,"a11yConforme":k,"backStack":[M,D]}},"chinaPIPLConsent":{"pageId":R.Signup_ChinaPIPLConsent_Client,"sectionId":"ChinaPIPLConsent","control":"SignupCreateControl","options":{"viewModel":"SignupViewModel","pageBackAction":t,"pageNextAction":n,"autoForm":!1,"focusFirstElemId":!0,"focusElemId":"iSignupAction"},"actions":{"action":U,"cancel":o,"privacy":g,"tou":f,"impressum":S,"a11yConforme":k,"retention":h,"dataCollection":v,"dataUse":b,"chinaPIPLConsentLearnMore":F}},"chinaPIPLConsentLearnMore":{"pageId":R.Signup_ChinaPIPLConsent_LearnMore_Client,"sectionId":"ChinaPIPLConsentLearnMore","control":"SignupControl","options":{"viewModel":"SignupViewModel","pageBackAction":"backStack","pageNextAction":n,"autoForm":!1,"disableAutoFocus":W.isFluent},"actions":{"action":D,"cancel":D,"privacy":g,"tou":f,"impressum":S,"a11yConforme":k,"backStack":[D]}},"finalBack":{}}},G.isPaginated||delete W.options.viewDefs.password
}(),function(){var e=window,t=e.wLive,n=t.Account;$PageHelper.onLoad(function(){ko.components.register("convergedTouPrivacy",{"viewModel":function(e){return e},"synchronous":!0,"template":$Config.WLXAccount.signup.strings.convergedTouPrivacyText}),ko.components.register("signupButtons",{"viewModel":function(e){return e=e||{"isBottomMostElement":!1,"showBackButtonOnV2":!1,"showCancelButton":!1},e.styleCancelButtonAsPrimary=e.styleCancelButtonAsPrimary||!1,e.nextButtonText=e.nextButtonText||$Config.WLXAccount.signup.strings.nextButton,e.cancelButtonText=e.cancelButtonText||$Config.WLXAccount.signup.strings.cancelButton,ko.utils.extend(n.ftrViewModelHandle,e)
},"synchronous":!0,"template":'<div class="row">                                <div class="button-container" data-bind="css: {\'no-margin-bottom\': isBottomMostElement }">                                    <div class="col-xs-24" data-bind="visible: buttons.consentCreateButton.visible()">                                        <input type="submit" id="iConsentAction" onclick="OnNext(); return false;" class="btn btn-block win-button btn-primary" data-bind="attr: { disabled: buttons.nextButton.disabled() }, visible: buttons.nextButton.visible(), value: strings.createBtnText" />                                    </div>                                    <!-- ko if: showBackButtonOnV2 -->                                    <div class="inline-block" data-bind="css: { \'col-xs-24\': !buttons.nextButton.visible() || buttons.consentCreateButton.visible() }, visible: buttons.backButton.visible()">                                        <input type="button" id="iSignupCancel" onclick="OnBack(); return false;" class="btn btn-block win-button button-secondary" data-bind="attr: { disabled: buttons.backButton.disabled() }, value: strings.backButton" />                                    </div>                                    <!-- /ko -->                                    <!-- ko if: showCancelButton -->                                    <div class="inline-block" data-bind="css: { \'col-xs-24\': !buttons.nextButton.visible() || buttons.consentCreateButton.visible() }, visible: buttons.cancelButton.visible()">                                        <input type="button" id="SignupCancel" class="btn btn-block win-button" data-bind="attr: { disabled: buttons.cancelButton.disabled() }, value: cancelButtonText, css:{ \'btn-primary\': styleCancelButtonAsPrimary, \'button-secondary\': !styleCancelButtonAsPrimary }" />                                    </div>                                    <!-- /ko -->                                    <div class="inline-block" data-bind="visible: buttons.nextButton.visible() && !buttons.consentCreateButton.visible()">                                        <input type="submit" id="iSignupAction" onclick="OnNext(); return false;" class="btn btn-block win-button btn-primary" data-bind="attr: { disabled: buttons.nextButton.disabled() }, visible: buttons.nextButton.visible(), value: nextButtonText, hasFocus: buttons.nextButton.focused()" />                                    </div>                                </div>                            </div>'}),ko.components.register("fluentButtons",{"viewModel":function(e){return e=e||{"showBackButton":!1,"showCancelButton":!1},e.nextButtonText=e.nextButtonText||$Config.WLXAccount.signup.strings.nextButton,ko.utils.extend(n.ftrViewModelHandle,e)
},"synchronous":!0,"template":'<div class="row">                                <input type="submit" id="iSignupAction" role="button" onclick="OnNext(); return false;" class="button primary" data-bind="visible: buttons.nextButton.visible() && !buttons.consentCreateButton.visible(), attr: { disabled: buttons.nextButton.disabled() }, value: strings.nextButton, hasFocus: buttons.nextButton.focused()" />                                <input type="submit" id="iConsentAction" role="button" onclick="OnNext(); return false;" class="button primary" data-bind="visible: buttons.nextButton.visible() && buttons.consentCreateButton.visible(), attr: { disabled: buttons.nextButton.disabled() }, value: strings.createBtnText" />                                <!-- ko if: showBackButton -->                                <input type="button" id="iSignupCancel" role="button" onclick="OnBack(); return false;" class="button secondary" data-bind="visible: buttons.cancelButton.visible(), attr: { disabled: buttons.backButton.disabled() }, value: strings.backButton" />                                <!-- /ko -->                                <!-- ko if: showCancelButton -->                                <input type="button" id="SignupCancel" role="button" class="button secondary" data-bind="visible: buttons.cancelButton.visible(), attr: { disabled: buttons.cancelButton.disabled() }, value: strings.cancelButton" />                                <!-- /ko -->                            </div>'}),ko.components.register("convergedBanner",{"viewModel":function(e){return e
},"template":'<div class="identityBanner" data-bind="if: memberName && showIdentityBanner, visible: memberName && showIdentityBanner">                           <button type="button" id="iSignupBannerCancel" class="backButton" data-bind="visible: isBackButtonVisible, attr: { \'aria-label\': strings.backButton }" onclick="OnBack(); return false;">                               <img role="presentation" data-bind="attr: { src: arrowImg }" />                           </button>                           <div class="identity" data-bind="text: memberName"></div>                       </div>'}),ko.components.register("fluentBanner",{"viewModel":function(e){return e
},"template":'<!-- ko ifnot: showIdentityBanner -->                            <img class="logo" role="img" data-bind="attr: { src: msLogoImg, alt: strings.msLogoAlt }" />                            <!-- /ko -->                            <!-- ko if: showIdentityBanner -->                            <div class="identityBanner">                               <button type="button" id="iSignupBannerCancel" class="backButton" data-bind="visible: isBackButtonVisible, attr: { \'aria-label\': strings.backButton }" onclick="OnBack(); return false;">                                   <img role="presentation" data-bind="attr: { src: arrowImg }" />                               </button>                               <img class="logo" role="img" data-bind="attr: { src: msLogoImg, alt: strings.msLogoAlt }" />                               <!-- ko if: memberName -->                               <div class="identity">                                   <div class="username" data-bind="text: memberName"></div>                               </div>                               <!-- /ko -->                           </div>                           <!-- /ko -->'})
})}(),function(){function e(e,t){var n={"buttons":{},"text":{}},a={};a.disabled=ko.observable(u),a.visible=ko.observable(!0),a.focused=ko.observable(!1);var o={};o.visible=ko.observable(t&&0===d.noConsentText);var i={};i.disabled=ko.observable(!1),i.visible=ko.observable(!0);var r={};return r.disabled=ko.observable(!1),r.visible=ko.observable(!0),n.buttons.nextButton=a,n.buttons.consentCreateButton=o,n.buttons.backButton=i,n.buttons.cancelButton=r,n.text.visible=ko.computed(function(){return t&&n.buttons.nextButton.visible()
}),n.buttons.visible=ko.computed(function(){return n.buttons.nextButton.visible()||n.buttons.backButton.visible()}),n.additionalLegalText=e,l&&(n.strings=l.strings,n.config=l.page),n}function t(e){var t=!!d.fedStateToken,n=0!==d.pwdlessphone&&e===l.memberNameType.Phone,a=0!==d.pwdlessemail&&e===l.memberNameType.EASI;return!(t||d.showMojangUpgradeExp||n||a)}function n(e){return d.isPaginated&&t(e)}function a(e){var t=!1;if(0!==l.autoVerify){var n=l.viewContext.data;if(n.reporting&&n.reporting.autoVerifyShown){return!1
}if(e&&(e=e.replace(/[^0-9]/g,"")),n.devicePhone){var a=n.devicePhone;$PageHelper.each(a,function(n,a){return a&&a.phoneNumber&&e&&e.indexOf(a.phoneNumber)>=0?(t=!0,!1):void 0})}}return t}function o(e,t){return!c||e.isSwitchingToNext?!0:t||!e.hasValidatedError?!1:!0}var i=window,r=i.wLive,s=i.$Config.WLXAccount,l=s.signup,d=l.page,c=!!d.useNewValidationBehavior,u=1===l.showKoreaConsentView;registerNamespace("wLive.Account.SignupHelper"),r.Account.SignupHelper.createFooterObservable=e,r.Account.SignupHelper.passwordIsRequired=t,r.Account.SignupHelper.paginatedPasswordIsRequired=n,r.Account.SignupHelper.isAutoVerificationSupported=a,r.Account.SignupHelper.shouldValidate=o
}(),function(){var e=window,t=e.wLive,n=e.$DataRequest,a=e.jQuery,o=t.Account,i=o.Extensions.Utils,r=o.FieldHelper,s=o.SignupHelper,l=o.Util&&o.Util.HighContrast,d=null,c=e.MSA&&e.MSA.CXH,u=e.$Config.WLXAccount,p=(u.hip,u.signup),m=p.page,g=p.memberNameType,m=p.page,f={},v={},b={},h={},C={},w={},y=p.signupObservableSets,S=u.hasWin10Behavior,k=u.isWin10,P=u.isWin10InclusiveOOBE,x=u.isXbox,A=!!m.useNewValidationBehavior,I=13,H="onAction",N="credentials",$="koreadatacollection",E="koreadataprovision";$Do.when("ExternalHelper",0,function(){d=e.ExternalHelper
}),defineNamespace("wLive.Account.SignupObservableFactory",{"createObservableSetByPrefillName":function(e,n,a){var o=t.Account.SignupObservableFactory;switch(h=p.strings,C=h.errors,v=p.urls.dataRequest,b=p.apis.dataRequest,w=p.errorCodes,f=p.regex,e){case y.firstName.name:return o.createFirstNameObservableSet(n,a);case y.lastName.name:return o.createLastNameObservableSet(n,a);case y.memberName.name:return o.createMemberNameObservableSet(n,a);case y.usernameRecoverySpeedbump.name:return o.createUsernameRecoverySpeedbumpObservableSet(n,a);
case y.password.name:return o.createPasswordObservableSet(n,a);case y.retypePassword.name:return o.createRetypePasswordObservableSet(n,a);case y.country.name:return o.createCountryObservableSet(n,a);case y.birthdate.name:return o.createBirthdateObservableSet(n,a);case y.birthdateHTML5.name:return o.createBirthdateHTML5ObservableSet(n,a);case y.phoneCountry.name:return o.createPhoneCountryObservableSet(n,a);case y.phoneNumber.name:return o.createPhoneNumberObservableSet(n,a);case y.alternateEmail.name:return o.createAlternateEmailObservableSet(n,a);
case y.hip.name:return o.createHipObservableSet(n,a);case y.hipEnforcement.name:return o.createHipEnforcementObservableSet(n,a);case y.verification.name:return o.createVerificationObservableSet(n,a);case y.fedConfirm.name:return o.createFedConfirmObservableSet(n,a);case y.fedPicker.name:return o.createFedPickerObservableSet(n,a);case y.additionalLegalText.name:return o.createAdditionalLegalTextObservableSet(n,a);case y.optinEmailCheckbox.name:return o.createOptinEmailCheckboxObservableSet(n,a);case y.secondOptinEmailCheckbox.name:return o.createSecondOptinEmailCheckboxObservableSet(n,a);
case y.evictionSpeedbump.name:return o.createEvictionSpeedbumpObservableSet(n,a);case y.evictionSpeedbumpErrorView.name:return o.createEvictionSpeedbumpErrorObservableSet(n,a);case y.hasSeenKoreaDataCollection.name:return o.createKoreaConsentObservableSet(n,a);default:return null}},"createFirstNameObservableSet":function(e,t){var n={};!e&&d&&(e=d.getProperty("PfFirstName"));var a=n.firstName=ko.observable(e||"");a.extend({"required":{"onlyIf":function(){return s.shouldValidate(a)},"params":!0,"message":C.required}}).extend({"notMatchingPattern":{"onlyIf":function(){return s.shouldValidate(a)
},"params":f.ProfileRegex,"message":C.invalidFirstName}});var o=function(){n.firstName.suppressMessages(!1),p.viewContext.data.input[y.firstName.name]=n.firstName()};return n.firstName.suppressMessages=ko.observable(!0),n.firstName.subscribe(o),n.firstName.serverError=t,n.firstName.focused=ko.observable(!1),e&&o(),n},"createLastNameObservableSet":function(e,t){var n={};!e&&d&&(e=d.getProperty("PfLastName"));var a=n.lastName=ko.observable(e||"");a.extend({"required":{"onlyIf":function(){return s.shouldValidate(a)
},"params":!0,"message":C.required}}).extend({"notMatchingPattern":{"onlyIf":function(){return s.shouldValidate(a)},"params":f.ProfileRegex,"message":C.invalidLastName}});var o=function(){n.lastName.suppressMessages(!1),p.viewContext.data.input[y.lastName.name]=n.lastName()};return n.lastName.suppressMessages=ko.observable(!0),n.lastName.subscribe(o),n.lastName.serverError=t,n.lastName.focused=ko.observable(!1),e&&o(),n},"createMemberNameObservableSet":function(t,l){function d(e){if(e&&m.isPaginated&&p.googleFederationDomains&&p.googleFederationDomains.length){var t=(e.split("@")[1]||"").toLowerCase(),n=$PageHelper.indexOf(t,p.googleFederationDomains)>=0;
if(n){return!0}}return!1}var c={},S=0!==m.supportsPhone,I=c.domains=p.domains,H=p.defaultDomain,N="",$="",E=p.viewContext.data.prefill[y.memberName.name],T=p.viewContext.data.prefill[y.country.name],M=!1;c.showCredentialsView=!0,c.showLegalText=!m.isPaginated,T&&(N=T);var B=S?p.memberNameType.Phone:p.memberNameType.EASI;p.isWin10Desktop&&(B=p.memberNameType.EASI);var O=E&&E[g.Live]&&E[g.Live].length>0,L=E&&E[g.EASI]&&E[g.EASI].length>0,D=S&&E&&E[g.Phone]&&E[g.Phone].length>0,F=!O&&!L&&!D,_="Default_Live"===p.fl&&!O,U="Default_EASI"===p.fl&&!L,V="Default_Phone"===p.fl&&!D;
if(t){if($=p.viewContext.data.input.memberNameInput,B=r.getMemberNameType(t,I),B===g.Live){var R=t.split("@");R&&R.length>1&&(H=R[1])}else{S&&B===g.Phone&&(N=p.viewContext.data.input.memberNamePhoneCountry)}}else{if(S&&("Phone"===p.fl||"Always_Default_Phone"===p.fl||"Default_Phone"===p.fl&&(D||F)||D&&(_||U))){B=g.Phone,D&&($=E[g.Phone][0].phoneNumber,N=E[g.Phone][0].country)}else{if("EASI"===p.fl||"Default_EASI"===p.fl&&(L||F)||L&&(_||V)){B=g.EASI,L&&($=E[g.EASI][0].email)}else{if("Live"===p.fl||"Default_Live"===p.fl&&(O||F)||O&&(U||V)){if(B=g.Live,O){var W=E[g.Live][0].email.split("@");
$=W[0],H=W[1]}}else{if("Email"===p.fl){if(B=g.EASI,L){$=E[g.EASI][0].email}else{if(O){B=g.Live;var W=E[g.Live][0].email.split("@");$=W[0],H=W[1]}}}}}}}var q=c.memberNameType=ko.observable(encodeURI(B));p.viewContext.memberNameType=q,q.subscribe(function(){X(""),K("")});var z=c.domain=ko.observable(H||I[0]),G=(c.placeholder=ko.computed(function(){switch(q()){case g.EASI:return h.usernamePlaceholderEASI;case g.Phone:return h.usernamePlaceholderPhone;case g.Live:return h.usernamePlaceholderLive;default:return""
}}),c.memberNameAriaLabel=ko.computed(function(){switch(q()){case g.Phone:return h.ariaLblUsernamePhone;case g.Live:case g.EASI:return h.ariaLblUsernameEmail;default:return""}}),c.xboxMemberNameAriaLabel=ko.computed(function(){switch(q()){case g.Live:return h.xboxLiveLabel;case g.EASI:return h.xboxEasiLabel;default:return""}}),c.emailDomainOptionsMenuAriaLabel=ko.observable(h.emailDomainOptionsMenuAriaLabel),c.cssWin10InclusiveOOBE=ko.computed(function(){return q()===g.Live?"win-textbox win-textarea md padding":q()===g.Phone?"win-textbox md":"win-textbox win-textarea"
}),function(e){var t=p.phoneCountryListJson,n=e||t["default"],a=null;c.memberNamePhoneCountries=t.list;for(var o=0,i=c.memberNamePhoneCountries.length;i>o;o++){if(c.memberNamePhoneCountries[o].iso===n){return c.memberNamePhoneCountries[o]}c.memberNamePhoneCountries[o].iso===t["default"]&&(a=c.memberNamePhoneCountries[o])}return a}),j=c.memberNameInput=ko.observable($||"");"EASI"!==p.fl&&"Live"!==p.fl&&"Phone"!==p.fl&&j.subscribe(function(e){var t=this;if(t.memberNameType()!==g.Phone){var n=r.getMemberNameType(e,t.domains);
if(n===g.EASI){A?(t.switchMemberNameType(g.EASI),j(e)):t.memberNameType(g.EASI)}else{if(n===g.Live){var a=e.split("@");A?(t.switchMemberNameType(g.Live),t.memberNameInput(a[0])):(t.domain(a[1]),t.memberNameInput(a[0]),t.memberNameType(g.Live))}}}else{p.viewContext.data.input[y.verification.name]=""}t.memberNameSuccessMessage(""),t.memberNameExistsMessage("")},c),S&&(c.memberNamePhoneCountryObj=ko.observable(G(N)));var X=c.memberNameSuccessMessage=ko.observable(""),K=c.memberNameExistsMessage=ko.observable(""),Q=c.memberNameSuggestions=ko.observableArray([]),J=c.showSuggestions=ko.observable(!1);
c.onClickSuggestionsLink=function(){var e=Q().length>0;if(e){if($ReportEvent.Fire("Signup_SuggestionClick_UserAction"),"undefined"!=typeof a){var t=a("#CredentialsSuggestionsModal");t.length>0&&t.modal("show")}k&&$PageHelper.byId("MemberNameSuggestions").show(),J(!0),$PageHelper.queryAll("a,button,input[type=button]").not(":hidden").first().focus(),o.ftrViewModelHandle&&(o.ftrViewModelHandle.buttons.backButton.visible(!1),o.ftrViewModelHandle.buttons.nextButton.visible(!1))}},c.setOptionData=function(e,t){ko.applyBindingsToNode(e,{"attr":{"data-value":t.iso}},t)
},c.onPickSuggestion=function(e){if(e){var t=e.split("@");t&&t.length>1&&(j(t[0]),z(t[1])),c.onSuggestionsClose()}},c.onPickProposedMemberNameSuggestion=function(){var e=event.target.text;if(e){var t=e.split("@");t&&t.length>1&&(j(t[0]),z(t[1]))}$PageHelper.byId("MemberName").focus()},c.onSuggestionsClose=function(){if("undefined"!=typeof a&&a("#CredentialsSuggestionsModal").length>0&&a("#CredentialsSuggestionsModal").modal("hide"),J(!1),"iSuggCancel"===event.target.id){var e=$PageHelper.byId("suggLink")}else{e=$PageHelper.byId("MemberName")
}e.focus(),o.ftrViewModelHandle&&(o.ftrViewModelHandle.buttons.backButton.visible(0===m.noAuthCancel),o.ftrViewModelHandle.buttons.nextButton.visible(!0))};var Z=p.viewContext.data.previouslyCheckedMemberName||"",Y=!1,et=function(e,t){e===g.Live?X(C.memberNameAvailable.format(t)):e===g.EASI&&X(C.memberNameAvailableEasi)},tt=function(e,t,n,a,o,i,r,s){var l=C.memberNameTaken,c=C.memberNameTakenNoSugg,u="",f="",v=P||x||e===w.membernameTakenEasi;p.displaySignInLinkInMnError&&0!==p.displaySignInLinkInMnError||p.autoRedirToSignInOnMnTakenError?(p.signinUrl=$Utility.addQueryString(p.signinUrl,"username",t||""),l=C.memberNameTaken.format(t,p.signinUrl),u=C.memberNameTakenEasi.format(t,p.signinUrl),f=C.memberNameTakenPhone.format(t,p.signinUrl)):(u=C.memberNameTakenEasi.format(t),f=C.memberNameTakenPhone.format(t));
var b=null;switch(e){case w.domainExistsInAad:b={"isValid":!1,"message":C.domainExistsInAad.format("domainExistsInAadSwitchToOutlook")};break;case w.domainExistsInAadSupportedLogin:b={"isValid":!1,"message":C.domainExistsInAadSupportedLogin.format(t)};break;case w.domainIsReserved:case w.domainNotAllowed:b={"isValid":!1,"message":C.domainNotAllowed};break;case w.signupBlocked:b={"isValid":!1,"message":C.signupBlocked.format(t)};break;case w.invalidEmailFormat:b={"isValid":!1,"message":C.invalidEmailFormat};break;
case w.invalidPhoneFormat:b={"isValid":!1,"message":C.invalidPhoneFormat};break;case w.invalidMemberNameFormat:b={"isValid":!1,"message":S&&q()===g.Phone?C.invalidPhoneFormat:C.invalidEmailFormat};break;case w.membernameTaken:case w.membernameTakenEasi:if(p.autoRedirToSignInOnMnTakenError){return $Utility.navigateTo(p.signinUrl),!0}b={"isValid":!1,"message":v?u:o?l:c};break;case w.membernameTakenPhone:b=S?{"isValid":!1,"message":f}:{"isValid":!1,"message":l}}if(b){return A&&(p.viewContext.data.previousCheckAvailResult=b),b
}if(0===e){if(n===!1){return b=a===g.Live?{"isValid":!1,"message":v?u:o?l:c}:{"isValid":!1,"message":u},A&&(p.viewContext.data.previousCheckAvailResult=b),b}p.showUsernameRecoverySpeedbump&&i&&(p.viewContext.data.shouldGoToUsernameRecoverySpeedbump=!0,p.viewContext.data.shouldGoToUsernameRecoverySpeedbumpForPreviouslyCheckedMemberName=!0),p.isEvictionSpeedbumpEnabled&&r&&(p.viewContext.data.shouldGoToEvictionSpeedbump=!0,p.viewContext.data.shouldGoToEvictionSpeedbumpForPreviouslyCheckedMemberName=!0,p.viewContext.data.isNoPaAllowedOnEvictedMemberName=s,s||(m.pwdless=m.pwdlessemail=0)),d(t)&&(p.viewContext.data.shouldGoToFedSignInSpeedbump=!0,p.viewContext.data.shouldGoToFedSignInSpeedbumpForPreviouslyCheckedMemberName=!0),p.viewContext.data.checkAvailStateMap||(p.viewContext.data.checkAvailStateMap=[]),p.viewContext.data.checkAvailStateMap.push(t+":"+r)
}return b={"isValid":!0,"message":""},A&&(p.viewContext.data.previousCheckAvailResult=b),b},nt=ko.computed(function(){var e=this,t=e.memberNameInput();return e.memberNameType()===g.Live?t+"@"+e.domain():S&&e.memberNameType()===g.Phone?"+"+c.memberNamePhoneCountryObj().code+t:t},c);nt.extend({"required":{"onlyIf":function(){return s.shouldValidate(nt)},"params":!0,"message":C.emailRequired}}).extend({"validation":{"onlyIf":function(){return s.shouldValidate(nt)&&q()===g.Live},"validator":function(){return j()
},"message":C.emailRequired}}).extend({"liveMemberNameValid":{"onlyIf":function(){return s.shouldValidate(nt)},"params":{"domains":I,"patterns":[f.LiveMembernameRegex]},"message":C.invalidEmailFormat}}).extend({"memberNameValidForFl":{"onlyIf":function(){return s.shouldValidate(nt)},"params":{"fl":p.fl,"domains":I},"message":C.domainNotAllowed}}).extend({"validation":{"onlyIf":function(){return s.shouldValidate(nt)&&q()===g.EASI},"validator":function(e){return e.match(f.MembernameRegex)},"message":C.invalidEmailFormat}}).extend({"validation":{"onlyIf":function(){return s.shouldValidate(nt)&&S&&q()===g.Phone&&j()
},"validator":function(e){return e.match(f.PhoneNumberFormat)},"message":C.invalidPhoneFormat}}).extend({"validation":{"onlyIf":function(){return s.shouldValidate(nt)&&S&&q()===g.Phone&&!j()},"validator":function(e){return e.match(/ /)},"message":C.phoneRequired}}).extend({"pattern":{"onlyIf":function(){return s.shouldValidate(nt)&&q()===g.Live},"params":"^[a-zA-Z]","message":C.emailMustStartWithLetter}}).extend({"validation":{"onlyIf":function(){var e=(s.shouldValidate(nt)||p.isCombinedSISUV2)&&p.viewContext.data.prefill.checkServerSideCache&&(q()===g.EASI&&L||q()===g.Phone&&D);
return e||(Y=!1),e},"validator":function(t){var a=p.viewContext.data.prefill[y.memberName.name];for(index=0;index<a[q()].length;++index){if(prefill=a[q()][index],prefill.phoneNumber&&prefill.countryCode&&"+"+prefill.countryCode+prefill.phoneNumber==t||prefill.email&&prefill.email==t||prefill===t){if(Z!=t&&(p.viewContext.data.reporting.memberNameChangeCount++,prefill.isAvailable?p.viewContext.data.reporting.memberNameAvailableCount++:p.viewContext.data.reporting.memberNameUnavailableCount++,!p.noCheckavail)){var o={"signInName":t,"uaid":e.$Config.uaid,"skipBECall":!0,"isAvailableOnServerCache":prefill.isAvailable,"isEasiCheck":!0};
n.Json(null,$Utility.generateUrl(u.urls.baseDomain,v.checkAvailable,!0),o,null,null)}if(p.viewContext.data.previouslyCheckedMemberName=Z=t,prefill.isAvailable){return et(q(),t),i.setFocusOnObservable(nt,!0),Y=!0,p.prefillMembernameIsPossiblyEvicted&&(p.viewContext.data.shouldGoToEvictionSpeedbumpForPreviouslyCheckedMemberName=!0,p.viewContext.data.isNoPaAllowedOnEvictedMemberName=p.prefillMembernameIsNopaAllowed,p.prefillMembernameIsNopaAllowed||(m.pwdless=m.pwdlessemail=0)),p.prefillMembernameIsProof&&(p.viewContext.data.shouldGoToUsernameRecoverySpeedbumpForPreviouslyCheckedMemberName=!0),p.viewContext.data.shouldGoToFedSignInSpeedbumpForPreviouslyCheckedMemberName=d(Z),p.viewContext.data.checkAvailStateMap||(p.viewContext.data.checkAvailStateMap=[]),p.viewContext.data.checkAvailStateMap.push(t+":"+p.prefillMembernameIsPossiblyEvicted),!0
}if(prefill.errorCode){var r=tt(prefill.errorCode,t);if(r){return this.message=r.message,i.setFocusOnObservable(nt,!1),Y=!0,r.isValid}}break}}return Y=!1,!0},"message":""}}),m.isPaginated&&$&&nt.isValid()&&!p.page.isMojangUpgrade&&!l&&(D&&!E[g.Phone][0].errorCode&&$==E[g.Phone][0].phoneNumber||L&&!E[g.EASI][0].errorCode&&$==E[g.EASI][0].email||O&&!E[g.Live][0].errorCode&&$==E[g.Live][0].email.split("@")[0])?(p.isCombinedSISUV2&&(c.showCredentialsView=!1),c.showPaginatedUsernamePrefill=!0,c.paginatedUsernamePrefill=nt()):c.showPaginatedUsernamePrefill=!1,A&&nt.extend({"validation":{"onlyIf":function(){return p.viewContext.data.previouslyCheckedMemberName===nt()&&p.viewContext.data.previousCheckAvailResult&&!p.viewContext.data.previousCheckAvailResult.isValid
},"validator":function(){return this.message=p.viewContext.data.previousCheckAvailResult.message,!1},"message":""}}),nt.extend({"checkAvailable":{"onlyIf":function(){var e=!F&&!p.viewContext.data.hasCheckAvailableCalled,t=(e||s.shouldValidate(nt,!0))&&!!j()&&Z!==nt()&&!Y&&!p.noCheckavail;return!nt||A&&!nt.isSwitchingToNext||(p.viewContext.data.previouslyCheckedMemberName=Z=nt()),!t&&Z?(p.viewContext.data.shouldGoToEvictionSpeedbump=p.viewContext.data.shouldGoToEvictionSpeedbumpForPreviouslyCheckedMemberName,p.viewContext.data.shouldGoToUsernameRecoverySpeedbump=p.viewContext.data.shouldGoToUsernameRecoverySpeedbumpForPreviouslyCheckedMemberName,p.viewContext.data.shouldGoToFedSignInSpeedbump=p.viewContext.data.shouldGoToFedSignInSpeedbumpForPreviouslyCheckedMemberName):(p.viewContext.data.shouldGoToUsernameRecoverySpeedbumpForPreviouslyCheckedMemberName=!1,p.viewContext.data.shouldGoToEvictionSpeedbumpForPreviouslyCheckedMemberName=!1,p.viewContext.data.shouldGoToFedSignInSpeedbumpForPreviouslyCheckedMemberName=!1,A&&(p.viewContext.data.shouldGoToUsernameRecoverySpeedbump=!1,p.viewContext.data.shouldGoToEvictionSpeedbump=!1,p.viewContext.data.shouldGoToFedSignInSpeedbump=!1)),t&&(p.viewContext.data.hasCheckAvailableCalled=!0),t
},"params":{"url":{"url":$Utility.generateUrl(u.urls.baseDomain,v.checkAvailable,!0),"apiId":b.checkAvailableApiId},"observable":nt,"getSuggestedMemberNames":function(e){Q(e)},"setSuccessMessage":et,"getResult":tt,"includeSuggestions":!0,"message":C.checkAvailableFail}}});var at=function(){p.viewContext.data.input[y.memberName.name]=nt(),p.viewContext.data.input.memberNameInput=j(),p.viewContext.data.input.memberNameType=q(),p.viewContext.data.input.isMemberNameVerified=M,S&&(K(""),p.viewContext.data.input.memberNamePhoneCountry=c.memberNamePhoneCountryObj().iso,p.viewContext.data.input.memberNamePhoneCountryCode=c.memberNamePhoneCountryObj().code)
};return at(),nt.subscribe(function(e){c.memberName.suppressMessages(!1),at(),c.memberName.previousValue(e)}),nt.previousValue=ko.observable(""),nt.suppressMessages=ko.observable(!c.memberNameInput()),nt.serverError=l,nt.focused=ko.observable(!1),c.memberName=nt,c.isCountryCodeDropDownFocused=ko.observable(!1),c.isLiveDomainDropDownFocused=ko.observable(!1),c.domainDropdownClick=function(e){nt.isValidating()||z(e)},c.clickLearnMore=function(){var e=this;e.trigger("memberNameTakenLearnMore")},c.phoneSwitchFocused=ko.observable(!1),c.easiSwitchFocused=ko.observable(!1),c.liveSwitchFocused=ko.observable(!1),c.switchMemberNameType=function(t){var n=g,a=q(),o=e.$Telemetry;
if(!nt.isValidating()&&t!==a){o&&t&&o.appendClientEvent("Account_Signup_"+t,t),p.viewContext.data.previouslyCheckedMemberName=Z=null;var i=I.indexOf(j().split("@")[1]),r=i>=0?I[i]:I[0];if(t===n.Live){if(j(""),q(t),z(r),O){var s=E[g.Live][0].email.split("@");j(s[0]),z(s[1])}}else{if(t===n.EASI){if(0!==m.pwdlessemail){var l=window.wLive.Account.viewModelHandle;l&&l.password&&l.password("")}j(L?E[n.EASI][0].email:""),q(t),z(r)}else{if(S&&t===n.Phone){if(0!==m.pwdless){var l=window.wLive.Account.viewModelHandle;
l&&l.password&&l.password("")}j(D?E[n.Phone][0].phoneNumber:""),q(t),z(r)}else{t||(q()===n.Phone?c.switchMemberNameType(n.EASI):q()===n.EASI?c.switchMemberNameType(n.Live):q()===n.Live&&c.switchMemberNameType(S?n.Phone:n.EASI))}}}nt.suppressMessages(!j()),S&&t===n.Phone?c.isCountryCodeDropDownFocused(!0):nt.focused(!0)}},c.memberNameInputType=ko.computed(function(){return $B&&$B.IE&&$B.V&&$B.V<=8?"text":S&&q()===g.Phone?"tel":q()===g.EASI?"email":"text"}),c.liveEasiSwitchText=ko.computed(function(){return q()===g.Live?h.easiSwitch:h.liveSwitch
}),c.memberNamePrefill=ko.computed(function(){return E?E[q()]:null}),c.prefillSelected=function(e){S&&e&&e.phoneNumber?(c.memberNameInput(e.phoneNumber),c.memberNamePhoneCountryObj(G(e.country))):e&&e.email&&c.memberNameInput(e.email)},c.domainSelected=function(e){c.domain(e),nt.suppressMessages(!j()),nt.focused(!0)},c.shouldGoToPasswordPage=ko.computed(function(){return s.paginatedPasswordIsRequired(q())}),c.shouldCollectPassword=ko.pureComputed(function(){return s.passwordIsRequired(q())}),c},"createUsernameRecoverySpeedbumpObservableSet":function(){var e={},t=p.viewContext.data.input,n=t.memberName||p.prefillProofMembername,a=t.memberNameType||r.getMemberNameType(p.prefillProofMembername,p.domains,p.fedProvider);
p.prefillMembernameIsProof&&(t.memberName=t.memberNameInput=n,t.memberNameType=a,a===g.Phone&&(t.memberNameInput=p.prefillProofMembernameInput,t.memberNamePhoneCountry=p.prefillProofMemberNamePhoneCountry,t.memberName="+"+n)),e.usernameRecoverySpeedbumpDesc=h.usernameRecoverySpeedbumpDesc.format(n),n=n.replace("+","");var o=$Utility.addQueryString(h.usernameRecoverySpeedbumpRecoveryLinkUrl,"mn",n);return o=o.replace("prefillUserName",encodeURI(n)),e.recoverUsernameUrl=o,e.usernameRecoverySpeedbumpRecoveryLink=p.usernameRecoverySpeedbumpRecoveryLink=p.usernameRecoverySpeedbumpRecoveryLink.replace("#",o),e.shouldGoToFedSignInSpeedbump=p.viewContext.data.shouldGoToFedSignInSpeedbump,e.shouldGoToPasswordPage=!e.shouldGoToFedSignInSpeedbump&&s.paginatedPasswordIsRequired(a),e
},"createPasswordObservableSet":function(t,n){var a={};if(m.isMojangUpgrade&&!m.showMojangUpgradeExp){var i=p.viewContext.data.input;p.viewContext.data.prefill.memberName.EASI?i.memberName=i.memberNameInput=p.viewContext.data.prefill.memberName.EASI[0].email:p.viewContext.data.prefill.memberName.Live&&(i.memberName=i.memberNameInput=p.viewContext.data.prefill.memberName.Live[0].email)}var l=o.viewModelHandle||{},d=ko.computed(function(){return l.memberName&&l.memberName()||p.viewContext.data.input.memberName
});a.hiddenMemberName=d;{var c=ko.computed(function(){return p.viewContext.memberNameType&&p.viewContext.memberNameType()||r.getMemberNameType(d(),p.domains)}),b=ko.observable(!1);a.showPassword=ko.observable(!1)}a.showCapsWarning=ko.computed(function(){return!a.showPassword()&&b()&&!m.shouldSuppressCapsLockWarning}),a.showPasswordPeek=p.showPasswordPeek,a.showPasswordLabel=ko.observable(h.showPasswordLabel),a.onPasswordKeyUp=function(e,t){var n=t.originalEvent||t;return b(n.getModifierState("CapsLock")),!0},a.skipPasswordValidation=ko.computed(function(){return n?!0:m.fedStateToken?!0:0!==m.pwdless?c()===g.Phone||0!==m.pwdlessemail&&c()===g.EASI:!1
}),a.oobePasswordDescText=ko.computed(function(){return P?h.memberNamePasswordDesc.format(d()):h.passwordDesc});var w=ko.observable(t||"");return w.extend({"required":{"onlyIf":function(){return s.shouldValidate(w)&&!a.skipPasswordValidation()},"params":!0,"message":C.passwordRequired},"minLength":{"onlyIf":function(){return s.shouldValidate(w)&&!a.skipPasswordValidation()},"params":8,"message":C.passwordTooSimple},"pattern":{"onlyIf":function(){return s.shouldValidate(w)&&!a.skipPasswordValidation()},"params":f.PwdValidInput,"message":C.passwordInvalidChar},"pwdComplexity":{"onlyIf":function(){return s.shouldValidate(w)&&!a.skipPasswordValidation()
},"params":!0,"message":C.passwordTooSimple},"pwdContainsMemberName":{"onlyIf":function(){return s.shouldValidate(w)&&!a.skipPasswordValidation()},"params":!0,"message":function(){return c()===g.Phone?C.pwdContainsMnPhone:C.pwdContainsMnEmail}},"validation":{"onlyIf":function(){return x&&s.shouldValidate(w)&&!a.skipPasswordValidation()},"validator":function(e){var t=p.viewContext&&p.viewContext.data&&p.viewContext.data.input?p.viewContext.data.input[y.firstName.name]:"",n=p.viewContext&&p.viewContext.data&&p.viewContext.data.input?p.viewContext.data.input[y.lastName.name]:"";
return-1===e.toLowerCase().indexOf(t.toLowerCase())&&-1===e.toLowerCase().indexOf(n.toLowerCase())},"message":C.pwdContainsMnEmail}}),0!==p.noBPCheck||a.skipPasswordValidation()?w.isValidating=ko.observable(!1):w.extend({"bannedPwd":{"onlyIf":function(){var e=s.shouldValidate(w,!0)&&w()&&p.viewContext.data.previouslyCheckedPassword!=w();return e&&(p.viewContext.data.previouslyCheckedPassword=w()),e},"params":{"url":$Utility.generateUrl(u.urls.baseDomain,v.bannedPwd,!0),"ski":SKI||"","observable":w},"message":C.bannedPassword}}),w.subscribe(function(t){if(a.password.suppressMessages(!1),p.viewContext.data.input[y.password.name]=t,S){var n=e.MSA&&e.MSA.CXH;
n&&n.encryptUserDataAsync(t,function(e){n.propertyBagSetAsync("encPwd",e)})}}),w.suppressMessages=ko.observable(!0),w.serverError=n,n=null,w.focused=ko.observable(!1),a.password=w,a.showMarketingOptIn=m.isPaginated&&p.showOptinEmail&&c()===g.Live,a.showSecondMarketingOptIn=m.isPaginated&&p.showSecondOptinEmail&&c()===g.Live,a.showLegalText=m.isPaginated&&c()===g.Live,a.shouldShowSmsDisclaimer=c()===g.Phone,a},"createRetypePasswordObservableSet":function(e){var t={},n=ko.observable(e||"");return n.extend({"required":{"params":s.shouldValidate(n),"message":C.required},"equal":{"onlyIf":function(){return s.shouldValidate(n)&&p.viewContext.data.input[y.password.name]
},"params":p.viewContext.data.input[y.password.name],"message":C.passwordNotMatch}}),n.focused=ko.observable(!1),n.suppressMessages=ko.observable(!0),n.subscribe(function(){t.retypePassword.suppressMessages(!1)}),t.retypePassword=n,n.subscribe(function(e){t.retypePassword.suppressMessages(!1),p.viewContext.data.input[y.retypePassword.name]=e}),t},"createCountryObservableSet":function(e){var t={},n=ko.observable(e||"");n.subscribe(function(e){t.country.suppressMessages(!1),p.viewContext.data.input[y.country.name]=e
}),n.suppressMessages=ko.observable(!0),n.focused=ko.observable(!1),t.country=n;t.countries=p.countryList,t.showBirthDate=ko.computed(function(){var e=this.country(),t=p.countryDetailMap,n=t&&t[e]?t[e].childAge:0,a=t&&0!==n||0!==p.dobReq;return A&&(p.viewContext.data.shouldCollectBirthDate=a),a},t);return t},"createBirthdateObservableSet":function(e){var t=function(e){var t=[],n=document.createElement("div");n.innerHTML="<select>"+e+"</select>";for(var a=0;a<n.firstChild.options.length;a++){var o=n.firstChild.options[a];
t.push({"text":o.text,"value":o.value})}return t};e=e||"";var n=this,a={},o=m.fedNamesPrefill;o&&1===o.length&&n.setMemberNameInputFromFedNameIfNeeded(o[0]);var i="",r="",s="",l=e.split(":");3===l.length&&(i=l[0],r=l[1],s=l[2]);m.useSameViewForYobAccrual;a.datePartOptions0=ko.observableArray(t($Config.WLXAccount.signup.page.datePartDropDown0)),a.datePartOptions1=ko.observableArray(t($Config.WLXAccount.signup.page.datePartDropDown1)),a.datePartOptions2=ko.observableArray(t($Config.WLXAccount.signup.page.datePartDropDown2)),a.birthYear=ko.observable(s),a.birthMonth=ko.observable(r.replace(/^0/,"")),a.birthDay=ko.observable(i.replace(/^0/,"")),a.birthdate=ko.computed(function(){var e=this,t=e.birthDay(),n=e.birthMonth(),a=e.birthYear();
return t=1===t.length?"0"+t:t,n=1===n.length?"0"+n:n,t+":"+n+":"+a},a),a.birthYear.suppressMessages=ko.observable(!0),a.birthMonth.suppressMessages=ko.observable(!0),a.birthDay.suppressMessages=ko.observable(!0),a.birthdate.subscribe(function(e){(!A||p.viewContext.data.shouldCollectBirthDate||$Config.WLXAccount.isXbox)&&(p.viewContext.data.input[y.birthdate.name]=e)}),a.birthYear.subscribe(function(){a.birthYear.suppressMessages(!1)}),a.birthMonth.subscribe(function(){a.birthMonth.suppressMessages(!1)}),a.birthDay.subscribe(function(){a.birthDay.suppressMessages(!1)
}),a.birthdate.suppressMessages=ko.computed({"read":function(){var e=this;return e.birthYear.suppressMessages()||e.birthMonth.suppressMessages()||e.birthDay.suppressMessages()},"write":function(e){var t=this;t.birthYear.suppressMessages(e),t.birthMonth.suppressMessages(e),t.birthDay.suppressMessages(e)},"owner":a}),a.birthdate.focused=ko.observable(!1);var d=m.dateOrder.toUpperCase();return a.birthdateParts=new Array(3),a.birthdateParts[d.indexOf("D")]=a.birthDay,a.birthdateParts[d.indexOf("M")]=a.birthMonth,a.birthdateParts[d.indexOf("Y")]=a.birthYear,a.dateOrderCaps=d,a.showLegalText=m.isMojangUpgrade,a
},"createBirthdateHTML5ObservableSet":function(e){e=e||"";var t={},n=ko.observable(e).extend({"required":{"params":!0,"message":C.required}});return n.extend({"validation":{"validator":function(e){var t=e.split("-");if(3===t.length){var n=new Date(t[0],t[1],t[2]),a=new Date;return!isNaN(n)&&a>n}return!1},"message":C.invalidBirthDate}}),n.subscribe(function(e){if(t.birthdateHTML5.suppressMessages(!1),e){var n=e.split("-");if(3===n.length){var a=n[2]+":"+n[1]+":"+n[0];p.viewContext.data.input[y.birthdate.name]=a,p.viewContext.data.input[y.birthdateHTML5.name]=e
}}}),n.suppressMessages=ko.observable(!0),n.focused=ko.observable(!1),t.birthdateHTML5=n,t},"createPhoneCountryObservableSet":function(e){var t=p.phoneCountryListJson,n=t["default"]||"",a=function(e){for(var t=p.phoneCountryListJson,n=e||t["default"],a=null,o=t.list,i=0,r=o.length;r>i;i++){if(o[i].iso===n){return o[i]}o[i].iso===t["default"]&&(a=o[i])}return a};k&&(n=p.viewContext.data.input[y.country.name]||"");var o=ko.observable(e||n);return p.viewContext.data.input[y.phoneCountry.name]=o(),o.subscribe(function(e){p.viewContext.data.input[y.phoneCountry.name]=e
}),{"phoneCountries":t.list,"phoneCountry":o,"defaultCountryObject":a(e)}},"createPhoneNumberObservableSet":function(e){var t={},n=ko.observable(e||"");return n.extend({"onePattern":{"onlyIf":function(){return s.shouldValidate(n)&&n&&n()},"params":[f.PhoneNumberFormat],"message":C.invalidPhoneFormat},"required":{"onlyIf":function(){if(x){return!0}var e=window.wLive.Account.viewModelHandle,t=e&&e.memberName&&e.memberName()?e.memberName():p.viewContext.data.input.memberName,a=r.getMemberNameType(t,p.domains),o=e&&e.alternateEmail&&Boolean(e.alternateEmail().match(f.AltEmailRegEx));
return s.shouldValidate(n)&&e&&a===g.Live&&!o},"message":C.phoneRequired}}),n.subscribe(function(e){t.phoneNumber.suppressMessages(!1),p.viewContext.data.input[y.phoneNumber.name]=e}),n.suppressMessages=ko.observable(!0),n.focused=ko.observable(!1),t.phoneNumber=n,t},"createAlternateEmailObservableSet":function(e,t){var n={},a=ko.observable(e||"");return a.extend({"allPatterns":{"onlyIf":function(){return s.shouldValidate(a)&&a&&a()&&(a.isVisible()||x)},"params":[f.AltEmailRegEx],"message":C.invalidEmailFormat},"required":{"onlyIf":function(){if(x){return!0
}var e=window.wLive.Account.viewModelHandle,t=e&&e.memberName&&e.memberName()?e.memberName():p.viewContext.data.input.memberName,n=r.getMemberNameType(t,p.domains);return s.shouldValidate(a)&&e&&n===g.Live&&(!e.phoneNumber||!e.phoneNumber())},"message":C.emailRequired},"validation":{"onlyIf":function(){return x},"validator":function(e){var t=p.viewContext&&p.viewContext.data&&p.viewContext.data.input?p.viewContext.data.input[y.memberName.name]:"";return e.toLowerCase()!==t.toLowerCase()},"message":C.altEmailContainsMn}}),a.subscribe(function(e){n.alternateEmail.suppressMessages(!1),p.viewContext.data.input[y.alternateEmail.name]=e
}),a.suppressMessages=ko.observable(!0),a.serverError=t,a.focused=ko.observable(!1),a.isVisible=ko.observable(!!t||p.isWin10HostOOBEDesktop&&!p.viewContext.data.input[y.phoneNumber.name]||p.viewContext.data.input[y.alternateEmail.name]&&!p.viewContext.data.input[y.phoneNumber.name]),n.alternateEmail=a,setTimeout(function(){a.isVisible()&&document.getElementById("ProofType")?document.getElementById("ProofType").value="email":document.getElementById("ProofType")&&(document.getElementById("ProofType").value="phone")
},0),n.switchProofType=function(){var e=$PageHelper.byId("ProofType").val();"email"===e?(n.alternateEmail.isVisible(!0),n.alternateEmail.focused(!0)):(n.alternateEmail.isVisible(!1),n.alternateEmail.focused(!1))},n},"createHipObservableSet":function(){var t={},n=e.HIPAMFE;if(n&&n.observable){return n.observable}var a=ko.observable("").extend({"hipValidation":{}});return a.subscribe(function(){e.HIPAMFE;t.hip.suppressMessages(!1),t.hip.isModified(!0)}),a.suppressMessages=ko.observable(!0),a.focused=ko.observable(!1),a.focused.extend({"notify":"always"}),t.hip=a,t
},"createHipEnforcementObservableSet":function(){var e={};return e.hipEnforcement=ko.observable(!0),e},"createVerificationObservableSet":function(e,t){var n={},a=n.verification=ko.observable(e||"");a.extend({"required":{"onlyIf":function(){return s.shouldValidate(a)&&!p.skipCodeValidation},"params":!0,"message":C.required},"pattern":{"onlyIf":function(){return s.shouldValidate(a)&&!p.skipCodeValidation},"params":$Config.isINT?f.verificationCodeInt:f.verificationCode,"message":C.oneTimeCodeInvalidFormat}});var i=p.viewContext.data.input.memberName,r=p.viewContext.data.input.memberNameType;
return n.verification.terminalState=ko.observable(!0),n.verification.serverError=t,n.verification.focused=ko.observable(!1),n.verification.suppressMessages=ko.observable(!0),n.verifyTimeout=null,n.startTimestamp=(new Date).getTime(),n.showAutoVerificationUI=ko.observable(!1),n.showSmsResendCodeText=r==g.Phone,n.showMarketingOptIn=(m.isPaginated||p.isWin10HostOOBEDesktop)&&0!==p.showOptinEmail&&r==g.EASI,n.showSecondMarketingOptIn=m.isPaginated&&0!==p.showSecondOptinEmail&&r==g.EASI,n.showLegalText=(m.isPaginated||p.isWin10HostOOBEDesktop||P&&r!==g.EASI)&&!m.fedStateToken,ko.isObservable(n.memberName)?n.memberName(i):n.memberName=ko.observable(i),n.showAutoVerificationUI.subscribe(function(e){d&&d.setWizardButtons&&d.setWizardButtons(!e,!e,!1),o.ftrViewModelHandle&&(o.ftrViewModelHandle.buttons.backButton.disabled(e),o.ftrViewModelHandle.buttons.nextButton.disabled(e)),p.viewContext.data.input.autoVerify=e
}),n.showAutoVerificationUI(s.isAutoVerificationSupported(p.viewContext.data.input.memberNameInput)),a.subscribe(function(e){var t=$PageHelper.trim(e);a(t),a.suppressMessages(!1),p.viewContext.data.input[y.verification.name]=t}),n.doAutoVerify=function(){var e=this;if(n.showAutoVerificationUI()){p.viewContext.data.reporting.autoVerifyShown=!0,o.ftrViewModelHandle&&(o.ftrViewModelHandle.buttons.backButton.disabled(!0),o.ftrViewModelHandle.buttons.nextButton.disabled(!0));var t=d.getProperty("SmsCode");if(k&&c){try{c.getVerificationCode(function(t){n.onCodeSuccess(t,e)
},function(e){c.logError(e),n.onVerifyFailed()})}catch(a){c.logError(a),n.onVerifyFailed()}}else{n.onCodeSuccess(t,e)}}},n.stopAutoVerify=function(){null!=n.verifyTimeout&&(clearTimeout(n.verifyTimeout),n.verifyTimeout=null),d.setWizardButtons(!0,!0,!1),o.ftrViewModelHandle&&(o.ftrViewModelHandle.buttons.backButton.disabled(!1),o.ftrViewModelHandle.buttons.nextButton.disabled(!1))},n.onVerifyFailed=function(e){var t=e&&e.error,a=this;a._viewContext.data.serverErrors||(a._viewContext.data.serverErrors={}),t&&e.error.code===w.maximumOTTDailyError?a._viewContext.data.serverErrors[y.memberName.name]=C.verificationThrottled:0!==p.autoVerify?(n.stopAutoVerify(),a._viewContext.data.serverErrors[y.memberName.name]=C.autoVerificationFailed):a._viewContext.data.serverErrors[y.memberName.name]=C.generic,a.$.triggerHandler(H,{"actionName":N,"control":a})
},n.onCodeSuccess=function(e,t){if("string"==typeof e){"-1"==e?n.onVerifyFailed():(n.verification(e),t.handleActionButton())}else{var a=(new Date).getTime()-n.startTimestamp;a>p.sendOttTimeout?(n.stopAutoVerify(),n.showAutoVerificationUI(!1)):n.verifyTimeout=setTimeout($PageHelper.proxy(n.doAutoVerify,t),100)}},n.verificationSubTitle=ko.computed(function(){return(m.isPaginated||m.verifyProofEasiOptional)&&r==g.EASI?h.verifyPageDescEASI.format(i):h.verificationSubTitle.format(i)}),n.verifyPageTitle=ko.computed(function(){return m.isPaginated||P?r===g.Phone?h.verifyPageTitlePhone:h.verifyPageTitleEASI:h.lblVerificationCode
}),n},"createFedConfirmObservableSet":function(){var e=this,t={},n=m.fedNamesPrefill,a=p.viewContext.data.input;n&&1===n.length&&e.setMemberNameInputFromFedNameIfNeeded(n[0]);var o=a.memberName;return t.fedConfirmPageDesc=h.fedConfirmPageDesc.format(o.encodeHtml()),t.fedConfirmPageDesc2=(h.fedConfirmPageDesc2||"").format(o.encodeHtml()),t.showLegalText=!0,t},"createFedPickerObservableSet":function(){function e(e){e?(n[y.memberName.name]=e.name,n.memberNameType=r.getMemberNameType(e.name,p.domains),n.isMemberNameVerified=1===e.isVerified,n.memberNameInput=n.memberNameType===g.Live?e.name.split("@")[0]:e.name):(delete n[y.memberName.name],delete n.isMemberNameVerified,delete n.memberNameType,delete n.isMemberNameVerified),OnNext()
}var t={},n=p.viewContext.data.input,a=l.getHighContrastImageUrl(m.imgs.baseUrl,m.imgs.fedProviderLogo,{"forBlackBackground":m.imgs.fedProviderLogoWhite});return t.fedProviderLogoImg=a,t.fedNamesPrefill=m.fedNamesPrefill,t.onPrefillClicked=function(t){e(t)},t.onPrefillKeyDown=function(t,n){return n=n||window.event,"Enter"===n.code||n.keyCode===I?(n.preventDefault?n.preventDefault():n.returnValue=!1,e(t),!1):!0},t.onUseOtherClick=function(){e(null)},t.shouldGoToPasswordPage=ko.computed(function(){return s.paginatedPasswordIsRequired(n.memberNameType)
}),setTimeout(function(){o.ftrViewModelHandle&&o.ftrViewModelHandle.buttons.nextButton.visible(!1)},0),t},"createAdditionalLegalTextObservableSet":function(){var e={};return e.additionalLegalText=ko.computed(function(){return h.frenchLegalText?h.frenchLegalText:void 0}),e},"createOptinEmailCheckboxObservableSet":function(e){var t={},n=ko.observable(e||"");return n.subscribe(function(e){t.optinEmailCheckbox.suppressMessages(!1),p.viewContext.data.input[y.optinEmailCheckbox.name]=e}),n.suppressMessages=ko.observable(!0),n.focused=ko.observable(!1),t.optinEmailCheckbox=n,t
},"createSecondOptinEmailCheckboxObservableSet":function(e){var t={},n=ko.observable(e||"");return n.subscribe(function(e){t.secondOptinEmailCheckbox.suppressMessages(!1),p.viewContext.data.input[y.secondOptinEmailCheckbox.name]=e}),n.suppressMessages=ko.observable(!0),n.focused=ko.observable(!1),t.secondOptinEmailCheckbox=n,t},"createEvictionSpeedbumpObservableSet":function(){var e={},t=p.viewContext.data.input,n=t.memberName||p.prefillPossibleEvictionMembername,a=$Utility.addQueryString(p.evictionSigninURL,"username",encodeURI(n)||"");
return p.prefillMembernameIsPossiblyEvicted&&!P&&(t.memberNameInput=p.prefillPossibleEvictionMembernameInput,t.memberNamePhoneCountry=p.prefillPossibleEvictionMemberNamePhoneCountry,t.memberName="+"+n,p.viewContext.data.isNoPaAllowedOnEvictedMemberName=p.prefillMembernameIsNopaAllowed,p.prefillMembernameIsNopaAllowed||(m.pwdless=m.pwdlessemail=0),p.viewContext.data.checkAvailStateMap||(p.viewContext.data.checkAvailStateMap=[]),p.viewContext.data.checkAvailStateMap.push(n+":true")),p.viewContext.data.evictionWarningShown||(p.viewContext.data.evictionWarningShown=[]),p.viewContext.data.evictionWarningShown.push(n),e.evictionSpeedbumpTopDesc=h.evictionSpeedbumpTopDesc.format(n),e.evictionSpeedbumpBottomDesc=h.evictionSpeedbumpBottomDesc,e.evictionSpeedbumpSignInUrl=a,e.shouldGoToPasswordPage=s.paginatedPasswordIsRequired(p.memberNameType.Phone)||!p.viewContext.data.isNoPaAllowedOnEvictedMemberName,e
},"createEvictionSpeedbumpErrorObservableSet":function(){var e={};return e.evictionSpeedbumpErrorPageDescription=h.evictionSpeedbumpErrorPageDescription,e},"createKoreaConsentObservableSet":function(){var e={},t=p.viewContext.data,n=!!t[$],a=!!t[E];e.hasSeenKoreaDataCollection=ko.observable(n),e.hasSeenKoreaDataProvision=ko.observable(a);var o=m.imgs&&m.imgs.koreaConsent;return e.koreLegalReadCheckMarkImg=o&&o.koreLegalReadCheckMarkImg,e.koreLegalUnReadCheckMarkImg=o&&o.koreLegalUnReadCheckMarkImg,e.koreDataCollectionLearnMoreFocused=!1,e.koreDataProvisionLearnMoreFocused=!1,e.koreDataMarketLearnMoreFocused=!1,n?a||(e.koreDataProvisionLearnMoreFocused=!0):e.koreDataCollectionLearnMoreFocused=!0,e
},"setMemberNameInputFromFedNameIfNeeded":function(e){var t=p.viewContext.data.input;t.memberName||(t.memberName=e.name,t.memberNameType=r.getMemberNameType(e.name,p.domains),t.isMemberNameVerified=1===e.isVerified,t.memberNameInput=t.memberNameType===g.Live?e.name.split("@")[0]:e.name)}})}(),function(){var e=window,t=e.wLive,n=t.Account,a=n.SignupObservableFactory,o=n.Util&&n.Util.HighContrast,i=e.$Config.WLXAccount,r=i.signup,s=r.page,l={},d={},c=!i.isWin10&&!i.isWin10InclusiveOOBE;defineClass("wLive.Account.ViewModels.SignupViewModel",function(e,t,i){var u=this,p=e.data,m=p.input||{},g=p.serverErrors||{},f=a.createObservableSetByPrefillName,v=u._observables=[];
t&&t.observables&&(v=u._observables=t.observables),u._viewContext=e,u.trigger=(i||{}).trigger,l=r.strings,d=l.errors;var b=v.length;u.validationOrder=new Array(b);for(var h=0;b>h;h++){var C=v[h];mix(u,f(C,m[C],g[C])),u.validationOrder[h]=u[C]}if(mix(u,{"strings":l,"config":s}),c){var w=$PageHelper.byId("Spinner");if(w.length>0){var y={"$Utility":$Utility,"config":s,"strings":l};ko.cleanNode(w[0]),ko.applyBindings(y,w[0])}}n.ftrViewModelHandle=u.footerViewModel=n.SignupHelper.createFooterObservable(u.additionalLegalText,u.showLegalText);
var S=$PageHelper.byId("maincontent")[0];if(S){var k=ko.dataFor(S);k&&$PageHelper.byId("identityBanner").length>0&&k.memberName(m.memberName)}var P=$PageHelper.byId("ftr");if(P.length>0&&(ko.cleanNode(P[0]),ko.applyBindings(n.ftrViewModelHandle,P[0])),u.birthdate){if(0!==r.dobCheck&&0===r.dobReq){var x=r.countryDetailMap;u.birthdate.extend({"birthdatePartRequired":{"onlyIf":function(){return x&&x[u.country()]&&0!==x[u.country()].childAge},"params":!0,"message":d.required},"birthdateValid":{"onlyIf":function(){return x&&x[u.country()]&&0!==x[u.country()].childAge
},"params":!0,"message":d.invalidBirthDate}})}else{u.birthdate.extend({"birthdatePartRequired":{"params":!0,"message":d.required},"birthdateValid":{"params":!0,"message":d.invalidBirthDate}})}u.birthdate.isValid()||(u.birthDay(""),u.birthMonth(""),u.birthYear(""))}if(s&&s.imgs){var A=o.getHighContrastImageUrl(s.imgs.baseUrl,s.imgs.msLogo,{"forBlackBackground":s.imgs.msLogoWhite});u.msLogoImg=A;var I=o.getHighContrastImageUrl(s.imgs.baseUrl,s.imgs.dropdownCaret,{"forBlackBackground":s.imgs.dropdownCaretWhite});
u.dropdownCaretImg=I}u.initErrorGroup()},{"validationOrder":null,"errors":null,"isValid":null,"_viewContext":null,"_observables":null,"initErrorGroup":function(){var e=this;e.errors=ko.validation.group(e.validationOrder),e.errors.showAllMessages(!1),e.isValid=function(){return e.errors().length>0?!1:e._viewContext.hasAttemptedSubmit?!e.getFirstError():!0}},"notifyAllSubscribers":function(){var e=this;$PageHelper.each(e.validationOrder,function(e,t){t&&t.suppressMessages&&t.suppressMessages(!1),t&&t.notifySubscribers&&(s.useNewValidationBehavior?ko.isComputed(t)?t.notifySubscribers(t.peek()):ko.isObservable(t)&&t.valueHasMutated():t()||t.notifySubscribers())
})},"validation":function(){var e=this,t=[];return $PageHelper.each(e.validationOrder,function(e,n){t.push(n&&n.isValidating?n.validation():null)}),t},"showError":function(e){var t=this;return!e.suppressMessages()||t._viewContext.hasAttemptedSubmit?e.isValid&&!e.isValid()||e.isModified&&!e.isModified()&&e.serverError:e.serverError},"getFirstError":function(){var e=this,t=null;return $PageHelper.each(e.validationOrder,function(e,n){return n&&n.isValid&&!n.isValid()||n&&n.isModified&&!n.isModified()&&n.serverError?(t=n,!1):!0
}),t},"placeholderVisible":function(e){return!e},"isPlaceholderSupported":function(){return"placeholder"in document.createElement("input")},"reportUserAction":function(e){$ReportEvent.Fire(e)},"isSwitchingToNext":function(e){var t=this;$PageHelper.each(t.validationOrder,function(t,n){n&&(n.isSwitchingToNext=e)})},"hasValidatedError":function(e){var t=this;$PageHelper.each(t.validationOrder,function(t,n){n&&(n.hasValidatedError=e)})}})}(),function(){var e=window,t=e.wLive,n=t.Account,a=n.Controls,o=null,i=e.$Config.WLXAccount,r=i.signup,s={},l=e.MSA&&e.MSA.CXH,d="onAction",c="onShow",u="onHide",p="onSetupEvents",m="onRemoveEvents",g="onDispose",f="koreadatacollection",v="koreadataprovision",b="koreadatamarket";
$Do.when("ExternalHelper",0,function(){o=e.ExternalHelper}),defineClass("wLive.Account.Controls.TouPrivacyControl",function(e,t,n){var o=this;o.$=$PageHelper.get(o),o._$container=e,o._viewContext=t,o._options=n;var i=o._pageDialogControl=new a.PageDialogControl(e,t,n);o._$pageDialogControl=i.$,t.data||(t.data={}),s=r.strings},{"_pageDialogControl":null,"_$pageDialogControl":null,"_viewContext":null,"_options":null,"$":null,"dispose":function(){},"show":function(){var e=this;e._setupDialogEvents(),e._pageDialogControl&&e._pageDialogControl.show()
},"hide":function(){var e=this;e._pageDialogControl&&e._pageDialogControl.hide(),e._removeDialogEvents()},"pageReady":function(){if(o){var e=document.getElementsByClassName("wpBluePage");o.setProperty("FrameWidth",parseInt(e[0]&&e[0].clientWidth).toString()),o.setProperty("FrameHeight",parseInt(e[0]&&e[0].clientHeight).toString()),o.ready()}},"notifyVisible":function(){this.pageReady()},"_prepareAccessibleHtml":function(e){var t='<p id="agreementTitle" tabindex="-1">',n='<p tabindex="-1">',a="</p>",o=/(?:\r\n|\r|\n)/g,i=new RegExp(n+a,"g"),r=t+e+a;
return r=r.replace(o,a+n),r=r.replace(i,"")},"_setupDialogEvents":function(){var e=this,t=e._$pageDialogControl;if(t){var n=e._pageDialogControl.events;t.on(n.action,$PageHelper.proxy(e._processDialogActionEvent,e)),t.on(n.setupEvents,$PageHelper.proxy(e._processDialogSetupEvent,e)),t.on(n.removeEvents,$PageHelper.proxy(e._processDialogRemoveEvent,e)),t.on(n.show,$PageHelper.proxy(e._processDialogShowEvent,e)),t.on(n.hide,$PageHelper.proxy(e._processDialogHideEvent,e))}},"_removeDialogEvents":function(){var e=this,t=e._$pageDialogControl;
if(t){var n=e._pageDialogControl.events;t.off(n.action),t.off(n.setupEvents),t.off(n.removeEvents),t.off(n.show),t.off(n.hide)}},"_processDialogActionEvent":function(e,t){this.$.triggerHandler(d,{"actionName":t.actionName,"control":this}),e&&(e.preventDefault(),e.stopPropagation())},"inclusiveOOBEAlternateBack":function(){this.$.triggerHandler(d,{"actionName":"alternate","control":this})},"_processDialogSetupEvent":function(e,t){var a=this;if(a.$.triggerHandler(p,{"content":t.content,"control":a}),n.ftrViewModelHandle&&(n.ftrViewModelHandle.buttons.backButton.visible(!0),n.ftrViewModelHandle.buttons.nextButton.visible(!1)),i.signup.isFluent){var o=$PageHelper.byId("maincontent")[0];
if(o&&$PageHelper.byId("identityBanner").length>0){var r=ko.dataFor(o);r&&(r.isBackButtonVisible(n.ftrViewModelHandle.buttons.backButton.visible()),r.showIdentityBanner(!0))}}i.isWin10InclusiveOOBE&&l&&(l.showBackButton(!0),a._viewContext.data.input&&"Phone"===a._viewContext.data.input.memberNameType?($PageHelper.byId("TOUPrivacyAlternate").show(),$PageHelper.byId("TOUPrivacyCancel").hide(),l.handleBackButton(a.inclusiveOOBEAlternateBack.bind(a))):l.handleBackButton(a.inclusiveOOBECancelBack.bind(a))),$PageHelper.byClassName("tou").on("click",function(){a.$.triggerHandler(d,{"actionName":"tou","control":a})
}),$PageHelper.byClassName("privacy").on("click",function(){a.$.triggerHandler(d,{"actionName":"privacy","control":a})}),$PageHelper.byClassName("pdc").on("click",function(){a.$.triggerHandler(d,{"actionName":"dataCollection","control":a})}),$PageHelper.byClassName("upd").on("click",function(){a.$.triggerHandler(d,{"actionName":"dataUse","control":a})}),$PageHelper.byClassName("rp").on("click",function(){a.$.triggerHandler(d,{"actionName":"retention","control":a})})},"_processDialogRemoveEvent":function(e,t){this.$.triggerHandler(m,{"content":t.content,"control":this})
},"inclusiveOOBECancelBack":function(){this.$.triggerHandler(d,{"actionName":"cancel","control":this})},"_processDialogShowEvent":function(e,t){var n=this,a=t.content,o=n._options,l=o.queryUrl?o.queryUrl:$Utility.generateUrl(i.urls.baseDomain,r.urls.queryUrl,!0),u=o.isPrivacy,p=o.command||(u?"privacy":"tou"),m=n._viewContext.data=n._viewContext.data||{},g=m[p],h=$PageHelper.byTagName("pre",a).length>0?$PageHelper.byTagName("pre",a):$PageHelper.byId("TOUPrivacyDiv",a),C=$PageHelper.byId("TOUPrivacyHeader",a),w=$PageHelper.byId($PageHelper.byId("touBackBtn").length>0?"touBackBtn":"TOUPrivacyCancel"),y=u?s.privacyHeader:s.touHeader;
g?(w.removeClass("hidden"),h.html(g),C.text(y),i.signup.isFluent?$PageHelper.byClassName("backButton").first().focus():w.first().focus()):l&&$PageHelper.post({"url":l,"data":{"command":p},"context":n,"success":function(e){var t=p===f||p===v||p===b;if(e){if(i.isXbox){t?(h.html(e),m[p]=e):h.text(e),h.each(function(e,t){new WinJS.UI.ScrollViewer(t)})}else{var a,o;t?a=e:(o=String(e).encodeHtml(),a=n._prepareAccessibleHtml(o)),h.html(a),m[p]=a,w.removeClass("hidden")}C.text(y)}},"error":function(){n.$.triggerHandler(d,{"actionName":"cancel","control":n})
},"complete":function(){i.signup.isFluent?$PageHelper.byClassName("backButton").first().focus():w.first().focus()}}),h.attr("data-command",p),n.$.triggerHandler(c,{"content":a,"control":n})},"_processDialogHideEvent":function(e,t){this.$.triggerHandler(u,{"content":t.content,"control":this})},"events":{"action":d,"show":c,"hide":u,"setupEvents":p,"removeEvents":m,"dispose":g}},{})}(),function(){var e=window,t=e.wLive,n=(e.jQuery,t.Account),a=n.Controls,o=(n.UrlHelper,n.ViewModels,n.AnimationHelper,n.Util.HighContrast),i=(n.Util.ImageHelper,null),r=n.SignupHelper,s=e.$Config.WLXAccount,l=s.hip,d=l&&l.enforcement,c=s.signup,u=c.page,p=c.regex,m={},g=(c.signupObservableSets,1===c.showKoreaConsentView),f={},v=e.MSA&&e.MSA.CXH,b=s.isWin10,h=s.isWin10InclusiveOOBE,C=s.isXbox,w=!!u.useNewValidationBehavior,y="action",S="cancel",k="alternate",P="skip",x="credentials",A="password",I="usernameRecoverySpeedbump",H="evictionSpeedbump",N="fedSignInSpeedbump",$="onAction",E="onShow",T="onHide",M="onSetupEvents",B="onRemoveEvents",O="onDispose",L="enforcement",D="koreadatacollection",F="koreadataprovision",_="ChinaPIPLConsent",U="ChinaPIPLConsentLearnMore",V="Signup_ChinaPIPLConsent_UserAction",R="Accept",W="Decline",q=0;
$Do.when("ExternalHelper",0,function(){i=e.ExternalHelper}),defineClass("wLive.Account.Controls.SignupControl",function(e,t,n){var o=this;o.$=$PageHelper.get(o),o._$container=e,o._viewContext=t,o._options=n;var i=o._pageDialogControl=new a.PageDialogControl(e,t,n);o._$pageDialogControl=i.$,o._sectionId=n.sectionId,t.data||(t.data={}),f=c.strings,m=c.urls.dataRequest},{"_pageDialogControl":null,"_$pageDialogControl":null,"_viewContext":null,"_$container":null,"_verifyTimeout":null,"_options":null,"$":null,"dispose":function(){},"show":function(){var e=this;
e._setupDialogEvents(),e._pageDialogControl&&(e._pageDialogControl.show(),e._setIdentityBannerVisibility(!0),e._setNextButtonVisibility())},"hide":function(){var e=this;e._pageDialogControl&&(e._pageDialogControl.hide(),e._setIdentityBannerVisibility(!1)),e._removeDialogEvents()},"pageReady":function(){if(i){var e=document.getElementById("maincontent");i.setProperty("FrameWidth",parseInt(e&&e.clientWidth).toString()),i.setProperty("FrameHeight",parseInt(e&&e.clientHeight).toString()),i.ready()}},"notifyVisible":function(){this.pageReady()
},"handleActionButton":function(){this.$.triggerHandler($,{"actionName":y,"control":this})},"IsChild":function(e,t){var n=!1,a=c.countryDetailMap,o=a&&a[t]?a[t].childAge:0;if(t&&e&&0!==o){var i="",r="",s="",l=e.split(":");3===l.length&&(i=parseInt(l[0]),r=parseInt(l[1]),s=parseInt(l[2]));var d=new Date,u=new Date(s+o,r,i);n=u>d}return n},"setEnabled":function(e){var t=this,a=t._sectionId,o="KoreaPrivacyConsent"===a,r=c.viewContext.data,s=!(!r[D]||!r[F]);if(i&&i.setWizardButtons(e,e,!1),n.ftrViewModelHandle&&(o?(n.ftrViewModelHandle.buttons.backButton.disabled(!e),n.ftrViewModelHandle.buttons.nextButton.disabled(!e||!s),n.ftrViewModelHandle.buttons.nextButton.focused(!!s)):(n.ftrViewModelHandle.buttons.backButton.disabled(!e),n.ftrViewModelHandle.buttons.nextButton.disabled(!e),n.ftrViewModelHandle.buttons.cancelButton.disabled(!e))),(h||C||b)&&o){if(t._pageDialogControl&&t._pageDialogControl.setEnabledStateForEachButton(e,e&&s,e,e),b&&s){var l=$PageHelper.byId("KoreaPrivacyConsentAction");
l&&l.focus()}}else{t._pageDialogControl&&t._pageDialogControl.setEnabled(e)}},"_setupDialogEvents":function(){var e=this,t=e._$pageDialogControl;if(t){var n=e._pageDialogControl.events;t.on(n.action,$PageHelper.proxy(e._processDialogActionEvent,e)),t.on(n.setupEvents,$PageHelper.proxy(e._processDialogSetupEvent,e)),t.on(n.removeEvents,$PageHelper.proxy(e._processDialogRemoveEvent,e)),t.on(n.show,$PageHelper.proxy(e._processDialogShowEvent,e)),t.on(n.hide,$PageHelper.proxy(e._processDialogHideEvent,e))}},"_removeDialogEvents":function(){var e=this,t=e._$pageDialogControl;
if(t){var n=e._pageDialogControl.events;t.off(n.action),t.off(n.setupEvents),t.off(n.removeEvents),t.off(n.show),t.off(n.hide)}},"_processDialogActionEvent":function(t,a){{var o=this,i=o._options,r=a.viewModel,s=a.actionName,d=o._viewContext.data||{},p=d.input||{},m=o._options&&o._options.optInEmailId,g=o._options&&o._options.secondOptinEmailId;e&&e.$Telemetry}if(o.setEnabled(!1),$PageHelper.get(document.activeElement).blur(),m){var f=$PageHelper.byId(m,o._$container);f&&f.length>0&&(o._viewContext.persistedOptOutEmailSelection=!f.prop("checked"))
}if(g){var v=$PageHelper.byId(g,o._$container);v&&v.length>0&&(o._viewContext.persistedSecondOptOutEmailSelection=!v.prop("checked"))}if(s===y&&this._sectionId===_){return $Do.when("$Telemetry",function(){var t=e.$Telemetry;t.appendClientEvent(V,R),t.post(!0,V)}),o._viewContext.data.isUserConsentedToChinaPIPL=!0,void o.$.triggerHandler($,{"actionName":y,"control":o})}if(s===S&&this._sectionId===_&&$Do.when("$Telemetry",function(){var t=e.$Telemetry;t.appendClientEvent(V,W),t.post(!0,V)}),r&&s===y&&(b?(r._observables.indexOf("alternateEmail")>=0||r._observables.indexOf("hip")>=0)&&r.notifyAllSubscribers():(w&&r.isSwitchingToNext(!0),r.notifyAllSubscribers())),t&&(t.preventDefault(),t.stopPropagation()),s!==y&&s!==P&&s!==k){return(r&&r.password&&("cancel"===s||"backStack"===s)&&!d.shouldGoToFedSignInSpeedbump||"FedSignInSpeedbump"===i.sectionId&&d.shouldGoToFedSignInSpeedbump)&&c.isCombinedSISUV2&&(s="finalBack"),void o.$.triggerHandler($,{"actionName":s,"control":o})
}var E=r&&r.validation()||[];$PageHelper.when(E).then(function(){if(w&&r.isSwitchingToNext(!1),r&&!r.isValid()){return o._focusFirstError(r),void(w&&r.hasValidatedError(!0))}if(s===P){return r&&r.isValid()?void o.$.triggerHandler($,{"actionName":P,"control":o}):void o.setEnabled(!0)}if(s===k){var e=n.FieldHelper.getMemberNameType(p.memberName,c.domains);return r&&r.birthdateHTML5&&h&&e===c.memberNameType.EASI&&u.verifyProofEasiOptional?void o.$.triggerHandler($,{"actionName":P,"control":o}):void o.$.triggerHandler($,{"actionName":k,"control":o})
}if(r&&r.memberName){if(r.memberNameInput&&c.viewContext.data.shouldGoToUsernameRecoverySpeedbump){return void o.$.triggerHandler($,{"actionName":I,"control":o})}if(r.memberNameInput&&c.viewContext.data.shouldGoToEvictionSpeedbump){return void o.$.triggerHandler($,{"actionName":H,"control":o})}if(r.memberNameInput&&c.viewContext.data.shouldGoToFedSignInSpeedbump){return void o.$.triggerHandler($,{"actionName":N,"control":o})}if(r.shouldGoToPasswordPage&&r.shouldGoToPasswordPage()){return void o.$.triggerHandler($,{"actionName":A,"control":o})
}}if(r&&r.evictionSpeedbumpTopDesc&&r.shouldGoToPasswordPage){return void o.$.triggerHandler($,{"actionName":A,"control":o})}if(r&&r.usernameRecoverySpeedbumpDesc){if(r.shouldGoToPasswordPage){return void o.$.triggerHandler($,{"actionName":A,"control":o})}if(r.shouldGoToFedSignInSpeedbump){return void o.$.triggerHandler($,{"actionName":N,"control":o})}}if(r&&r.fedNamesPrefill&&!p.memberName){return void o.$.triggerHandler($,{"actionName":x,"control":o})}if(r&&r.birthdate&&u.isMojangUpgrade&&o.IsChild(p.birthdate,p.country)){return c.isUpgradeChildSpeedbumpEnabled?void o.$.triggerHandler($,{"actionName":"upgradeChildSpeedbump","control":o}):void o.$.triggerHandler($,{"actionName":"childBlock","control":o})
}if(r&&r.birthdate&&C&&c.shouldSkipProofCollection&&o.IsChild(p.birthdate,p.country)){return void o.$.triggerHandler($,{"actionName":"preferences","control":o})}if(C&&r&&r.optinEmailCheckbox&&c.isOtsFlow){return l.enforcementRequired=!0,void o.$.triggerHandler($,{"actionName":"hipEnforcement","control":o})}var e=n.FieldHelper.getMemberNameType(p.memberName,c.domains);return r&&r.birthdate&&c.isWin10HostOOBEDesktop&&e===c.memberNameType.Live?void o.$.triggerHandler($,{"actionName":"proofCollection","control":o}):void o.handleActionButton()
})},"inclusiveOOBEAlternateBack":function(){this.$.triggerHandler($,{"actionName":"alternate","control":this})},"_setIdentityBannerVisibility":function(e){var t=$PageHelper.byId("maincontent")[0];if(t&&$PageHelper.byId("identityBanner").length>0){var a=ko.dataFor(t);a&&(this._options.showIdentityBanner&&e?(a.isBackButtonVisible(n.ftrViewModelHandle.buttons.backButton.visible()),a.showIdentityBanner(!0)):a.showIdentityBanner(!1))}},"_setNextButtonVisibility":function(){var e=this,t=e._sectionId,a=t===U;a&&n.ftrViewModelHandle.buttons.nextButton.visible(!1)
},"_logAndSkipProofVerification":function(){$Do.when("$Telemetry",function(){var t=e.$Telemetry;t.appendClientEvent("Account_Signup_Easi_ProofVerificationSkipPressed","Easi_Skip_ProofVerification")}),c.skipCodeValidation=!0},"_processDialogSetupEvent":function(t,a){var i=this,r=a.content,d=a.viewModel,m=i._options,w=d&&d.onClickSuggestionsLink,y=i._viewContext.data||{},S=y.input||{},k=!!u.fedStateToken,P=k&&u.fedNamesPrefill&&1===u.fedNamesPrefill.length,x=k&&u.fedNamesPrefill&&u.fedNamesPrefill.length>1,I=e&&e.$Telemetry;
if(n.ftrViewModelHandle){var H=g&&d&&d.hasSeenKoreaDataCollection&&d.hasSeenKoreaDataProvision,E=!g&&d&&d.memberName&&d.showSuggestions&&!d.showSuggestions()&&!x&&!u.showMojangUpgradeSpeedbump,T=!g&&d&&d.password&&c.isCombinedSISUV2&&!y.shouldGoToFedSignInSpeedbump,B=!g&&d&&(d.fedConfirmPageDesc||d.birthdateParts)&&"cancel"===m.pageBackAction&&P,O=!g&&d&&d.fedNamesPrefill&&x,L=!g&&"FedSignInSpeedbump"===m.sectionId&&c.isCombinedSISUV2&&y.shouldGoToFedSignInSpeedbump,D=0!==u.noAuthCancel&&(E||T||B||O||L||H);D=D||!g&&c.prefillMembernameIsProof&&d.usernameRecoverySpeedbumpDesc&&!u.showMojangUpgradeExp&&!u.showMojangUpgradeSpeedbump,D=D||!g&&c.prefillMembernameIsPossiblyEvicted&&d.evictionSpeedbumpTopDesc,D=D||!g&&u.isMojangUpgrade&&!u.showMojangUpgradeSpeedbump&&!u.showMojangUpgradeExp&&!c.prefillMembernameIsProof&&d.password,n.ftrViewModelHandle.buttons.backButton.visible(!D)
}$PageHelper.byClassName("tou").on("click",function(){i.$.triggerHandler($,{"actionName":"tou","control":i})}),$PageHelper.byClassName("privacy").on("click",function(){i.$.triggerHandler($,{"actionName":"privacy","control":i})}),$PageHelper.byClassName("pdc").on("click",function(){i.$.triggerHandler($,{"actionName":"dataCollection","control":i})}),$PageHelper.byClassName("upd").on("click",function(){i.$.triggerHandler($,{"actionName":"dataUse","control":i})}),$PageHelper.byClassName("rp").on("click",function(){i.$.triggerHandler($,{"actionName":"retention","control":i})
});var F=$PageHelper.byId("koreaConsentDataCollectionLearnMore"),U=$PageHelper.byId("koreaConsentDataProvisionLearnMore");F&&F.on("click",function(){i.$.triggerHandler($,{"actionName":"koreaConsentDataCollection","control":i})}),U&&U.on("click",function(){i.$.triggerHandler($,{"actionName":"koreaConsentDataProvision","control":i})});var R=$PageHelper.byId("piplLearnMore");if(R&&R.on("click",function(){i.$.triggerHandler($,{"actionName":"chinaPIPLConsentLearnMore","control":i})}),$PageHelper.byId("iProofSignIn").on("click",function(){return $Utility.navigateTo(c.usernameRecoverySpeedbumpSignInUrl),!1
}),$PageHelper.byId("iSignupAction").on("click",function(){return OnNext(),!1}),$PageHelper.byId("SignupCancel").on("click",function(){if(m.sectionId===_&&I){$Do.when("$Telemetry",function(){I.appendClientEvent(V,W),I.post(!0,V)}),i.$.triggerHandler($,{"actionName":"cancel","control":i})}else{if(u.verifyProofEasiOptional){return i._logAndSkipProofVerification(),OnNext(),!1}i.$.triggerHandler($,{"actionName":"cancel","control":i})}}),$PageHelper.byId("VerificationAlternate").on("click",function(){return $PageHelper.byId("VerificationAlternate").attr("disabled","disabled"),i._logAndSkipProofVerification(),OnNext(),!1
}),$PageHelper.byId("iFederationSignIn").on("click",function(){var e=$Utility.addQueryString(c.googleFederationSignInUrl,"username",S.memberNameInput);return $Utility.navigateTo(e),!1}),$PageHelper.byId("EvictionNext").on("click",function(){var e=$Utility.addQueryString(c.evictionSigninURL,"username",S.memberNameInput);return $Utility.navigateTo(e),!1}),r.on("click","#iSignIn",function(){$ReportEvent.Fire("Signup_SignIn_UserAction")}),1001!==$Config.uiflvr&&($PageHelper.byId("impressumLink").attr("href","#").on("click",function(){i.$.triggerHandler($,{"actionName":"impressum","control":i})
}),$PageHelper.byId("a11yConformeLink").attr("href","#").on("click",function(){i.$.triggerHandler($,{"actionName":"a11yConforme","control":i})})),$PageHelper.byId("atlas").length>0&&c.urls&&c.urls.atlas&&c.urls.atlas.signupStart&&$PageHelper.createShim("img").attr("src",c.urls.atlas&&c.urls.atlas.signupStart).appendTo($PageHelper.byId("atlas")),$PageHelper.byId("LocalAccount").length>0&&r.on("click","#LocalAccount",function(){i.$.triggerHandler($,{"actionName":"localAccount","control":i})}),$PageHelper.byId("learnMore").length>0&&r.on("click","#learnMore",function(){v.getContext(function(e){var t="FRX"===(e.host?e.host.toUpperCase():"");
t?($PageHelper.byId("LearnMoreFlyoutContent").html(c.learnMoreContent),$PageHelper.byId("HelpText").show(),$PageHelper.byId("HelpClose").focus()):i.$.triggerHandler($,{"actionName":"learnMore","control":i})})}),$PageHelper.byId("LearnMoreContent").length>0&&$PageHelper.byId("LearnMoreContent").html(c.learnMoreContent),$PageHelper.byId("HelpClose").length>0&&r.on("click","#HelpClose",function(){$PageHelper.byId("HelpText").hide()}),c.getDeviceTicket&&v.postDeviceTicketToUrl(c.originalUrl,c.signupAuthPolicy),(b||h)&&(r.on("mouseup",function(e){var t=$PageHelper.byId("MemberNameSuggestions");
$PageHelper.visible(t)&&!t.is(e.target)&&0===t.has(e.target).length&&t.hide();var n=$PageHelper.byId("HelpText");$PageHelper.visible(n)&&!n.is(e.target)&&0===n.has(e.target).length&&n.hide()}),!c.learnMoreContent&&c.urls.queryUrl&&$PageHelper.post($Utility.generateUrl(s.urls.baseDomain,c.urls.queryUrl,!0),{"command":"win10learnmore"},function(e){if(e){var t=$PageHelper.parseJSON(e);t&&(c.learnMoreContent=t.html)}},"html"),$PageHelper.byId("Proofs").length>0&&(c.fss&&c.fss.memberRole===c.fss.userRole?($PageHelper.byId("ProofsHeading").text(f.proofs.familychildheader),$PageHelper.byId("ProofsDesc").text(f.proofs.familychilddesc)):c.fss&&c.fss.memberRole===c.fss.adminRole?$PageHelper.byId("ProofsDesc").text(f.proofs.familydesc):i.IsChild(S.birthdate,S.country)&&($PageHelper.byId("ProofsHeading").text(f.proofs.childheader),$PageHelper.byId("ProofsDesc").text(f.proofs.childdesc))),$PageHelper.visible($PageHelper.byId("PreferencesAction"))&&(S.memberNameInput.indexOf("@")>-1?$PageHelper.byId("PreferencesCancel").show():S.memberNameInput.match(p.PhoneNumberFormat)?$PageHelper.byId("PhoneVerification").show():($PageHelper.byId("PreferencesAlternate").show(),s.isWin10InclusiveOOBE&&v&&v.handleBackButton(i.inclusiveOOBEAlternateBack.bind(i)))),$PageHelper.visible($PageHelper.byId("PasswordAction"))&&c.viewContext.data.shouldGoToEvictionSpeedbump&&v.handleBackButton(i.inclusiveOOBEAlternateBack.bind(i))),C){var q=$PageHelper.byId("Preferences");
q&&q.length>0&&(i.IsChild(S.birthdate,S.country)&&($PageHelper.byId("iOptinEmail").prop("checked",!1),$PageHelper.byId("emailPref").hide(),i._viewContext.hideOptinCheckboxForChild=!0),c.showUserTile&&i._setupUserTile(S.memberNameInput,S.firstName,S.lastName))}if(c.isCombinedSISUV2&&d&&d.showPaginatedUsernamePrefill&&d.paginatedUsernamePrefill&&(S.memberName=d.paginatedUsernamePrefill,y.shouldGoToFedSignInSpeedbump?i.$.triggerHandler($,{"actionName":N,"control":i}):i.$.triggerHandler($,{"actionName":A,"control":i})),d&&d.verification){var z=n.FieldHelper.getMemberNameType(S.memberName,c.domains),G=c.channel.sms,j="undefined"==typeof c.resendCodeTimeout?6e4:c.resendCodeTimeout,X=j||4e3,K=$PageHelper.byId("resendCodeText"),Q=$PageHelper.byId("resendCodeLink",K);
if(z===c.memberNameType.EASI){G=c.channel.email;var J=$PageHelper.byId("resendCodeLink");J.on("click",function(){i._sendOTT(G),$PageHelper.byId("VerificationCode").focus(),$ReportEvent.Fire("Signup_ResendCode_UserAction")})}K.delay(j).fadeIn(500),Q.on("click",function(){i._sendOTT(G),$PageHelper.byId("VerificationCode").focus(),K.hide(),$ReportEvent.Fire("Signup_ResendCode_UserAction"),K.delay(X).fadeIn(500)}),S.lastEnteredMemberName!==S.memberNameInput&&(S.lastEnteredMemberName=S.memberNameInput,i._sendOTT(G))
}var Z=$PageHelper.byId("MemberNamePrefill");Z.length>0&&Z.parent().on("show.bs.dropdown",function(){Z.width(Z.parents("div .col-md-8").first().width())});var Y=$PageHelper.byClassName("dropdown");if(Y.length>0){var et=$PageHelper.byId("domainLabel",Y);Y.on("show.bs.dropdown",function(){et.attr("aria-label",f.hideEmailDomainOptions)}),Y.on("hide.bs.dropdown",function(){et.attr("aria-label",f.showEmailDomainOptions)}),$Utility.isHighContrast()&&(et.css("border-top-width","1px"),et.css("border-left-width","1px"),et.css("border-right-width","1px"))
}if(l.required||l.requiredOnSendOTT?$PageHelper.byId("hipTemplateContainer",a.content).length>0&&(n.FieldHelper.loadHip(),$PageHelper.byId("hipSection").show()):l.enforcementRequired||l.enforcementRequiredOnSendOTT?$PageHelper.byId("hipEnforcementContainer",a.content).length>0&&n.FieldHelper.loadEnforcementHip(c.signUpHipEnforcementPageId):$PageHelper.byId("hipSection").hide(),w&&r.on("click","#suggLink",w),i._viewContext.hasAttemptedSubmit&&d&&!d.isValid()){var tt=d.getFirstError();tt.suppressMessages(!1),tt.focused(!0)
}$PageHelper.byTagName("body").on("click","#domainExistsInAadSwitchToOutlook",function(){n.viewModelHandle.switchMemberNameType("Live")});var nt=$PageHelper.byId("GoogleLogoImage");if(nt.length>0){var at=o.getHighContrastImageUrl(u.imgs.baseUrl,u.imgs.fedSignInWithGoogle,{"forBlackBackground":u.imgs.fedSignInWithGoogleWhite});nt.attr("src",at)}var ot=$PageHelper.byId("UpgradeChildSpeedbumpImg");if(ot.length>0){var it=o.getHighContrastImage(c.upgradeChildSpeedbumpImgUrl,{"forBlackBackground":c.upgradeChildSpeedbumpImgUrlWhite});
ot.attr("src",it)}i.$.triggerHandler(M,{"content":r,"control":i})},"_processDialogRemoveEvent":function(e,t){var a=this,o=a._viewContext.data||{},i=(o.input||{},t.content),r=n.viewModelHandle;i.off("click"),r.verification&&r.showError(r.verification)&&r.verification(""),$PageHelper.byId("hipTemplateContainer",t.content).length>0&&$PageHelper.byId("hipTemplate").append($PageHelper.byId("hipTemplateContainer").children().detach()),this.$.triggerHandler(B,{"content":t.content,"control":this})},"_processDialogShowEvent":function(t,n){this.$.triggerHandler(E,{"content":n.content,"control":this});
var a=e.HIPAMFE,o="undefined"!=typeof a&&a.done;$PageHelper.byId("hipTemplateContainer",n.content).length>0&&o&&(a&&a.updateTitle&&a.updateTitle(),$PageHelper.byId("hipTemplateContainer").append($PageHelper.byId("hipTemplate").children().detach())),$PageHelper.byId("ftr").removeClass("hide")},"_processDialogHideEvent":function(e,t){this.$.triggerHandler(T,{"content":t.content,"control":this})},"_sendOTT":function(t){var a=this,o=a._viewContext.data||{},i=o.input||{},u=e.HIPAMFE,p={"uaid":e.$Config.uaid};p.action=c.sendOttAction,p.proofId=i.memberNameInput,t===c.channel.sms&&(p.proofCountryIso=i.memberNamePhoneCountry,p.autoVerification=r.isAutoVerificationSupported(i.memberNameInput)),p.channel=t,l.enforcementRequiredOnSendOTT&&(p.HType=L,p.HSol=d.sessionToken,p.HPId=d.pid),u&&u.done&&l.requiredOnSendOTT&&(p.HType=u.type,p.HFId=u.urlFid,p.HSId=u.urlId,u.verify(function(e,t){if(u.clientValidation(),""!==u.getError()){if("sms"===u.type){return
}n.viewModelHandle.hip.valueHasMutated()}p.HId=t,p.HSol=e},null));var g=e.location.hash;g&&(g=g.replace("#",""),g&&g.indexOf("ottErrCode=")>-1&&(p.TestErrorCode=g.replace("ottErrCode=",""),e.location.hash="#")),e.$DataRequest.Json(null,$Utility.generateUrl(s.urls.baseDomain,m.sendOtt,!0),p,$PageHelper.proxy(a._onSendOttSuccess,a),$PageHelper.proxy(a._onSendOttFailure,a),1e4,this),q=e.performance&&e.performance.now?e.performance.now():(new Date).getTime()},"_onSendOttSuccess":function(){var e=this;if(e._reportApiQos(),l.enforcementRequiredOnSendOTT=!1,l.requiredOnSendOTT=!1,n.viewModelHandle.doAutoVerify){$PageHelper.proxy(n.viewModelHandle.doAutoVerify,e)()
}else{var t=e._viewContext.data||{};t.sendOttSuccessRsp=!0,e.handleActionButton()}},"_onSendOttFailure":function(t){var a=this,o=t&&t.error?t.error.code:"",i=e.HIPAMFE;return a._reportApiQos(o),o===c.errorCodes.hipEnforcementNeededOnSendOTT?(l.enforcementRequiredOnSendOTT=!0,void a.$.triggerHandler($,{"actionName":"hipEnforcement","control":a})):o===c.errorCodes.hipCaptchaNeededOnSendOTT?(l.requiredOnSendOTT=!0,void a.$.triggerHandler($,{"actionName":"hip","control":a})):o===c.errorCodes.hipValidationError?void(l.enforcementRequired?a.$.triggerHandler($,{"actionName":"hipEnforcement","control":a}):i&&i.done&&a.$.triggerHandler($,{"actionName":"hip","control":a})):void(n.viewModelHandle.onVerifyFailed&&$PageHelper.proxy(n.viewModelHandle.onVerifyFailed,a)(t))
},"_reportApiQos":function(t){try{var n=e.performance&&e.performance.now?e.performance.now():(new Date).getTime(),a={};a.pageId="Account_SendSMSOtt_API",a.duration=Math.round(n-q),t&&(a.errorCode=t),a.skipClientCall=!0,$ReportEvent.Action(a)}catch(o){}},"_focusFirstError":function(e){var t=e.getFirstError();t.suppressMessages(!1),t.focused(!1),t.focused(!0),this.setEnabled(!0)},"_setupUserTile":function(e,t,n){e&&t&&n&&($PageHelper.byId("fullName").text(c.page.isFLOrder?t+" "+n:n+" "+t),$PageHelper.byId("membername").text(e),$PageHelper.byId("userTile").show())
},"events":{"action":$,"show":E,"hide":T,"setupEvents":M,"removeEvents":B,"dispose":O}},{})}(),function(){var e=window,t=e.wLive,n=t.Account,a=n.Util,o=n.Controls,i=n.UrlHelper,r=null,s=e.MSA&&e.MSA.CXH,l=a&&a.ConvergedUxUtil,d=a&&a.MarchingAnts,c=a&&a.FullScreenSpinner,u=e.$Config.WLXAccount,p=u.signup,m=p.page,g=u.hip,f=g&&g.enforcement,v={},b={},h={},C={},w={},y=u.isWin10,S=u.isWin10InclusiveOOBE,k=u.isXbox,P=!!m.fedStateToken,x="newpwd",A="https://",I="onAction",H="enforcement",N="Account_CreatePassports_API",$=0;
$Do.when("ExternalHelper",0,function(){r=e.ExternalHelper}),defineSubClass("wLive.Account.Controls.SignupCreateControl",o.SignupControl,function(t){this._wreply=i.GetQSValue(e.location.href,"wreply"),this._ru=i.GetQSValue(e.location.href,"ru"),this._signupRu=i.GetQSValue(e.location.href,"sru"),this._isSubmitting=!1,this._$container=t,v=p.strings,b=v.errors,C=p.urls.dataRequest,w=p.apis.dataRequest,h=p.errorCodes},{"dispose":function(){this._base.dispose()},"_onCreateSuccess":function(a){var o=n.FieldHelper.getMemberNameType(a.signinName,p.domains),i=this,l=i._viewContext.data||{},d=l.input||{},c=l.prefill||{},g={};
g.pageId=N,g.userAction=[],g.skipClientCall=!0;for(var f in c){c[f]===d[f]?g.userAction.splice(0,0,"Action_"+f+"_Used"):g.userAction.splice(0,0,"Action_"+f+"_NotUsed")}try{var v=e.performance&&e.performance.now?e.performance.now():(new Date).getTime();g.suggestedAccountType=p.fl,g.accountType=o,g.duration=Math.round(v-$),$ReportEvent.Action(g)}catch(b){}var h=$PageHelper.byId("atlas");h.length>0&&p.urls&&p.urls.atlas&&(o===p.memberNameType.Live&&p.urls.atlas.createLive?$PageHelper.createShim("img").attr("src",p.urls.atlas&&p.urls.atlas.createLive).appendTo(h):p.urls.atlas.createEasi&&$PageHelper.createShim("img").attr("src",p.urls.atlas&&p.urls.atlas.createEasi).appendTo(h)),setTimeout(function(){if(r.setProperty("IsSignUp","1"),a){var o=n.FieldHelper.getMemberNameType(a.signinName,p.domains);
if(p.fss&&p.fss.isFamilyAddMemberFlow){var l=null,d={"uaid":e.$Config.uaid},c=o===p.memberNameType.EASI;d.memberEmailPii=a.signinName||"",d.memberRole=p.fss.memberRole||"",$Do.when("DataRequest",0,function(){c?l=new t.Core.DataRequest(null,$Utility.generateUrl(u.urls.baseDomain,C.addPendingMember,!0),d,function(e){i._onAddToFamilySuccess(e,a,c)},function(e){i._onAddToFamilyFailure(e,a.signinName,c)}):(d.encMemberPuid=a.encPuid||"",l=new t.Core.DataRequest(null,$Utility.generateUrl(u.urls.baseDomain,C.createAndUpdateFamily,!0),d,function(e){i._onAddToFamilySuccess(e,a,c)
},function(e){i._onAddToFamilyFailure(e,a.signinName,c)})),s&&p.fss.isWinTsetFlow?s.createStubAccountAsync(a.signinName,!1,function(){l.start()},function(e){$ReportEvent.ReportApiCall({"apiId":p.fss.errorApiId,"success":!1,"errorCode":e.number||""}),$Utility.navigateTo(p.fss.ruOnError)}):l.start()})}else{if(m.isAddUserFlow&&s){s.createStubAccountAsync(a.signinName,!1,function(){s.finish(s.FinishStates.Success)},function(e){$ReportEvent.ReportApiCall({"apiId":p.addUserErrorApi,"success":!1,"errorCode":e.number||""}),s.finish(s.FinishStates.Error)
})}else{var d=i._getSignInPostData(a);$Utility.postTo(a.redirectUrl,d)}}}},1e3)},"_onCreateFailure":function(t){var a=this,o=t&&t.error;try{var i=e.performance&&e.performance.now?e.performance.now():(new Date).getTime(),s=a._viewContext.data||{},l={};l.pageId=N,l.suggestedAccountType=p.fl,l.accountType=n.FieldHelper.getMemberNameType(s.input.memberName,p.domains),l.duration=Math.round(i-$),l.errorCode=o?t.error.code:"",l.skipClientCall=!0,$ReportEvent.Action(l)}catch(d){}r&&r.setWizardButtons(!0,!0,!1),n.ftrViewModelHandle&&(n.ftrViewModelHandle.buttons.backButton.disabled(!1),n.ftrViewModelHandle.buttons.nextButton.disabled(!1)),a._viewContext.hasAttemptedSubmit=!0,a._isSubmitting=!1,a._viewContext.data.serverErrors={},a._handleCreateError(t.error),a.setEnabled(!0)
},"_onAddToFamilySuccess":function(e,t,n){var a=this;if(a._updateFamilyCache(t.signinName),t.childInfo){$Cookie.setCookie(p.fss.childConsentCookieName,t.childInfo,p.fss.childConsentCookieDomain,0,0,1,p.useSameSite),$Cookie.setCookie(p.fss.childConsentRUCookieName,p.fss.ruOnSuccess,p.fss.childConsentCookieDomain,0,0,1,p.useSameSite);var o=$Utility.addQueryString(p.fss.kcFRu,"kcft",t.kcft);$Utility.navigateTo(o)}else{var o="";o=p.fss.isWinTsetFlow&&n?decodeURIComponent(p.fss.ruOnEasiSuccess).format(e.encryptedMemberName):p.fss.isWinTsetFlow?decodeURIComponent(p.fss.ruOnSuccess).format(e.encryptedMemberName):p.fss.ruOnSuccess,$Utility.navigateTo(o)
}},"_onAddToFamilyFailure":function(e,t,n){var a=this;if(e&&e.error&&e.error.code){var o="";if(e.error.data){try{var i=JSON.parse(e.error.data);i&&i.encryptedMemberName&&(o=i.encryptedMemberName)}catch(r){}}switch(e.error.code){case p.fss.errorCodes.familyInvitationAlreadyExists:a._updateFamilyCache(t);var s="";return s=p.fss.isWinTsetFlow&&n?decodeURIComponent(p.fss.ruOnEasiSuccess).format(o):p.fss.isWinTsetFlow?decodeURIComponent(p.fss.ruOnSuccess).format(o):p.fss.ruOnSuccess,void $Utility.navigateTo(s);case p.fss.errorCodes.memberAlreadyInFamily:return void $Utility.navigateTo(decodeURIComponent(p.fss.urls.memberAlreadyInFamily));
case p.fss.errorCodes.cannotInviteExistingMember:return void $Utility.navigateTo(decodeURIComponent(p.fss.urls.cannotInviteExistingMember));case p.fss.errorCodes.notAllowedToAddMember:case p.fss.errorCodes.notAllowedToInviteMember:return void $Utility.navigateTo(decodeURIComponent(p.fss.urls.addToFamilyChildFailure).format(o));case h.familySizeExceedLimit:return void $Utility.navigateTo(decodeURIComponent(p.fss.urls.familySizeLimitReached).format(o));case p.fss.errorCodes.firstMemberAdminMissingAccountInfo:return void $Utility.navigateTo(decodeURIComponent(p.fss.urls.addToFamilyParentFailure))
}}$Utility.navigateTo(p.fss.ruOnError)},"_updateFamilyCache":function(e){if(s){try{var t=p.fss.memberRole===p.fss.userRole;s.createLocalMemberWithEmailAsync(e,t,!1)}catch(n){}}},"_getSignInPostData":function(e){var t={"slt":e.slt};return 1===p.ignoresso&&(t.ignoresso=1),t},"_createAccount":function(t){var o=this;t.encAttemptToken=o._viewContext.data.encAttemptToken||"",t.dfpRequestId=o._viewContext.data.dfpRequestId||"",m.unsafe_convergedCobrandingPartnerTag&&(t.CobrandingPartnerTag=m.unsafe_convergedCobrandingPartnerTag),r&&r.setWizardButtons(!1,!1,!1),n.ftrViewModelHandle&&(n.ftrViewModelHandle.buttons.backButton.disabled(!0),n.ftrViewModelHandle.buttons.nextButton.disabled(!0));
var i=$PageHelper.byId("Spinner");if(i.show(),!y&&!S){var s=$PageHelper.byId("spinnerImg",i);s.detach(),i.append(s)}c&&a.FullScreenSpinner.show(),d&&d.showLightboxProgress(),l&&l.disableLightbox(!0),$=e.performance&&e.performance.now?e.performance.now():(new Date).getTime(),e.$DataRequest.Json(null,{"url":$Utility.generateUrl(u.urls.baseDomain,C.createAccount,!0),"apiId":w.createAccountApiId},t,$PageHelper.proxy(o._onCreateSuccess,o),$PageHelper.proxy(o._onCreateFailure,o),null,null,null,null,!0)},"_isVerificationNeeded":function(e,t){var n=e===p.memberNameType.Phone,a=e===p.memberNameType.EASI&&(0!==p.easiVerifyInline||m.verifyProofEasiOptional&&!p.skipCodeValidation)&&!m.isMojangUpgrade&&(!p.isWin10HostOOBEDesktop||m.verifyProofEasiOptional&&!p.skipCodeValidation),o=m.isMojangUpgrade&&p.viewContext.data.prefill&&p.viewContext.data.prefill.memberName&&(e==p.memberNameType.EASI&&t!==p.viewContext.data.prefill.memberName.EASI[0].email||e==p.memberNameType.Live&&t!==p.viewContext.data.prefill.memberName.Live[0].email);
return n||a||o},"_handleCreateError":function(t){var o=this,i=t.code,r=t.field,s="",u=o._viewContext.keyToStateMap,f=o._viewContext.data||{},v=o._viewContext.data.serverErrors=o._viewContext.data.serverErrors||{},C=e.HIPAMFE,w=!1;switch(p.skipCodeValidation=!1,$PageHelper.byId("VerificationAlternate").removeAttr("disabled"),$PageHelper.byId("Spinner").hide(),l&&l.disableLightbox(!1),d&&d.hideLightboxProgress(),c&&a.FullScreenSpinner.hide(!1),n.viewModelHandle.showAutoVerificationUI&&n.viewModelHandle.showAutoVerificationUI(!1),i){case h.hipValidationError:if(g.enforcementRequired){n.FieldHelper.loadEnforcementHip(p.signUpHipEnforcementPageId)
}else{if(C&&C.done){if(C.observable.hip(""),C.error=1,C.setError(),s=C.getError(),C.observable.hip.focused(!0),"sms"===C.type){if(t.data){try{var y=JSON.parse(t.data);y&&y.fid&&C.switchHIP("sms",y.fid)}catch(S){}}}else{C.reloadHIP()}}}break;case h.hipNeeded:o._viewContext.hasAttemptedSubmit=!1,g.required=!0,g.enforcementRequired=!1,$PageHelper.indexOf("hip",p.options.states)>=0?o.$.triggerHandler(I,{"actionName":"hip","control":o}):(n.FieldHelper.loadHip(),$PageHelper.byId("hipSection").show());break;case h.hipEnforcementNeeded:o._viewContext.hasAttemptedSubmit=!1,g.enforcementRequired=!0,g.required=!1,$PageHelper.indexOf("hipEnforcement",p.options.states)>=0?o.$.triggerHandler(I,{"actionName":"hipEnforcement","control":o}):n.FieldHelper.loadEnforcementHip(p.signUpHipEnforcementPageId);
break;case h.hipSMSNeeded:g.required=!0,g.enforcementRequired=!1;var k,P,x=null;if(t.data){try{var y=JSON.parse(t.data);y&&(P=y.sid||null,k=y.fid||null,x=y.dc||null)}catch(S){}}if(C&&C.done){P&&(C.urlId=P),k&&x?C.switchHIP("sms",k,x):k?C.switchHIP("sms",k):C.switchHIP("sms")}else{for(var H in o._viewContext.keyToStateMap){if("hip"===H){if(g.url=$f.replaceQs(g.url,"type","sms"),P&&(g.url=$f.replaceQs(g.url,"id",P)),k){if(x){g.url=g.useNewApi?g.url+"&AzureRegion="+x:g.url.replace(A,A+x+"."),g.url=$f.replaceQs(g.url,"fid",k)
}else{if(k.indexOf(".")>-1){var N=k.split(".");g.url=g.useNewApi?g.url+"&AzureRegion="+N[0]:g.url.replace(A,A+N[0]+"."),g.url=$f.replaceQs(g.url,"fid",k)}else{g.url=$f.replaceQs(g.url,"fid",k)}}}$PageHelper.indexOf("hip",p.options.states)>=0?o.$.triggerHandler(I,{"actionName":"hip","control":o}):(n.FieldHelper.loadHip(),$PageHelper.byId("hipSection").show());break}}o.$.triggerHandler(I,{"actionName":"blocked","control":o})}break;case h.dailyLimitIDsReached:w=!0,o.$.triggerHandler(I,{"actionName":"blocked","control":o});
break;case h.oneTimeCodeInvalid:s=b.oneTimeCodeInvalid;break;case h.verificationSltInvalid:f.verificationCodeSlt=null;break;case h.membernameTaken:case h.membernameTakenEasi:case h.membernameTakenPhone:var $=b.memberNameTakenNoSugg,E="",T="";switch(0!==p.displaySignInLinkInMnError?(p.signinUrl=$Utility.addQueryString(p.signinUrl,"username",f.input.memberName||""),E=b.memberNameTakenEasi.format(f.input.memberName,p.signinUrl),T=b.memberNameTakenPhone.format(f.input.memberName,p.signinUrl)):(E=b.memberNameTakenEasi.format(f.input.memberName),T=b.memberNameTakenPhone.format(f.input.memberName)),i){case h.membernameTaken:var M=n.FieldHelper.getMemberNameType(f.input.memberName,p.domains);
s=M===p.memberNameType.Phone?T:$;break;case h.membernameTakenEasi:s=E;break;case h.membernameTakenPhone:s=T}break;case h.domainNotAllowed:s=b.domainNotAllowed;break;case h.forbiddenWord:s=b.forbiddenWord;break;case h.passwordIncorrect:s=b.passwordIncorrect;break;case h.passwordConflict:o.$.triggerHandler(I,{"actionName":"evictionError","control":o});break;case h.invalidEmailFormat:s=b.invalidEmailFormat;break;case h.emailMustStartWithLetter:s=b.emailMustStartWithLetter;break;case h.proofAlreadyExistsError:s=b.proofAlreadyExistsError;
break;case h.invalidPhoneFormat:s=b.invalidPhoneFormat;break;case h.invalidBirthDate:s=b.invalidBirthDate;break;case h.invalidGender:s=b.invalidGender;break;case h.invalidFirstName:s=b.invalidFirstName;break;case h.invalidLastName:s=b.invalidLastName;break;case h.maximumOTTDailyError:s=b.verificationThrottled;break;case h.bannedPassword:s=b.bannedPassword;break;case h.passwordRequired:m.pwdless=m.pwdlessemail=0,s=b.passwordRequired;break;case h.domainExistsInAad:s=b.domainExistsInAad.format("domainExistsInAadSwitchToOutlook");
break;case h.domainExistsInAadSupportedLogin:s=b.domainExistsInAadSupportedLogin.format(f.input.memberName);break;case h.evictionWarningRequired:w=!0,p.viewContext.data.checkAvailStateMap||(p.viewContext.data.checkAvailStateMap=[]),p.viewContext.data.checkAvailStateMap.push(f.input.memberName+":true"),o.$.triggerHandler(I,{"actionName":"evictionSpeedbump","control":o});break;default:w=!0,o._handleFatalError(i)}if(r){var B=u[r];if(v[r]=s,n.viewModelHandle[r]&&(n.viewModelHandle[r].serverError=s,n.viewModelHandle[r].notifySubscribers&&!n.viewModelHandle[r].terminalState&&n.viewModelHandle[r].notifySubscribers(),n.viewModelHandle[r].isModified&&n.viewModelHandle[r].isModified(!1),n.viewModelHandle[r].focused&&n.viewModelHandle[r].focused(!0)),t.data){try{var O=JSON.parse(t.data);
O&&O.verificationCodeSlt&&(f.verificationCodeSlt=O.verificationCodeSlt),O&&O.encAttemptToken&&(f.encAttemptToken=O.encAttemptToken),O&&O.dfpRequestId&&(f.dfpRequestId=O.dfpRequestId)}catch(S){}}B&&("hip"!==B&&(p.options.viewDefs[B].options.focusErrorElemId=r),o.$.triggerHandler(I,{"actionName":B,"control":o}))}else{w||o._handleFatalError(i)}},"_handleFatalError":function(e){r&&(r.setProperty("ErrorCode",parseInt(e)),r.setWizardButtons(!1,!1,!0),r.finalNext()),n.ftrViewModelHandle&&(n.ftrViewModelHandle.buttons.backButton.disabled(!0),n.ftrViewModelHandle.buttons.nextButton.disabled(!0)),s?s.handleError(e):$Utility.navigateTo(u.urls.baseDomain+p.urls.error+e)
},"handleActionButton":function(){var t=this,a=t._viewContext.data||{},o=a.prefill||{},i=a.input||{},r={},s=t._options.optInEmailId,l=t._options.secondOptInEmailId,d=(t._checkBoxBindings,e.HIPAMFE);if(r.RequestTimeStamp=new Date,!t._isSubmitting){var c=i.memberName;if(c||(n.viewModelHandle.memberName&&(n.viewModelHandle.memberName.notifySubscribers(),c=i.memberName),c)){var u=n.FieldHelper.getMemberNameType(c,p.domains);if("function"==typeof n.viewModelHandle.shouldGoToPasswordPage&&n.viewModelHandle.shouldGoToPasswordPage()&&t.$.triggerHandler(I,{"actionName":"password","control":t}),t._isVerificationNeeded(u,c)){if(a.reporting&&a.reporting.autoVerifyShown&&(r.AutoVerify=!0),!i.verification||P&&!n.viewModelHandle.fedConfirmPageDesc){if(!P||!a.input.isMemberNameVerified){if(u===p.memberNameType.Phone&&p.phoneNumberPatternsToChallenge){var v=new RegExp(p.phoneNumberPatternsToChallenge);
if(v.test(c)){if(p.showArkoseBeforeSendOTTOnSignup&&!g.enforcementRequiredOnSendOTT&&!g.requiredOnSendOTT){return g.enforcementRequiredOnSendOTT=!0,void t.$.triggerHandler(I,{"actionName":"hipEnforcement","control":t})}if(!g.enforcementRequiredOnSendOTT&&!g.requiredOnSendOTT){return g.requiredOnSendOTT=!0,void t.$.triggerHandler(I,{"actionName":"hip","control":t})}}}return void t.$.triggerHandler(I,{"actionName":"verification","control":t})}if(!n.viewModelHandle.fedConfirmPageDesc){return void t.$.triggerHandler(I,{"actionName":"fedConfirm","control":t})
}r.MemberName=c}else{a.verificationCodeSlt&&(r.VerificationCodeSlt=a.verificationCodeSlt),r.MemberName=c,r.VerificationCode=i.verification,i.autoVerify&&(r.AutoVerifySuccess=i.autoVerify)}}else{if(P&&!n.viewModelHandle.fedConfirmPageDesc){return void t.$.triggerHandler(I,{"actionName":"fedConfirm","control":t})}r.MemberName=c}if(P&&(r.FedStateToken=m.fedStateToken,(u===p.memberNameType.EASI||u===p.memberNameType.Phone)&&(r.IsFedEasiEmailVerified=a.input.isMemberNameVerified,r.IsFedNameVerified=a.input.isMemberNameVerified)),r.CheckAvailStateMap=a.checkAvailStateMap||[],r.EvictionWarningShown=a.evictionWarningShown||[],r.UpgradeFlowToken=m.upgradeFlowToken||{},o&&o.memberName){var b=o.memberName.Live,h=o.memberName.Phone,C=o.memberName.EASI;
r.PrefillMemberNamePassed=!0,r.PrefillDomain=p.prefillDomain,u===p.memberNameType.Live?b&&$PageHelper.each(b,function(e,t){return t&&t.email&&c&&c.indexOf(t.email)>=0?(r.PrefillMemberNameUsed=!0,!1):void 0}):u===p.memberNameType.Phone?h&&$PageHelper.each(h,function(e,t){return t&&t.phoneNumber&&c&&c.indexOf(t.phoneNumber)>=0?(r.PrefillMemberNameUsed=!0,!1):void 0}):u===p.memberNameType.EASI&&C&&$PageHelper.each(C,function(e,t){return t&&t.email&&c&&c.indexOf(t.email)>=0?(r.PrefillMemberNameUsed=!0,!1):void 0
})}if(r.FirstName=i.firstName,r.LastName=i.lastName,a.isUserConsentedToChinaPIPL&&(r.IsUserConsentedToChinaPIPL=!0),a.reporting&&(r.MemberNameChangeCount=a.reporting.memberNameChangeCount,r.MemberNameAvailableCount=a.reporting.memberNameAvailableCount,r.MemberNameUnavailableCount=a.reporting.memberNameUnavailableCount),0!==m.pwdless&&u===p.memberNameType.Phone||0!==m.pwdlessemail&&u===p.memberNameType.EASI||P||(r.CipherValue=Encrypt("","",x,i.password),r.SKI=SKI||""),0!==p.dobCheck?(i.birthdate||0!==p.createWithCountry)&&(r.BirthDate=i.birthdate,r.Country=i.country):(r.BirthDate=i.birthdate,r.Country=i.country,r.PostalCode=i.postalCode,r.Gender=i.gender),u===p.memberNameType.Phone&&y||(r.PhoneCountry=i.phoneCountry,r.PhoneNumber=i.phoneNumber,r.AltEmail=u===p.memberNameType.Live||k?i.alternateEmail:null),r.IsOptOutEmailDefault=0!==p.isOptOut,r.IsOptOutEmailShown=!1,s){var w=$PageHelper.byId(s,t._$container);
w&&w.length>0&&(t._viewContext.persistedOptOutEmailSelection=!w.prop("checked")||t._viewContext.hideOptinCheckboxForChild===!0)}if(l){var S=$PageHelper.byId(l,t._$container);S&&S.length>0&&(t._viewContext.persistedSecondOptOutEmailSelection=!S.prop("checked")||t._viewContext.hideOptinCheckboxForChild===!0)}"undefined"!==t._viewContext.persistedOptOutEmailSelection&&(r.IsOptOutEmailShown=t._viewContext.hideOptinCheckboxForChild!==!0,r.IsOptOutEmail=t._viewContext.persistedOptOutEmailSelection),"undefined"!==t._viewContext.persistedSecondOptOutEmailSelection&&(r.IsSecondOptOutEmail=t._viewContext.persistedSecondOptOutEmailSelection),r.LW=0!==p.lw,r.SiteId=a.siteId,r.IsRDM=a.isRdm;
try{r.GWPC=window.external.SignString("bver=1")}catch(A){}r.WReply=t._wreply,r.ReturnUrl=t._ru,r.SignupReturnUrl=t._signupRu,r.uiflvr=e.$Config.uiflvr,r.uaid=e.$Config.uaid,r.SuggestedAccountType=p.suggAccType,r.SuggestionType=p.suggType,p.DT&&(r.DT=p.DT),p.DFT&&(r.DFT=p.DFT);var N=e.location.hash;N&&(N=N.replace("#",""),N&&N.indexOf("errCode=")>-1&&(r.TestErrorCode=N.replace("errCode=",""),e.location.hash="#")),g&&g.fid&&(r.HFId=g.fid),g.enforcementRequired?n.viewModelHandle.hipEnforcement&&f.sessionToken?(t._isSubmitting=!0,r.HType=H,r.HSol=f.sessionToken,r.HPId=f.pid,t._createAccount(r)):t.$.triggerHandler(I,{"actionName":"hipEnforcement","control":t}):d&&d.done?n.viewModelHandle.hip||d.fake?(r.HType=d.type,r.HFId=d.urlFid,r.HSId=d.urlId,d.verify(function(e,a){if(d.clientValidation(),""!==d.getError()){if("sms"===d.type){return
}n.viewModelHandle.hip.valueHasMutated()}r.HId=a,r.HSol=e,t._createAccount(r)},null)):t.$.triggerHandler(I,{"actionName":"hip","control":t}):g.required?t.$.triggerHandler(I,{"actionName":"hip","control":t}):(t._isSubmitting=!0,t._createAccount(r))}}}},{})}(),function(){function e(e,t){var n=w.options.viewDefs[e];if(n){var a=n.sectionId,o=n.actions,i=null;a&&(A[a]?i=A[a].clone():(i=$PageHelper.byId(a,t),i.detach(),A[a]=i)),n.options.sectionId||(n.options.sectionId=a),n.options.viewTemplate=i;var r={"action":a+"Action"};
o.cancel&&(r.cancel=a+"Cancel"),o.alternate&&(r.alternate=a+"Alternate"),o.skip&&(r.skip="PhoneVerification"),o.tou&&(r.tou="tou"),o.privacy&&(r.privacy="privacy"),o.dataCollection&&(r.dataCollection="dataCollection"),o.dataUse&&(r.dataUse="dataUse"),o.retention&&(r.retention="retention"),o.localAccount&&(r.localAccount="LocalAccount"),o.hip&&(r.hip="hip"),o.learnMore&&(r.learnMore="learnMore"),n.options.buttons=r}}function t(){m.SignupTemplates&&w.useTemplate&&($PageHelper.each(m.SignupTemplates,function(e,t){$PageHelper.byId(e).append(t)
}),$PageHelper.byId("maincontent").removeAttr("role"));var t=$PageHelper.byId("signupTemplates"),n=w.options.states;for(var a in n){e(n[a],t)}}function n(e,t,n,a){if(t===I){if($ReportEvent.Fire("Signup_FinalBack_UserAction"),w.finalBackUrl){C.isWin10InclusiveOOBE&&P?P.handleBackButton(function(){$Utility.navigateTo(w.finalBackUrl)}):w.options.viewDefs[I].url=w.finalBackUrl}else{if(b){return b.finalBack(),null}}}else{if("cxhLocalAccount"===t){return P.loadIdentityProvider(w.localAccountProvider),null}if("cxhCancel"===t){return P.finish(x.Cancel),null
}}return"cancel"==a?(i(t,N),t):(r(t,N),t)}function a(e){if(C.isXbox){e=e||{};var t=e.props||{},n=e.control||{};WIZARDUI&&WIZARDUI.ready&&(n.isControlReady?n.isReady().then(function(){WIZARDUI.ready(t)}):WIZARDUI.ready(t))}g&&g.$.triggerHandler("onControlVisible",{"control":e.control})}function o(e,t){var n=t&&t.state,o=w.options.viewDefs[n].options.callbacks||{},i=o.context||{};a(i)}function i(e,t){if(null!=e&&"undefined"!=typeof e&&y[e]){var n=y[e].userAction;n?($PageHelper.isArray(n)||(n=new Array(n)),-1===n.indexOf(t)&&n.push(t)):n=t,y[e].userAction=n
}}function r(e,t){if(null!=e&&"undefined"!=typeof e&&y[e]){var n=y[e].userAction;if(n){if(n===t){n=""}else{var a=n.indexOf(t);-1!==a&&n.splice(a,1)}y[e].userAction=n}}}function s(e){var t=$PageHelper.deferred();if(e){var n={"phone":e};v.Json(null,$Utility.generateUrl(C.urls.baseDomain,w.urls.dataRequest.getPhoneNumberDetails,!0),n,function(e){t.resolve(e)},function(){t.reject()})}else{t.reject()}return t.promise()}function l(e){var t=e.data=e.data||{},n=t.prefill=t.prefill||{},a=t.input=t.input||{};for(var o in e.keyToStateMap){var i=k[o].clientPrefillKey;
if(!n[o]&&i&&b){var r=b.getProperty(i);if(r){if(o===k.phoneNumber.name){s([r]).done(function(e){e&&e.phoneDetails&&e.phoneDetails.length>0&&(n[k.phoneCountry.name]=e.phoneDetails[0].country,n[k.phoneNumber.name]=e.phoneDetails[0].phoneNumber)})}else{if(o===k.memberName.name){try{var l=$PageHelper.parseJSON(r),d=[],c=[],u=[];$PageHelper.isArray(l)||(l=[l]),$PageHelper.each(l,function(e,t){var n=m.FieldHelper.getMemberNameType(t,w.domains,null),a=w.memberNameType;n===a.Phone?u.push(t):n===a.EASI?d.push(t):n===a.Live&&c.push(t)
}),n[o]={"EASI":d,"Live":c},null!=u&&u.length>0&&s(u).done(function(e){e&&e.phoneDetails&&(n[o][w.memberNameType.Phone]=e.phoneDetails)})}catch(p){r=""}n[o]=r}else{n[o]=r}}}}}var g=n[k.country.name];g&&(n[k.country.name]=g.toUpperCase());for(var o in e.keyToStateMap){o!==k.memberName.name&&(a[o]=n[o])}}function d(e){var t=w.options,n=t.viewDefs||{};e.keyToStateMap={};for(var a in n){if(n.hasOwnProperty(a)){var o=n[a];if(o&&o.options&&o.options.viewModelOptions&&o.options.viewModelOptions.observables){var i=o.options.viewModelOptions.observables;
$PageHelper.each(i,function(t,n){e.keyToStateMap[n]=a})}}}}function c(){0!==w.lw&&(w.phoneCountryListJson={"list":[]},w.phoneCountryListJson["default"]=w.defaultCountry,$PageHelper.each(w.countryList,function(e,t){t.code&&(t.displayValue=w.showParens?t.name+" ‏(‎+"+t.code+")":t.name+" +"+t.code,w.phoneCountryListJson.list.push(t))}))}var u=window,p=u.wLive,m=p.Account,g=m.PageEvents,f=m.Controls,v=(m.SignupHelper,u.$DataRequest),b=null,h=m.Util&&m.Util.HighContrast,C=u.$Config.WLXAccount,w=C.signup,y=w.options.viewDefs,S=w.page,k=w.signupObservableSets,P=u.MSA&&u.MSA.CXH,x=P&&P.FinishStates,A={},I="finalBack",H=m&&m.Util&&m.Util.ConvergedUxUtil;
$Do.when("ExternalHelper",0,function(){b=u.ExternalHelper});var N="Action_Back";u.OnBack||(u.OnBack=function(){g&&g.$.triggerHandler(g.back)}),u.OnNext||(u.OnNext=function(){g&&g.$.triggerHandler(g.next)}),defineNamespace("wLive.Account.Page",{"Signup":function(){w.strings=w.strings||{},w.page=w.page||{},w.regex=w.regex||{},$PageHelper.extend(!0,w.strings,u.$Config.sharedStrings),$PageHelper.extend(!0,w.page,u.$Config.sharedPageConfig),$PageHelper.extend(!0,w.regex,w.regularexpressions),$PageHelper.extend(!0,w.strings,w.overrideStrings||{}),t();
var e=w.viewContext=w.viewContext||{};e.data=e.data||{},e.data.reporting=e.data.reporting||{},e.data.reporting.memberNameChangeCount=e.data.reporting.memberNameChangeCount||0,e.data.reporting.memberNameAvailableCount=e.data.reporting.memberNameAvailableCount||0,e.data.reporting.memberNameUnavailableCount=e.data.reporting.memberNameUnavailableCount||0,c(),d(e),l(e);var a=$PageHelper.byId("maincontent")[0];if(H){var i=H.getArrowImage(),r=H.getMsLogoImage(),s={"strings":w.strings,"config":S,"memberName":ko.observable(),"isBackButtonVisible":ko.observable(!0),"arrowImg":i,"msLogoImg":r,"showIdentityBanner":ko.observable(!1),"progressText":ko.observable(),"stepCounter":ko.observable(),"totalSteps":ko.observable(),"progressDots":ko.observableArray()};
ko.applyBindings(s,a)}var p=new f.FlowController($PageHelper.byId("pageControlHost"),e,w.options);if(p.setStateChangeFunc(n),p.$.on(p.events.controlVisible,o),p.show(w.startState),S&&a&&(S.backgroundColor&&$PageHelper.byClassName("background").css("backgroundColor",S.backgroundColor),S.imgs&&S.logoTypeHtml)){var m=$PageHelper.byId("ftrLogo");m.html(h.getHighContrastImage(S.logoTypeHtml.format(S.imgs.baseUrl,"White",0!==S.useSvg?"svg":"png"),{"forWhiteBackground":S.logoTypeHtml.format(S.imgs.baseUrl,"Gray",0!==S.useSvg?"svg":"png")}))
}C.isWin10InclusiveOOBE&&P&&!w.getDeviceTicket&&(P.speakAsync(w.strings.cortana),P.showBackButton(!0))}}),$Do.register("Account.Page.Signup")}(),function(){function e(){var e=$Config.WLXAccount.signup?$Config.WLXAccount.signup.urls.dfpUrl:SignUp.dfpUrl,i=function(){n=o.performance&&o.performance.now?o.performance.now():(new Date).getTime(),a=n-t,$Do.when("$Telemetry",function(){var e=o.$Telemetry;e.appendClientEvent("Account_DeviceFingerPrinting_Iframe_Load",a.toString())})},r=document.createElement("iframe");
r.id="iDeviceFingerPrinting",r.setAttribute("style","color:#000000;float:left;visibility:hidden;position:absolute;width:1px;height:1px;left:-10000px;top:-10000px;border:0px"),r.setAttribute("src",e),t=o.performance&&o.performance.now?o.performance.now():(new Date).getTime(),$B&&$B.IE&&$B.V<11?r.attachEvent("onload",i):r.addEventListener("load",i),document.body.appendChild(r)}var t,n,a,o=window;registerNamespace("wLive.Account.Page"),wLive.Account.Page.AttachDfpIframe=e,$Do.register("AttachDfpIframe")}();